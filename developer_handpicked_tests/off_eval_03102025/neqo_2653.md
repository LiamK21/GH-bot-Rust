## GitHub Pull Request 2653

[[pull request]](https://github.com/mozilla/neqo/pull/2653)
[[linked issue]](https://github.com/mozilla/neqo/issues/2652)

Hi! ðŸ¤– The test below is automatically generated and could serve as a regression test for this PR because it:

- passes on the PR,
- fails in the codebase before the PR, and
- increases line coverage from 92.48% to 93.96%.

```rust
use std::fmt::Write;

#[test]
fn test_encoder_write() {
  let mut encoder = Encoder::new();
  let input_str = "test_string";
  let expected_bytes = input_str.as_bytes();
  encoder.write_str(input_str).unwrap();
  let actual_bytes: Vec<u8> = encoder.into();
  assert_eq!(actual_bytes, expected_bytes);
}
```

If you find this regression test useful, feel free to insert it to your test suite.
Our automated pipeline inserted the test at the end of the `neqo-common/src/codec.rs` file before running it.

The test failed on the pre-PR codebase with the following message (to improve clarity, only errors are included).

```text
error[E0599]: no method named `write_str` found for struct `Encoder` in the current scope
--> neqo-common/src/codec.rs:873:15
|
201 | pub struct Encoder {
| ------------------ method `write_str` not found for this struct
...
873 | encoder.write_str(input_str).unwrap();
| ^^^^^^^^^ method not found in `Encoder`
|
= help: items from traits can only be used if the trait is implemented and in scope
= note: the following traits define an item `write_str`, perhaps you need to implement one of them:
candidate #1: `Hasher`
candidate #2: `std::fmt::Write`

For more information about this error, try `rustc --explain E0599`.
error: could not compile `neqo-common` (lib test) due to 1 previous error
warning: build failed, waiting for other jobs to finish...
warning: `neqo-transport` (lib test) generated 7 warnings (6 duplicates)
```

This is part of our research at the [ZEST](https://www.ifi.uzh.ch/en/zest.html) group of University of Zurich in collaboration with [Mozilla](https://www.mozilla.org).
Looking forward to see what you think of the test. If you find it useful, we can open a PR. Thanks for your time.

<details> <summary>Click to see the test patch.</summary>

```diff
diff --git a/neqo-common/src/codec.rs b/neqo-common/src/codec.rs
index 2b2df61..1bbf418 100644
--- a/neqo-common/src/codec.rs
+++ b/neqo-common/src/codec.rs
@@ -483,6 +483,8 @@ impl Write for Encoder {
 mod tests {
     use super::{Decoder, Encoder};

+    use std::fmt::Write;
+
     #[test]
     fn decode() {
         let enc = Encoder::from_hex("012345");
@@ -869,4 +871,14 @@ mod tests {
         enc.pad_to(7, 0xc2);
         assert_eq!(enc, Encoder::from_hex("0102340000c2c2"));
     }
-}
+
+    #[test]
+    fn test_encoder_write() {
+      let mut encoder = Encoder::new();
+      let input_str = "test_string";
+      let expected_bytes = input_str.as_bytes();
+      encoder.write_str(input_str).unwrap();
+      let actual_bytes: Vec<u8> = encoder.into();
+      assert_eq!(actual_bytes, expected_bytes);
+    }
+}
```

</details>
