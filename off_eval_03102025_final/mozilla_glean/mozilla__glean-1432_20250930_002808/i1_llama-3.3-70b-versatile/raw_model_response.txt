<Filename> glean-core/rlb/src/test.rs </Filename>
<imports> 
use glean_core::Glean;
use super::core_metrics;
use super::test_reset_glean;
use super::Configuration;
use super::ClientInfoMetrics;
use super::set_upload_enabled;
use super::new_glean;
use super::lock_test;
use super::core_metrics::internal_metrics;
use tempfile::tempdir;
use crossbeam_channel::bounded;
</imports>
<Rust>
#[test]
fn test_reset_glean_cleans_internal_metrics() {
  let _lock = lock_test();
  let _t = new_glean(None, true);
  core_metrics::internal_metrics::app_build.set_sync(&Glean::new(), "some-value");
  assert_eq!("some-value", core_metrics::internal_metrics::app_build.test_get_value(None).unwrap());
  test_reset_glean(
    Configuration {
      data_path: tempdir().unwrap().path().display().to_string(),
      application_id: "test".into(),
      upload_enabled: true,
      max_events: None,
      delay_ping_lifetime_io: false,
      channel: None,
      server_endpoint: Some("invalid-test-host".into()),
      uploader: None,
    },
    ClientInfoMetrics::unknown(),
    false,
  );
  assert!(core_metrics::internal_metrics::app_build.test_get_value(None).is_none());
}
</Rust>