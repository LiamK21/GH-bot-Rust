#[test]
fn test_timing_distribution_metric_max_sample_time() {
  let dir = tempfile::tempdir().unwrap();
  let (glean, _) = new_glean(Some(dir));
  let mut dist = TimingDistributionMetric::new(
    CommonMetricData {
      name: "test_metric".into(),
      category: "test".into(),
      send_in_pings: vec!["baseline".into()],
      ..Default::default()
    },
    TimeUnit::Nanosecond,
  );
  let max_sample_time = 1000 * 1000 * 1000 * 60 * 10;
  let timer_id = dist.set_start(0);
  dist.set_stop_and_accumulate(&glean, timer_id, max_sample_time * 2);
  let hist = dist.test_get_value(&glean, "baseline").unwrap();
  let snapshot = hist.snapshot();
  assert!(snapshot.len() < 316);
}