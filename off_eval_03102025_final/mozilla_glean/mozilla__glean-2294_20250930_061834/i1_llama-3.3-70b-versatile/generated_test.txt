#[test]
fn test_destroy_glean_clears_stores() {
  let dir = tempdir().unwrap();
  let tmpname = dir.path().to_path_buf();
  let cfg = Configuration {
    data_path: tmpname,
    application_id: "test".into(),
    upload_enabled: true,
    max_events: None,
    delay_ping_lifetime_io: false,
    server_endpoint: Some("invalid-test-host".into()),
    uploader: None,
    use_core_mps: false,
  };
  let client_info = ClientInfoMetrics::default();
  initialize_internal(cfg.clone(), client_info);
  join_init();
  destroy_glean(true, &cfg.data_path);
  assert!(!tmpname.exists());
}