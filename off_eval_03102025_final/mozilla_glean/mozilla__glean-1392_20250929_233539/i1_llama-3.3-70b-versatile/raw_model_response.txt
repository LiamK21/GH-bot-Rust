<Filename> glean-core/rlb/src/test.rs </Filename>
<imports> 
use crate::block_on_dispatcher;
use std::panic;
</imports>
<Rust>
#[test]
fn test_blocking_before_init_panics_on_all_metrics() {
  let _lock = crate::lock_test();
  crate::destroy_glean(true);
  assert!(!crate::was_initialize_called());

  let metric = super::BooleanMetric::new(super::CommonMetricData {
    name: "bool_metric".into(),
    category: "test".into(),
    send_in_pings: vec!["store1".into()],
    lifetime: super::Lifetime::Application,
    disabled: false,
    dynamic_label: None,
  });

  let result = panic::catch_unwind(|| {
    metric.test_get_value("store1");
  });
  let err = result.unwrap_err();
  assert!(err.is::<&str>());
  let err = err.downcast_ref::<&str>().unwrap();
  assert!(
    err.contains("initialize was never called"),
    "Got the wrong panic message"
  );
}
</Rust>