#[test]
fn test_trigger_upload_error_handling() {
    struct MockCallbacks;
    impl OnGleanEvents for MockCallbacks {
        fn trigger_upload(&self) -> Result<(), CallbackError> {
            Err(CallbackError::UnexpectedError)
        }

        fn start_metrics_ping_scheduler(&self) -> bool {
            false
        }

        fn cancel_uploads(&self) -> Result<(), CallbackError> {
            Ok(())
        }
    }

    let mock_callbacks = Box::new(MockCallbacks) as Box<dyn OnGleanEvents>;
    let mut state = global_state().lock().unwrap();
    state.callbacks = mock_callbacks;

    glean_handle_client_inactive();
}