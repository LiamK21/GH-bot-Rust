#[test]
fn test_preinit_queue_overflow() {
    use super::*;
    let max_queue_size = 2;
    let dispatcher = Dispatcher::new(max_queue_size);
    let task = Command::FlushInit;

    // Send tasks until the queue is full
    dispatcher.send(task.clone()).unwrap();
    dispatcher.send(task.clone()).unwrap();

    // Try to send one more task
    let result = dispatcher.send(task);

    // Verify that the overflow count has increased by 1
    assert!(matches!(result, Err(DispatchError::QueueFull)));
    assert_eq!(dispatcher.get_overflow_count(), 1);
}