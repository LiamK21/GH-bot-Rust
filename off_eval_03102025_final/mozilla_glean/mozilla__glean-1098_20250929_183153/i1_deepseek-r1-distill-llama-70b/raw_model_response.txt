<think>
Okay, I need to figure out how to test the new functionality added by the patch. The issue is about not uploading pings larger than 1MB and recording an error when that happens. 

Looking at the patch, I see that in `request.rs`, the `PingRequest::builder` now takes a `body_max_size` parameter. When the body exceeds this size, it returns an `ErrorKind::PingBodyOverflow`. Also, in `upload/mod.rs`, the `build_ping_request` function uses this error to delete the file and record metrics.

So, the test should verify that when a ping's body is larger than 1MB, it's not uploaded and the appropriate error is recorded. 

I'll start by creating a test function. I'll need to create a `PingRequest` with a body just over 1MB. Then, check if it fails to build and if the error is `PingBodyOverflow`. 

I should also ensure that the test doesn't rely on any external dependencies, so using in-memory structures is best. 

I'll name the test `test_ping_body_size_validation` to clearly describe its purpose. I'll import necessary modules like `ErrorKind` and `Result` from `super::error`.

In the test, I'll create a body with 1024*1024 + 1 bytes. Then, attempt to build the `PingRequest` and assert that it results in an error of type `PingBodyOverflow`. 

I think this should cover the case where the body is too large and ensure the error handling works as intended.
</think>

<Filename>src/upload/request.rs</Filename>
<imports>
use super::error::{ErrorKind, Result};
</imports>
<Rust>
#[test]
fn test_ping_body_size_validation() {
    let body = vec![b'a'; 1024 * 1024 + 1];
    let result = PingRequest::builder("test", 1024 * 1024)
        .document_id("test-id")
        .path("test-path")
        .body(body)
        .build();
    
    assert!(matches!(result, Err(ErrorKind::PingBodyOverflow(_))));
}
</Rust>