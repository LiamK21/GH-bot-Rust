#[test]
fn test_initialize_for_subprocess_succeeds() {
    // Test with null configuration to ensure proper error handling
    let result = unsafe { glean_initialize_for_subprocess(std::ptr::null()) };
    assert_eq!(result, 0);

    // Test with valid configuration
    let data_dir = CString::new("test_data_dir").unwrap();
    let app_id = CString::new("test_app_id").unwrap();
    let cfg = Configuration {
        data_path: data_dir.into(),
        application_id: app_id.into(),
        upload_enabled: true,
        max_events: None,
        ..Default::default()
    };

    let result = unsafe { glean_initialize_for_subprocess(&cfg as *const _) };
    assert_eq!(result, 1);
}