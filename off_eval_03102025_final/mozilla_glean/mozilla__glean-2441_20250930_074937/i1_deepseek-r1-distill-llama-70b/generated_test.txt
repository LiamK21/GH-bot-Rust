#[test]
fn test_event_metric_triggers_upload_when_max_events() {
    crate::launch_with_glean(|glean| {
        let meta = CommonMetricDataInternal {
            category: "test".to_string(),
            name: "test".to_string(),
            send_in_pings: Vec::new(),
            type_: "event".to_string(),
            lifetime: "application".to_string(),
            max_events: Some(1),
        };
        let metric = EventMetric::new(&meta);

        // First event: should not trigger upload
        let result1 = metric.record_sync(glean, 0, HashMap::new());
        assert!(!result1, "First event should not trigger upload");

        // Second event: should trigger upload
        let result2 = metric.record_sync(glean, 1, HashMap::new());
        assert!(result2, "Second event should trigger upload");
    });
}