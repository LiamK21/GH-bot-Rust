#[test]
fn test_async_ping_directories_scanning_works() {
    let (glean, dir) = new_glean(None);

    let upload_manager = PingUploadManager::no_policy(dir.path(), false);

    while upload_manager.get_upload_task(&glean, false) == PingUploadTask::Wait {
        thread::sleep(Duration::from_millis(10));
    }

    assert_eq!(
        upload_manager.get_upload_task(&glean, false),
        PingUploadTask::Done
    );
}