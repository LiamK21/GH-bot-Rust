#[test]
fn test_profraw_producer_sends_correct_item_type() {
    let tmp_dir = tempfile::tempdir().unwrap();
    let mut profraws = FxHashMap::default();
    let archive = Archive::new("test_archive");
    profraws.insert("test/default.profraw".to_string(), vec![&archive]);

    let (sender, receiver) = std::sync::mpsc::channel();
    let job_sender = JobSender::new(sender);

    profraw_producer(tmp_dir.path(), &profraws, &job_sender);

    let work_item = receiver.recv().unwrap().unwrap();
    if let ItemType::Paths(paths) = work_item.item {
        assert_eq!(paths.len(), 1);
        assert!(paths[0].ends_with("test/default.profraw"));
    } else {
        panic!("Expected ItemType::Paths");
    }
}