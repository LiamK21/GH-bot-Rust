<Filename> src/path_rewriting.rs </Filename>
<imports> 
use super::rewrite_paths;
use std::path::PathBuf;
use std::fs;
use std::io;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_skip_symlinks() {
  let source_dir = PathBuf::from("/tmp/test_source");
  let obj_dir = source_dir.join("obj");
  fs::create_dir_all(&obj_dir).unwrap();
  let file = obj_dir.join("storage");
  fs::create_dir_all(&file).unwrap();
  let file_path = file.join("Variant_inl.h");
  fs::File::create(&file_path).unwrap();
  let src_file_path = source_dir.join("storage").join("Variant_inl.h");
  fs::File::create(&src_file_path).unwrap();
  let sym_link = obj_dir.join("symlink");
  std::os::unix::fs::symlink(src_file_path.to_str().unwrap(), sym_link.to_str().unwrap()).unwrap();
  
  let result_map: HashMap<String, String> = HashMap::new();
  let path_mapping = None;
  let prefix_dir = None;
  let ignore_not_existing = false;
  let to_ignore_dirs: Vec<String> = vec![];
  let filter_option = None;

  let result = rewrite_paths(result_map, path_mapping, Some(source_dir), prefix_dir, ignore_not_existing, to_ignore_dirs, filter_option);
  assert!(result.count() > 0);
}
</Rust>