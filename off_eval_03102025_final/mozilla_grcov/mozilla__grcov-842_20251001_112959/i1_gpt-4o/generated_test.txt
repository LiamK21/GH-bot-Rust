#[test]
fn test_consumer_panic_on_error() {
    let working_dir = Path::new(".");
    let source_dir = None;
    let result_map: Arc<SyncCovResultMap> = Arc::new(Mutex::new(Default::default()));
    let receiver = JobReceiver::new();
    let branch_enabled = false;
    let guess_directory = false;
    let binary_path = None;

    let result = std::panic::catch_unwind(|| {
        consumer(
            working_dir,
            source_dir,
            &result_map,
            receiver,
            branch_enabled,
            guess_directory,
            binary_path,
        );
    });

    assert!(result.is_err());
}