#[test]
fn test_coveralls_git_info() {
    let temp_dir = TempDir::new("grcov-test").expect("Failed to create temp dir");
    let repo_path = temp_dir.path().join("repo");

    // Initialize a new Git repository
    Command::new("git")
        .arg("init")
        .current_dir(&repo_path)
        .status()
        .expect("Failed to init git repo");

    // Create a file and commit
    let file_path = repo_path.join("test.txt");
    let mut file = File::create(&file_path).expect("Failed to create file");
    file.write_all(b"test content").expect("Failed to write file");

    // Configure Git user
    Command::new("git")
        .current_dir(&repo_path)
        .arg("config")
        .arg("user.name")
        .arg("Test Author")
        .status()
        .expect("Failed to set git config");

    Command::new("git")
        .current_dir(&repo_path)
        .arg("config")
        .arg("user.email")
        .arg("test@author.com")
        .status()
        .expect("Failed to set git config");

    // Commit the file
    Command::new("git")
        .current_dir(&repo_path)
        .arg("add")
        .arg("test.txt")
        .status()
        .expect("Failed to add file");

    let commit_sha = Command::new("git")
        .current_dir(&repo_path)
        .arg("commit")
        .arg("-m")
        .arg("test commit")
        .output()
        .expect("Failed to commit")
        .stdout
        .lines()
        .next()
        .and_then(|line| line.split_whitespace().nth(1))
        .expect("Failed to get commit SHA");

    let expected_git_info = json!({
        "head": {
            "id": commit_sha,
            "author_name": "Test Author",
            "author_email": "test@author.com",
            "committer_name": "Test Author",
            "committer_email": "test@author.com",
            "message": "test commit"
        },
        "branch": "master",
        "remotes": []
    });

    let actual_git_info = super::get_coveralls_git_info(&commit_sha, "master");

    assert_eq!(expected_git_info, actual_git_info);
}