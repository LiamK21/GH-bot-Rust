#[test]
fn test_output_lcov_branch_count() {
  let mut file = File::create("lcov.info").unwrap();
  let results = vec![
    (
      std::path::PathBuf::from("foo/bar/a.cpp"),
      std::path::PathBuf::from("foo/bar/a.cpp"),
      CovResult {
        lines: vec![(1, 10), (2, 11)],
        branches: {
          let mut map = std::collections::BTreeMap::new();
          map.insert(1, vec![true, false, false, true, false, false]);
          map.insert(2, vec![false, false, false, true]);
          map
        },
        functions: std::collections::FxHashMap::default(),
      },
    ),
  ];
  output_lcov(results.into_iter(), Some("lcov.info"));
  let contents = std::fs::read_to_string("lcov.info").unwrap();
  assert!(contents.contains("BRF:10"));
  assert!(contents.contains("BRH:3"));
}