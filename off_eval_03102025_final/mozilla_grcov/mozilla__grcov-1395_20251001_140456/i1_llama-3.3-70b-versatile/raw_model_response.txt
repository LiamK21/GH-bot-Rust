<Filename> src/html.rs </Filename>
<imports>
use super::gen_index;
use super::HtmlGlobalStats;
use std::path::Path;
use tera::Tera;
use std::collections::BTreeMap;
use std::fs;
use super::Config;
</imports>
<Rust>
#[test]
fn test_html_index_generation() {
  let tera = Tera::new("templates").unwrap();
  let global = HtmlGlobalStats {
    dirs: BTreeMap::from([
      ("".to_string(), super::HtmlDirStats {
        files: BTreeMap::from([("file1.rs".to_string(), super::HtmlFileStats {
          stats: super::HtmlStats {
            total_lines: 10,
            covered_lines: 5,
            total_funs: 2,
            covered_funs: 1,
            total_branches: 3,
            covered_branches: 2,
          },
          abs_prefix: None,
        })]),
        stats: super::HtmlStats {
          total_lines: 10,
          covered_lines: 5,
          total_funs: 2,
          covered_funs: 1,
          total_branches: 3,
          covered_branches: 2,
        },
        abs_prefix: None,
      }),
      ("dir1".to_string(), super::HtmlDirStats {
        files: BTreeMap::from([("file2.rs".to_string(), super::HtmlFileStats {
          stats: super::HtmlStats {
            total_lines: 10,
            covered_lines: 5,
            total_funs: 2,
            covered_funs: 1,
            total_branches: 3,
            covered_branches: 2,
          },
          abs_prefix: None,
        })]),
        stats: super::HtmlStats {
          total_lines: 10,
          covered_lines: 5,
          total_funs: 2,
          covered_funs: 1,
          total_branches: 3,
          covered_branches: 2,
        },
        abs_prefix: None,
      }),
    ]),
    stats: super::HtmlStats {
      total_lines: 20,
      covered_lines: 10,
      total_funs: 4,
      covered_funs: 2,
      total_branches: 6,
      covered_branches: 4,
    },
    abs_prefix: None,
  };
  let config = Config {};
  let output = Path::new("output");
  fs::create_dir_all(output).unwrap();
  gen_index(&tera, &global, &config, output);
  let index_content = fs::read_to_string(output.join("index.html")).unwrap();
  assert!(index_content.contains("file1.rs"));
  assert!(index_content.contains("dir1"));
}</Rust>