#[test]
fn test_rewrite_paths_relative_source_directory() {
    let mut result_map = HashMap::new();
    result_map.insert("main.cpp".to_string(), Vec::new());

    let temp_dir = tempdir().unwrap();
    let test_file = temp_dir.path().join("main.cpp");
    File::create(&test_file).unwrap();

    let results = rewrite_paths(
        result_map,
        None,
        Some(temp_dir.path().to_path_buf()),
        None,
        true,
        Vec::new(),
        None,
    );

    let mut count = 0;
    for (abs_path, rel_path, _) in results {
        count += 1;
        assert!(abs_path.is_absolute());
        assert_eq!(rel_path.file_name().unwrap(), "main.cpp");
        assert_eq!(rel_path, PathBuf::from("main.cpp"));
    }
    assert_eq!(count, 1);
}