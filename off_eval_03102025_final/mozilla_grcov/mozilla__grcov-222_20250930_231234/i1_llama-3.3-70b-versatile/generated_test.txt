#[test]
fn test_non_zero_exit_on_thread_failure() {
  let handler = thread::spawn(move || {
    panic!("Test panic");
  });
  let result = handler.join();
  assert!(result.is_err());
  process::exit(1);
}