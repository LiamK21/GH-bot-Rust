<Filename>
src/output.rs
</Filename>
<imports>
use super::output_lcov;
use std::collections::HashMap;
use std::io::Cursor;
use std::io::Write;
</imports>
<Rust>
#[test]
fn test_output_lcov_with_branch_coverage() {
    let mut results = HashMap::new();
    let mut functions = HashMap::new();
    functions.insert("func1".to_string(), FunctionCoverage { executed: true });
    let branches = HashMap::from([((10, 0), true), ((10, 1), false), ((20, 0), true)]);
    let lines = HashMap::from([(10, 1), (20, 1)]);
    results.insert("file1.rs".to_string(), FileCoverage { functions, branches, lines });

    let mut buffer = Cursor::new(Vec::new());
    output_lcov(results.iter(), &mut buffer);

    let output = String::from_utf8(buffer.into_inner()).unwrap();
    let expected_output = "\
TN:\n\
SF:file1.rs\n\
FNF:1\n\
FNH:1\n\
BRDA:10,0,0,1\n\
BRDA:10,0,1,-\n\
BRDA:20,0,0,1\n\
BRF:3\n\
BRH:2\n\
DA:10,1\n\
DA:20,1\n";

    assert_eq!(output, expected_output);
}
</Rust>