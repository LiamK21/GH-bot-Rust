#[test]
fn test_partial_path_map_filtering() {
    // Setup test directory
    let test_dir = PathBuf::from("test_partial_path");
    create_dir_all(&test_dir).unwrap();

    // Create test files
    let java_file = test_dir.join("test.java");
    let non_java_file = test_dir.join("test.txt");

    // Write some content to files
    File::create(&java_file).unwrap().write_all(b"public class Test {}").unwrap();
    File::create(&non_java_file).unwrap().write_all(b"some text").unwrap();

    // Parameters for rewrite_paths
    let result_map = HashMap::new();
    let path_mapping = None;
    let source_dir = Some(&test_dir);
    let prefix_dir = None;
    let ignore_not_existing = false;
    let to_ignore_dirs = &[];
    let to_keep_dirs = &[];
    let filter_option = None;
    let file_filter = crate::FileFilter::default();

    // Run rewrite_paths with the patch applied
    let actual = rewrite_paths(
        result_map,
        path_mapping,
        source_dir,
        prefix_dir,
        ignore_not_existing,
        to_ignore_dirs,
        to_keep_dirs,
        filter_option,
        file_filter,
    );

    // Assert that only java files were processed
    assert_eq!(actual.len(), 1);
    let processed_file = &actual[0].0;
    assert!(processed_file.ends_with("test.java"));
}