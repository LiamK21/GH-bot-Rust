#[test]
fn test_lcov_branch_count() {
  let tmp_dir = tempdir().expect("Failed to create temporary directory");
  let file_name = "test_lcov_brf_brh.info";
  let file_path = tmp_dir.path().join(&file_name);
  let results = vec![
    (
      PathBuf::from("foo/bar/a.cpp"),
      PathBuf::from("foo/bar/a.cpp"),
      CovResult {
        lines: [(1, 10), (2, 11)].iter().cloned().collect(),
        branches: {
          let mut map = BTreeMap::new();
          map.insert(1, vec![true, false, false, true, false, false]);
          map.insert(2, vec![false, false, false, true]);
          map
        },
        functions: std::collections::FxHashMap::default(),
      },
    ),
  ];
  let results = Box::new(results.into_iter());
  output_lcov(results, Some(file_path.to_str().unwrap()));
  let results = fs::read_to_string(&file_path).expect("Failed to read file");
  assert!(results.contains("BRF:7\n"));
  assert!(results.contains("BRH:3\n"));
}