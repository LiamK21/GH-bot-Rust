#[test]
fn test_llvm_buffers() {
  let queue: Arc<Mutex<MsQueue<Option<<super::WorkItem>>>> = Arc::new(Mutex::new(MsQueue::new()));
  let tmp_dir = TempDir::new("grcov").expect("Failed to create temporary directory");
  let tmp_path = tmp_dir.path().to_owned();
  let paths = vec!["test/llvm/gcno.zip".to_string(), "test/llvm/gcda1.zip".to_string(), "test/llvm/gcda2.zip".to_string()];
  producer(&tmp_path, &paths, &*queue, true, true);
  let queue = queue.into_inner().unwrap();
  let mut actual = Vec::new();
  while let Some(work_item) = queue.try_pop() {
    if let Some(work_item) = work_item {
      actual.push(work_item);
    } else {
      break;
    }
  }
  assert!(actual.len() > 0);
  for work_item in actual {
    match work_item.item {
      super::ItemType::Buffers(_) => (),
      _ => assert!(false, "Expected ItemType::Buffers"),
    }
  }
}