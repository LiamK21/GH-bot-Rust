#[test]
fn test_parser_jacoco_kotlin_multiple_classes() {
    let mut lines: BTreeMap<u32, u64> = BTreeMap::new();
    for i in &[
        (5, 0),
        (9, 0),
        (14, 0),
        (27, 0),
        (30, 0),
        (32, 0),
        (41, 0),
        (49, 0),
        (57, 0),
        (65, 0),
        (73, 0),
        (81, 0),
        (89, 0),
        (97, 0),
        (104, 0),
        (105, 0),
        (106, 0),
        (107, 0),
        (108, 0),
        (109, 0),
        (110, 0),
        (111, 0),
        (112, 0),
        (118, 0),
        (119, 0),
        (120, 0),
    ] {
        lines.insert(i.0, i.1);
    }

    let mut functions: FunctionMap = FxHashMap::default();
    for (name, start, executed) in vec![
        ("ClassA#method1", 112, false),
        ("ClassB#method2", 49, false),
        ("ClassA#<clinit>", 104, false),
        ("ClassB#method3", 97, false),
    ] {
        functions.insert(String::from(name), Function { start, executed });
    }

    let mut branches: BTreeMap<u32, Vec<bool>> = BTreeMap::new();
    branches.insert(26, vec![false, false, false, false]);

    let expected = vec![(
        String::from("MultipleClasses.kt"),
        CovResult {
            lines,
            branches,
            functions,
        },
    )];

    let f =
        File::open("./test/jacoco/multiple-top-level-classes.xml").expect("Failed to open xml file");
    let file = BufReader::new(&f);
    let results = parse_jacoco_xml_report(file).unwrap();
    assert_eq!(results, expected);
}