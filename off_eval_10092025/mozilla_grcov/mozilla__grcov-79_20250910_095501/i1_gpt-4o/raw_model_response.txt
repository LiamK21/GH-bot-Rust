<Filename> src/output.rs </Filename>
<imports>
use super::output_lcov;
use std::collections::HashMap;
use std::io::Cursor;
</imports>
<Rust>
#[test]
fn test_output_lcov_with_branch_coverage() {
    let mut results = Vec::new();
    let mut functions = HashMap::new();
    functions.insert("func1".to_string(), FunctionCoverage { executed: true });
    let mut branches = HashMap::new();
    branches.insert((10, 0), true);
    branches.insert((15, 1), false);
    let mut lines = HashMap::new();
    lines.insert(10, 1);
    lines.insert(15, 0);
    results.push(CovResult {
        file: "test.rs".to_string(),
        functions,
        branches,
        lines,
    });

    let mut writer = Cursor::new(Vec::new());
    output_lcov(results.into_iter(), &mut writer);
    let output = String::from_utf8(writer.into_inner()).unwrap();

    let expected_output = "\
TN:\n\
SF:test.rs\n\
FNF:1\n\
FNH:1\n\
BRDA:10,0,0,1\n\
BRDA:15,0,1,-\n\
BRF:2\n\
BRH:1\n\
DA:10,1\n\
DA:15,0\n\
end_of_record\n";

    assert_eq!(output, expected_output);
}
</Rust>