#[test]
fn test_lcov_single_line_branches() {
    let tmp_dir = tempfile::tempdir().expect("Failed to create temporary directory");
    let file_name = "test_lcov_single_line.info";
    let file_path = tmp_dir.path().join(&file_name);

    let results = vec![(
        PathBuf::from("src/lib.rs"),
        PathBuf::from("src/lib.rs"),
        CovResult {
            lines: [(1, 10), (2, 20)].iter().cloned().collect(),
            branches: {
                let mut map = BTreeMap::new();
                // Single line with 3 branches: hit, hit, miss
                map.insert(3, vec![true, true, false]);
                map
            },
            functions: FxHashMap::default(),
        },
    )];

    let results = Box::new(results.into_iter());
    output_lcov(results, Some(file_path.to_str().unwrap()));

    let results = read_file(&file_path);

    assert!(results.contains("BRF:3\n"));  // Total 3 branches
    assert!(results.contains("BRH:2\n")); // 2 out of 3 branches hit
}