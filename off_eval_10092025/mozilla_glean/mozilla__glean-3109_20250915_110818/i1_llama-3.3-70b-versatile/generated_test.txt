#[test]
fn test_glean_init_race() {
  let initialized = Arc::new(Mutex::new(false));
  let initialized_clone = Arc::clone(&initialized);
  let handle = thread::spawn(move || {
    glean_set_collection_enabled(true);
    *initialized_clone.lock().unwrap() = true;
  });
  while *initialized.lock().unwrap() == false {
    thread::yield_now();
  }
  handle.join().unwrap();
  assert!(glean_set_ping_enabled(&"test.ping".into(), true));
}