#[test]
fn test_experiment_metric_error_reporting() {
    let glean = Glean::new("test_app_id", "test_app_version", "test_channel", "test_build_id", true);
    let long_experiment_id = "a".repeat(40);
    let long_branch = "b".repeat(40);
    let mut extra = HashMap::new();
    extra.insert("key".repeat(40), "value".repeat(40));

    let metric = ExperimentMetric::new(&glean, long_experiment_id.clone());
    metric.set_active(&glean, long_branch.clone(), Some(extra.clone()));

    let errors = glean.test_get_num_recorded_errors();
    assert!(errors > 0, "Expected errors to be recorded due to limit violations");
}