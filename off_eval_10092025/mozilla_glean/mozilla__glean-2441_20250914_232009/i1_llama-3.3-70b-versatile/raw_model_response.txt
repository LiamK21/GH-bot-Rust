<Filename> glean-core/src/event_database/mod.rs </Filename>
<imports> 
use super::EventDatabase;
use super::Glean;
use super::CommonMetricDataInternal;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_record_event_triggers_upload() {
  let glean = Glean::new();
  let event_db = EventDatabase::new();
  let meta = CommonMetricDataInternal::new();
  let timestamp = 1643723900;
  let extra = Some(HashMap::new());
  let sent_before = event_db.record(&glean, &meta, timestamp, extra.clone().unwrap());
  assert_eq!(sent_before, false);
  let mut count = 0;
  while count < 1000 {
    event_db.record(&glean, &meta, timestamp, extra.clone().unwrap());
    count += 1;
  }
  let sent_after = event_db.record(&glean, &meta, timestamp, extra.unwrap());
  assert_eq!(sent_after, true);
}</Rust>