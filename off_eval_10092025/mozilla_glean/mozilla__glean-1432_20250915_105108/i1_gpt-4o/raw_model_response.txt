<Filename>glean-core/rlb/src/lib.rs</Filename>
<imports>
use super::initialize_core_metrics;
use crate::glean_core::Glean;
use crate::glean_core::rlb::core_metrics::ClientInfoMetrics;
use crate::glean_core::rlb::core_metrics::internal_metrics;
use crate::glean_core::rlb::system;
use crate::glean_core::CommonMetricData;
use crate::glean_core::Lifetime;
use crate::glean_core::metrics::StringMetric;
</imports>
<Rust>
#[test]
fn test_initialize_core_metrics_resets_state() {
    let glean = Glean::new_temporary();
    let client_info = ClientInfoMetrics {
        app_build: "1.0".into(),
        app_display_version: "1.0.0".into(),
    };
    let channel = Some("test-channel".into());

    initialize_core_metrics(&glean, &client_info, channel.clone());

    assert_eq!(
        internal_metrics::app_build.test_get_value(None).unwrap(),
        "1.0"
    );
    assert_eq!(
        internal_metrics::app_display_version.test_get_value(None).unwrap(),
        "1.0.0"
    );
    assert_eq!(
        internal_metrics::app_channel.test_get_value(None).unwrap(),
        channel.unwrap()
    );
    assert_eq!(
        internal_metrics::os_version.test_get_value(None).unwrap(),
        "unknown"
    );
    assert_eq!(
        internal_metrics::architecture.test_get_value(None).unwrap(),
        system::ARCH
    );
    assert_eq!(
        internal_metrics::device_manufacturer.test_get_value(None).unwrap(),
        "unknown"
    );
    assert_eq!(
        internal_metrics::device_model.test_get_value(None).unwrap(),
        "unknown"
    );
}
</Rust>