#[test]
fn test_reset_glean_initializes_core_metrics() {
    let _lock = std::sync::Mutex::new(());
    let _guard = _lock.lock().unwrap();
    let dir = tempdir().unwrap();
    let tmpname = dir.path().display().to_string();
    let client_info = ClientInfoMetrics::unknown();
    test_reset_glean(
        Configuration {
            data_path: tmpname,
            application_id: "test".into(),
            upload_enabled: true,
            max_events: None,
            delay_ping_lifetime_io: false,
            channel: None,
            server_endpoint: Some("invalid-test-host".into()),
            uploader: None,
        },
        client_info,
        true,
    );
    assert!(internal_metrics::app_build.test_get_value(None).is_none());
    assert!(internal_metrics::app_display_version.test_get_value(None).is_none());
}