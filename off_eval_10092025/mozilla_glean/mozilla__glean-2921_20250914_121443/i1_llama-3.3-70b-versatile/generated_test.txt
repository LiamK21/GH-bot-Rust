#[test]
fn test_set_string_api_handles_null_values() {
  let metric: ObjectMetric<StackTrace> = ObjectMetric::new(CommonMetricData {
    name: "object".into(),
    category: "test".into(),
    send_in_pings: vec!["test1".into()],
    ..Default::default()
  });
  let arr_str = json!({
    "error": "error",
    "modules": null,
    "thread_info": null,
  })
  .to_string();
  metric.set_string(arr_str);
  let data = metric.test_get_value(None).expect("no object recorded");
  let expected = json!({
    "error": "error"
  });
  assert_eq!(expected, data);
  assert_eq!(0, metric.test_get_num_recorded_errors(ErrorType::InvalidValue));
}