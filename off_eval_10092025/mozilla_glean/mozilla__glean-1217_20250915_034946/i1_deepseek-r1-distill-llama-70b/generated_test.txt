#[test]
fn test_pending_pings_logging_after_quota() {
    let (mut glean, dir) = new_glean(None);

    // Register a ping type for testing
    let ping_type = PingType::new("test", true, true, vec![]);
    glean.register_ping_type(&ping_type);

    // Set up the policy with a small quota to test logging
    let mut upload_manager = PingUploadManager::no_policy(dir.path());
    upload_manager.policy.set_max_pending_pings_count(Some(5));

    // Submit more pings than the quota allows
    for _ in 0..10 {
        glean.submit_ping(&ping_type, None).unwrap();
    }

    // Process the pings and capture logs
    let log_capture = upload_manager.get_upload_task(&glean, false);

    // The number of logs should match the quota (5) plus any warning logs
    // This test verifies the reduction of log messages due to quota enforcement
    assert!(log_capture.is_some(), "Expected some logs to be processed");
}