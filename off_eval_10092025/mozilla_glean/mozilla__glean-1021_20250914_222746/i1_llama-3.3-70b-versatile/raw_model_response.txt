<Filename> glean-core/src/upload/mod.rs </Filename>
<imports> 
use super::PingUploadManager;
use uuid::Uuid;
use serde_json::json;
</imports>
<Rust>
#[test]
fn test_duplicate_pings_are_not_enqueued() {
  let dir = tempfile::tempdir().unwrap();
  let upload_manager = PingUploadManager::new(dir.path(), false);

  let doc_id = Uuid::new_v4().to_string();
  let path = format!("/submit/app_id/test-ping/1/{}", doc_id);

  upload_manager.enqueue_ping(&doc_id, &path, json!({}), None);
  upload_manager.enqueue_ping(&doc_id, &path, json!({}), None);

  let mut queue = upload_manager.queue.write().unwrap();
  assert_eq!(queue.len(), 1);
}</Rust>