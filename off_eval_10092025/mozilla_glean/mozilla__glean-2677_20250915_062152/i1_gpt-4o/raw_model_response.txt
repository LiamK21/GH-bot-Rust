<Filename>glean-core/src/lib_unit_tests.rs</Filename>
<imports>
use super::rkv_new;
use std::fs;
use std::path::Path;
</imports>
<Rust>
#[test]
fn test_rkv_load_state_error_handling() {
    let dir = tempfile::tempdir().unwrap();
    let safebin = dir.path().join("data.safe.bin");
    fs::write(&safebin, "<broken>").expect("write to database file");

    let result = rkv_new(dir.path());

    assert!(result.is_ok());
    let (_, load_state) = result.unwrap();
    assert!(matches!(load_state, super::RkvLoadState::Err(_)));
}
</Rust>