<Filename> glean-core/src/lib_unit_tests.rs </Filename>
<imports> 
use super::rkv_new;
use std::path::Path;
use tempfile::tempdir;
use rkv::StoreError;
</imports>
<Rust>
#[test]
fn test_rkv_load_state_is_recorded() {
  let dir = tempdir().unwrap();
  let path = dir.path().join("data.safe.bin");
  std::fs::write(path, "<broken>").expect("write to database file");
  let result = rkv_new(dir.path());
  match result {
    Ok((_, rkv_load_state)) => assert!(matches!(rkv_load_state, super::RkvLoadState::Err(_))),
    Err(_) => assert!(false, "expected Ok result"),
  }
}
</Rust>