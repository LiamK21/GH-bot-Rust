<Filename>glean-core/src/metrics/event.rs</Filename>
<imports>
use super::EventMetric;
use crate::Glean;
use crate::metrics::Metric;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_remove_glean_timestamp_in_test_mode() {
    let glean = Glean::new_temporary();
    let event_metric = EventMetric::new("category", "name", vec![], false, vec!["test"]);

    // Simulate recording an event with glean_timestamp in test mode
    let mut extra = HashMap::new();
    extra.insert("glean_timestamp".to_string(), "123456789".to_string());
    event_metric.record(&glean, None, extra);

    // Retrieve the events and check that glean_timestamp is removed
    let events = event_metric.test_get_value(&glean, "test").unwrap();
    for event in events {
        assert!(event.extra.is_none() || !event.extra.unwrap().contains_key("glean_timestamp"));
    }
}
</Rust>