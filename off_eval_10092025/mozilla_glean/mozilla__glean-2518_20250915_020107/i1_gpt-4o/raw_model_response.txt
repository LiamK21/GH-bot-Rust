<Filename>glean-core/src/lib.rs</Filename>
<imports>
use super::shutdown;
use super::initialize_inner;
use std::time::Duration;
use std::sync::{Arc, Mutex};
use std::thread;
</imports>
<Rust>
#[test]
fn test_shutdown_blocks_until_init_complete() {
    let init_called = Arc::new(Mutex::new(false));
    let init_called_clone = Arc::clone(&init_called);

    // Simulate initialize_inner being called
    thread::spawn(move || {
        thread::sleep(Duration::from_secs(1)); // Simulate some delay in init
        let mut init_called = init_called_clone.lock().unwrap();
        *init_called = true;
    });

    // Call shutdown and check if it waits for init to complete
    shutdown();

    let init_called = init_called.lock().unwrap();
    assert!(*init_called, "Shutdown did not wait for init to complete");
}
</Rust>