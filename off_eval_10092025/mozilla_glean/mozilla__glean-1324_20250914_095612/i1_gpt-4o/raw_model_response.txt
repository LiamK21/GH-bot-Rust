<Filename>glean-core/src/metrics/string.rs</Filename>
<imports>
use super::StringMetric;
use crate::tests::new_glean;
use crate::util::truncate_string_at_boundary;
use crate::Lifetime;
use crate::CommonMetricData;
</imports>
<Rust>
#[test]
fn test_set_truncates_long_string() {
    let (glean, _) = new_glean(None);

    let metric = StringMetric::new(CommonMetricData {
        name: "string_metric".into(),
        category: "test".into(),
        send_in_pings: vec!["store1".into()],
        lifetime: Lifetime::Application,
        disabled: false,
        dynamic_label: None,
    });

    let sample_string = "0123456789".repeat(11);
    metric.set(&glean, sample_string.clone());

    let truncated = truncate_string_at_boundary(sample_string, super::MAX_LENGTH_VALUE);
    assert_eq!(truncated, metric.test_get_value(&glean, "store1").unwrap());
}
</Rust>