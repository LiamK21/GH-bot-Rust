#[test]
fn test_glean_logging_does_not_break_subprocess() {
    // Enable Glean logging to a temporary file descriptor
    let (reader, writer) = std::os::windows::io::OsPipe::pair().unwrap();
    glean_enable_logging_to_fd(writer.as_raw_descriptor() as u64);

    // Verify that subprocess still works
    let result = std::panic::catch_unwind(|| {
        check_output(["hg", "--version"]);
    });

    // Ensure the subprocess call was successful
    assert!(result.is_ok(), "subprocess call failed after enabling Glean logging");

    // Cleanup
    let _ = reader.destroy();
}