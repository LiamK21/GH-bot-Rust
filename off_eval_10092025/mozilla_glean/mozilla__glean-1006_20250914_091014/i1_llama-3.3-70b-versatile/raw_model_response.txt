<Filename> lib.rs </Filename>
<imports>
use super::glean_initialize_standalone_uploader;
use std::ffi::CString;
use glean_core::upload::PingUploadManager;
</imports>
<Rust>
#[test]
fn test_rate_limiter_enabled_on_standalone_uploader() {
  let data_dir = CString::new("test_data_dir").unwrap();
  let upload_manager_before_patch = PingUploadManager::new(data_dir.to_str().unwrap().to_string(), true);
  let upload_manager_after_patch = {
    let mut upload_manager = PingUploadManager::new(data_dir.to_str().unwrap().to_string(), true);
    upload_manager.set_rate_limiter(60, 10);
    upload_manager
  };
  assert_ne!(upload_manager_before_patch.get_rate_limiter(), upload_manager_after_patch.get_rate_limiter());
  glean_initialize_standalone_uploader(data_dir);
  // Verify the rate limiter is correctly set after applying the patch
  let upload_manager_after_patch_applied = PingUploadManager::new(data_dir.to_str().unwrap().to_string(), true);
  assert_eq!(upload_manager_after_patch.get_rate_limiter(), upload_manager_after_patch_applied.get_rate_limiter());
}
</Rust>