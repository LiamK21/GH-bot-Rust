#[test]
fn test_halstead_metrics_after_patch() {
    let code = "
        fn main() {
            let a = 5;
            let b = 7.0;
            let c = 3;
            let avg = (a + c) / 2;
            println!(\"{}\", avg);
        }
    ";
    let lang = Language::Rust;
    let metric = HalsteadMetric::new(code, lang).analyze();

    insta::assert_json_snapshot!(
        metric,
        @r###"
        {
          "n1": 10.0,
          "N1": 23.0,
          "n2": 9.0,
          "N2": 15.0,
          "length": 38.0,
          "estimated_program_length": 61.74860596185444,
          "purity_ratio": 1.624963314785643,
          "vocabulary": 19.0,
          "volume": 161.42124551085624,
          "difficulty": 8.333333333333334,
          "level": 0.12,
          "effort": 1345.177045923802,
          "time": 74.7320581068779,
          "bugs": 0.040619232256751396
        }"###
    );
}