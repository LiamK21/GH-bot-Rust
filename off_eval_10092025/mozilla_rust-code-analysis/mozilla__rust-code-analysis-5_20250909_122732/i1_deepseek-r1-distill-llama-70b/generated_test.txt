#[test]
fn test_file_name_based_language_detection() {
    let mut server = TestServer::new(|| {
        ast_parser(AstPayload {
            id: "test".to_string(),
            file_name: "test.cpp".to_string(),
            code: "int x = 1;".to_string(),
            comment: true,
            span: true,
        }, HttpRequest)
    });

    let expected = json!({
        "id": "test",
        "file_name": "test.cpp",
        "code": "int x = 1;",
        "comment": true,
        "span": true
    });

    let resp = server.post_json("/ast", &expected).unwrap();
    assert!(resp.status().is_success());
}