#[test]
fn test_transport_parameters_initialized_correctly() {
    let mut conn_params = ConnectionParameters::default();
    conn_params.set_max_data(1000);
    conn_params.set_max_stream_data(StreamType::BiDi, 2000);
    conn_params.set_max_stream_data(StreamType::UniDi, 3000);
    conn_params.set_max_streams(StreamType::BiDi, 4);
    conn_params.set_max_streams(StreamType::UniDi, 5);

    let mut cid_manager = ConnectionIdManager::new(&mut rand::thread_rng(), vec![1,2,3,4,5,6,7,8,9,10,11,12]);

    let role = Role::Client;
    let tps_result = conn_params.create_transport_parameter(role, &mut cid_manager);

    assert!(tps_result.is_ok());
    let tps = tps_result.unwrap();

    // Check default parameters
    let recv_buffer_size = tparams::INITIAL_MAX_STREAM_DATA_BIDI_REMOTE;
    let expected_recv_buffer_size = RECV_BUFFER_SIZE as u64;
    assert_eq!(tps.local.get_integer(recv_buffer_size).unwrap(), expected_recv_buffer_size);

    let idle_timeout = tparams::IDLE_TIMEOUT;
    let expected_idle_timeout = LOCAL_IDLE_TIMEOUT.as_millis() as u64;
    assert_eq!(tps.local.get_integer(idle_timeout).unwrap(), expected_idle_timeout);

    let active_cid_limit = tparams::ACTIVE_CONNECTION_ID_LIMIT;
    let expected_active_cid_limit = LOCAL_ACTIVE_CID_LIMIT as u64;
    assert_eq!(tps.local.get_integer(active_cid_limit).unwrap(), expected_active_cid_limit);

    // Check configurable parameters
    let initial_max_data = tparams::INITIAL_MAX_DATA;
    assert_eq!(tps.local.get_integer(initial_max_data).unwrap(), 1000);

    let initial_max_stream_data_bidi_local = tparams::INITIAL_MAX_STREAM_DATA_BIDI_LOCAL;
    assert_eq!(tps.local.get_integer(initial_max_stream_data_bidi_local).unwrap(), 2000);

    let initial_max_stream_data_uni_local = tparams::INITIAL_MAX_STREAM_DATA_UNI;
    assert_eq!(tps.local.get_integer(initial_max_stream_data_uni_local).unwrap(), 3000);

    let initial_max_streams_bidi = tparams::INITIAL_MAX_STREAMS_BIDI;
    assert_eq!(tps.local.get_integer(initial_max_streams_bidi).unwrap(), 4);

    let initial_max_streams_uni = tparams::INITIAL_MAX_STREAMS_UNI;
    assert_eq!(tps.local.get_integer(initial_max_streams_uni).unwrap(), 5);
}