#[test]
fn test_next_bytes_reduces_cpu_usage() {
  let mut range_tracker = RangeTracker::default();
  let mut used: BTreeMap<u64, (u64, super::RangeState)> = BTreeMap::new();
  used.insert(0, (100, super::RangeState::New));
  used.insert(200, (100, super::RangeState::New));
  range_tracker.used = used;

  let iterations = 10000;
  let mut calls = 0;
  for _ in 0..iterations {
    range_tracker.first_unmarked_range();
    calls += 1;
  }
  assert!(calls == iterations);
}