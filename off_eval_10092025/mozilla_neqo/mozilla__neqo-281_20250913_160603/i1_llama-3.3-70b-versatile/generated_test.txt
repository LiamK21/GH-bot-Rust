#[test]
fn test_handle_connection_closing() {
  let mut connection = Http3Connection::default();
  connection.state = Http3State::Active;
  let error_code = CloseError::Application(0);
  let result_before_patch = std::panic::catch_unwind(|| connection.handle_connection_closing(error_code));
  assert!(result_before_patch.is_err());

  connection.state = Http3State::Closing(error_code);
  let result_after_patch = std::panic::catch_unwind(|| connection.handle_connection_closing(error_code));
  assert!(result_after_patch.is_ok());
}