<Filename> neqo-client/src/main.rs </Filename>
<imports>
use super::StreamHandlerType;
use super::Url;
use super::Args;
use super::PathBuf;
use super::Http3Client;
use super::StreamId;
</imports>
<Rust>
#[test]
fn test_stream_handler_closes_stream_on_download() {
  let url = Url::parse("https://example.com").unwrap();
  let args = Args { output_dir: "/tmp".to_string() };
  let mut all_paths = Vec::new();
  let mut client = Http3Client::new();
  let client_stream_id = StreamId::new(1);
  let handler_type = StreamHandlerType::Download;
  let handler_before_patch = StreamHandlerType::create_stream_handler(handler_type, &url, &args, &mut all_paths);
  let handler_after_patch = StreamHandlerType::create_stream_handler(handler_type, &url, &args, &mut all_paths, &mut client, client_stream_id);
  assert_ne!(handler_before_patch, handler_after_patch);
  assert!(client.stream_close_send(client_stream_id).is_ok());
}</Rust>