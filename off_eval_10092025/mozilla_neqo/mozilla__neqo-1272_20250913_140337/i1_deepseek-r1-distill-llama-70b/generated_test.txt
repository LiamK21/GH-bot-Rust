#[test]
fn test_dump_packet_logging() {
    struct DummyConnection;

    let file_path = PathBuf::from("test.dump");
    let _file = File::create(&file_path).unwrap();

    set_max_level(Level::Info);
    dump_packet(
        &DummyConnection,
        &file_path,
        "test",
        PacketType::Data,
        0,
        &[],
    );
    let metadata = std::fs::metadata(&file_path).unwrap();
    assert_eq!(metadata.len(), 0);

    set_max_level(Level::Debug);
    dump_packet(
        &DummyConnection,
        &file_path,
        "test",
        PacketType::Data,
        0,
        &[],
    );
    let metadata = std::fs::metadata(&file_path).unwrap();
    assert!(metadata.len() > 0);

    std::fs::remove_file(&file_path).unwrap();
}