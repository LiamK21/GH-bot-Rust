#[test]
fn test_stream_frame_fills_remaining_space() {
    let mut encoder = Encoder::new();
    let stream_id = 5;
    let offset = 0;
    let data = vec![1, 2, 3];
    let fin = true;
    let remaining = 5; // Space for type (1) + stream_id (1) + data (3)

    let (frame, _length) = Frame::new_stream(stream_id, offset, &data, fin, remaining);

    // The frame should have fill set to true and no length field
    if let Stream { fill, data, .. } = frame {
        assert!(fill);
        assert_eq!(data.len(), 3);
    } else {
        panic!("Frame is not a Stream frame");
    }

    // Encode the frame and check the length
    frame.marshal(&mut encoder);
    assert_eq!(encoder.bytes().len(), remaining);
}