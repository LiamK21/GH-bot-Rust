#[test]
fn test_stream_frame_length() {
  let mut encoder = Encoder::new();
  let stream_id: u64 = 5;
  let offset: u64 = 0;
  let data: &[u8] = &[1, 2, 3];
  let fin: bool = true;
  let space: usize = 10;
  let (frame, length) = Frame::new_stream(stream_id, offset, data, fin, space);
  let expected_length = if data.len() > space - 1 - Encoder::varint_len(stream_id) {
    space - 1 - Encoder::varint_len(stream_id)
  } else if data.len() == space - 1 - Encoder::varint_len(stream_id) {
    data.len()
  } else {
    data.len()
  };
  assert_eq!(length, expected_length);
}