#[test]
fn test_encoder_length_within_pmtu() {
  let mut connection = Connection::new();
  let mut encoder = Vec::new();
  let token = Some(token);
  connection.tokens.push(token);
  encoder.push(1);
  assert!(connection.pmtu() > encoder.len());
  connection.tokens.clear();
  encoder.clear();
  for _ in 0..connection.pmtu() {
    encoder.push(1);
  }
  assert_eq!(encoder.len(), connection.pmtu());
  connection.tokens.push(token);
  assert!(encoder.len() <= connection.pmtu());
}