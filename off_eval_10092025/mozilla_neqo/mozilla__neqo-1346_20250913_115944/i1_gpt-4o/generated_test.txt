#[test]
fn test_send_arbitrary_amounts_of_data() {
    let args = Args::default();
    let anti_replay = AntiReplay::new(Instant::now());
    let cid_mgr = Rc::new(RefCell::new(RandomConnectionIdGenerator::new(0)));
    let mut server = SimpleServer::new(&args, anti_replay, cid_mgr);

    let headers = vec![Header::new(":path", "/10000")];
    let stream_id = StreamId::try_from(0).unwrap();
    let mut stream = Http3OrWebTransportStream::new(stream_id, &headers);

    server.process_events(&args, Instant::now());

    if let Some(Http3ServerEvent::Headers { stream: _, headers: _, fin: _ }) = server.server.next_event() {
        server.process_events(&args, Instant::now());
    }

    let response_data = server.remaining_data.get(&stream_id).unwrap();
    assert_eq!(response_data.remaining, 10000);
}