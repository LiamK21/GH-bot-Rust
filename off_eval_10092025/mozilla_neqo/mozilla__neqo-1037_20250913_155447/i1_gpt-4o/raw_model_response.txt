<Filename>neqo-server/src/old_https.rs</Filename>
<imports>
use super::Http09Server;
use neqo_common::Datagram;
use neqo_crypto::AntiReplay;
use neqo_transport::server::ActiveConnectionRef;
use std::cell::RefCell;
use std::rc::Rc;
use std::time::Instant;
</imports>
<Rust>
#[test]
fn test_stream_readable_handles_partial_data() {
    let anti_replay = AntiReplay::new(Instant::now(), std::time::Duration::from_secs(10), 7, 14).unwrap();
    let cid_manager = Rc::new(RefCell::new(neqo_transport::FixedConnectionIdManager::new(10)));
    let mut server = Http09Server::new(Instant::now(), &["key"], &["alpn"], anti_replay, cid_manager).unwrap();
    
    let mut conn = ActiveConnectionRef::default();
    let stream_id = 4;
    let partial_data = b"GET /some/partial/data";
    let dgram = Datagram::new("127.0.0.1:4433".parse().unwrap(), "127.0.0.1:4433".parse().unwrap(), partial_data);
    
    server.process(Some(dgram), Instant::now());
    server.stream_readable(stream_id, &mut conn, &Args::default());
    
    assert!(server.read_state.contains_key(&stream_id));
}
</Rust>