<Filename>neqo-http3/src/hframe.rs</Filename>
<imports>
use super::HFrameReader;
use super::connect;
use super::StreamType;
use super::Error;
use super::HFrame;
use super::Encoder;
use super::now;
</imports>
<Rust>
#[test]
fn test_stream_closed_before_sending_data() {
    let (mut conn_c, mut conn_s) = connect();

    // create a stream
    let stream_id = conn_s.stream_create(StreamType::BiDi).unwrap();
    conn_s.stream_send(stream_id, &[0x00]).unwrap();
    let out = conn_s.process(None, now());
    conn_c.process(out.dgram(), now());

    let mut fr: HFrameReader = HFrameReader::new();
    assert_eq!(Ok(()), conn_c.stream_close_send(stream_id));
    let out = conn_c.process(None, now());
    conn_s.process(out.dgram(), now());
    assert_eq!(Ok(true), fr.receive(&mut conn_s, stream_id));
}
</Rust>