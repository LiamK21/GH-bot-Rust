<Filename>neqo-udp/src/lib.rs</Filename>
<imports>
use super::Socket;
use super::Datagram;
use super::RecvBuf;
use std::net::UdpSocket;
use std::net::SocketAddr;
</imports>
<Rust>
#[test]
fn test_send_ignore_emsgsize() {
    let sender = Socket::new(UdpSocket::bind("127.0.0.1:0").unwrap()).unwrap();
    let receiver = Socket::new(UdpSocket::bind("127.0.0.1:0").unwrap()).unwrap();
    let receiver_addr: SocketAddr = receiver.inner.local_addr().unwrap();

    // Send oversized datagram and expect `EMSGSIZE` error to be ignored.
    let oversized_datagram = Datagram::new(
        sender.inner.local_addr().unwrap(),
        receiver.inner.local_addr().unwrap(),
        vec![0; 65536],
    );
    sender.send(&oversized_datagram).unwrap();

    // Now send a normal datagram to ensure that the socket is still usable.
    let normal_datagram = Datagram::new(
        sender.inner.local_addr().unwrap(),
        receiver.inner.local_addr().unwrap(),
        b"Hello World!".to_vec(),
    );
    sender.send(&normal_datagram).unwrap();

    let mut recv_buf = RecvBuf::new();
    // Block until "Hello World!" is received.
    receiver.inner.set_nonblocking(false).unwrap();
    let mut received_datagram = receiver.recv(receiver_addr, &mut recv_buf).unwrap();
    assert_eq!(
        received_datagram.next().unwrap().as_ref(),
        b"Hello World!"
    );
}
</Rust>