<Filename> neqo-transport/src/recovery.rs </Filename>
<imports> 
use super::LossRecovery;
use super::PNSpace;
use std::time::Instant;
use std::time::Duration;
use std::collections::BTreeMap;
</imports>
<Rust>
#[test]
fn test_detect_lost_packets() {
  let mut loss_recovery = LossRecovery::default();
  let pn_space = PNSpace::ApplicationData;
  let mut sent_packets = BTreeMap::new();
  let packet = SentPacket {
    ack_eliciting: true,
    time_sent: Instant::now() - Duration::from_millis(100),
    tokens: vec![],
    time_declared_lost: None,
  };
  sent_packets.insert(1, packet);
  let lost_packets = loss_recovery.detect_lost_packets(pn_space, Instant::now());
  assert_eq!(lost_packets.len(), 1);
  let packet = SentPacket {
    ack_eliciting: true,
    time_sent: Instant::now() - Duration::from_millis(100),
    tokens: vec![],
    time_declared_lost: Some(Instant::now() - Duration::from_millis(200)),
  };
  sent_packets.insert(2, packet);
  loss_recovery.spaces[pn_space].sent_packets = sent_packets;
  let lost_packets = loss_recovery.detect_lost_packets(pn_space, Instant::now() + Duration::from_millis(400));
  assert_eq!(loss_recovery.spaces[pn_space].sent_packets.len(), 1);
}</Rust>