#[test]
fn test_evict_to_no_infinite_loop() {
    let mut table = HeaderTable::new(true);
    table.set_capacity(10000).unwrap();

    table.insert(b"header1", b"value1").unwrap();
    table.insert(b"header2", b"value2").unwrap();

    table.increment_acked(1).unwrap();

    let first_entry_size = table.get_dynamic_with_abs_index(0).unwrap().size() as u64;

    assert!(table.can_evict_to(first_entry_size));
    assert!(!table.can_evict_to(0));
}