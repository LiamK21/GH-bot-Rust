#[test]
fn test_qns_test_response() {
    let anti_replay = AntiReplay::new(Instant::now(), 7, 7, 14).expect("unable to setup anti-replay");
    let cid_mgr = Rc::new(RefCell::new(RandomConnectionIdGenerator::new(10)));

    let mut server = HttpServer::new(
        &Args {
            // Initialize Args with necessary fields, set qns_test to Some
            shared: SharedArgs {
                qns_test: Some(()),
                ..Default::default()
            },
            ..Default::default()
        },
        anti_replay,
        cid_mgr,
    ).expect("Failed to create server");

    // Simulate a request
    let dgram = Datagram::new(b"GET /qns-test-file HTTP/1.1\r\nHost: example.com\r\n\r\n".to_vec());
    let mut acr = ActiveConnectionRef::new(&mut server.server);

    server.process(Some(&dgram), Instant::now());
    server.process_events(Instant::now());

    // Check if the response data matches the expected QNS response
    let response_data = server.remaining_data.get(&1).unwrap().clone();
    let expected_data = qns_read_response("qns-test-file").unwrap();

    assert_eq!(response_data, expected_data);
}