#[test]
fn test_close_state_transitions() {
    let args = Args::default();
    let local_addr = "127.0.0.1:0".parse().unwrap();
    let remote_addr = "127.0.0.1:4433".parse().unwrap();
    let client = create_client(&args, local_addr, remote_addr, "example.com", None).unwrap();

    client.close(Instant::now(), 0, "test close");
    let result = client.is_closed().unwrap();

    assert!(matches!(result, CloseState::Closed));
    let error = client.is_closed().unwrap_err();
    assert!(!error.is_error());
}