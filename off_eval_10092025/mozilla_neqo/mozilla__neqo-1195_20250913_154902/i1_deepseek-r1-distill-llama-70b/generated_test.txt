#[test]
fn test_stream_removal_on_fin() {
    let mut handler = Handler::new();
    let mut client = Http3Client::new(Instant::now());

    // Add a test stream
    handler.streams.insert(1, None);

    // Simulate receiving a HeaderReady event with fin=true
    let event = Http3ClientEvent::HeaderReady {
        stream_id: 1,
        headers: vec![],
        fin: true,
        ..Default::default()
    };

    handler.handle(&mut client);

    // After processing, the stream should be removed
    assert!(handler.streams.is_empty());
}