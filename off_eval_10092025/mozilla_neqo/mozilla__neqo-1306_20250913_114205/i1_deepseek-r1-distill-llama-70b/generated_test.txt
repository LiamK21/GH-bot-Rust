#[test]
fn test_pseudo_header_handling() {
    // Test case 1: Valid request headers
    let request_headers = vec![
        Header(":method".to_string(), "GET".to_string()),
        Header(":scheme".to_string(), "http".to_string()),
        Header(":authority".to_string(), "example.com".to_string()),
        Header(":path".to_string(), "/test".to_string()),
    ];
    assert!(headers_valid(&request_headers, MessageType::Request).is_ok());

    // Test case 2: Valid response headers
    let response_headers = vec![Header(":status".to_string(), "200".to_string())];
    assert!(headers_valid(&response_headers, MessageType::Response).is_ok());

    // Test case 3: Duplicate pseudo header
    let duplicate_headers = vec![
        Header(":method".to_string(), "GET".to_string()),
        Header(":method".to_string(), "POST".to_string()),
    ];
    assert!(matches!(
        headers_valid(&duplicate_headers, MessageType::Request),
        Err(Error::InvalidHeader)
    ));

    // Test case 4: Missing required pseudo headers for request
    let missingAuthority_headers = vec![
        Header(":method".to_string(), "GET".to_string()),
        Header(":scheme".to_string(), "http".to_string()),
        Header(":path".to_string(), "/test".to_string()),
    ];
    assert!(matches!(
        headers_valid(&missingAuthority_headers, MessageType::Request),
        Err(Error::InvalidHeader)
    ));

    // Test case 5: CONNECT request with required headers
    let connect_headers = vec![
        Header(":method".to_string(), "CONNECT".to_string()),
        Header(":authority".to_string(), "example.com".to_string()),
    ];
    assert!(headers_valid(&connect_headers, MessageType::Request).is_ok());

    // Test case 6: CONNECT request with extra pseudo header
    let connect_extra_headers = vec![
        Header(":method".to_string(), "CONNECT".to_string()),
        Header(":authority".to_string(), "example.com".to_string()),
        Header(":scheme".to_string(), "http".to_string()),
    ];
    assert!(matches!(
        headers_valid(&connect_extra_headers, MessageType::Request),
        Err(Error::InvalidHeader)
    ));
}