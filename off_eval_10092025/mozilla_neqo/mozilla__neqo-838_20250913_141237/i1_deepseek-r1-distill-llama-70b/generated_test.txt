#[test]
fn test_pto_probes_do_not_overflow_congestion_window() {
    let mut lr = LossRecovery::new();
    let now = Instant::from_millis(0);

    // Send initial packets to trigger PTO
    lr.on_packet_sent(SentPacket::new(
        PacketType::Handshake,
        0,
        now,
        true,
        Rc::default(),
        100,
    ));

    // Simulate PTO expiration
    let pto = lr.pto_period(PNSpace::ApplicationData);
    let pto_time = now + pto;

    // Verify that PTO probes are correctly accounted for
    lr.on_packet_sent(SentPacket::new(
        PacketType::Short,
        1,
        pto_time,
        true,
        Rc::default(),
        100,
    ));

    // Check that congestion window is correctly updated
    assert_eq!(lr.cc.bytes_in_flight(), 200);
}