#[test]
fn test_pmtud_with_gso() {
    let mut path = Arc::new(PathParams::default());
    path.borrow_mut().set_plpmtu(100);

    let mut conn = Connection::new(&path);

    let send_buffer = Vec::new();
    let now = 0;

    let result = conn.output_dgram_batch_on_path(
        &send_buffer,
        10,
        now,
    );

    assert!(result.is_ok());

    let batch = result.unwrap();
    assert_eq!(batch.num_datagrams(), 1);
}