#[test]
fn test_encoder_borrows_buffer() {
    let mut buffer = [0; 4];
    let mut encoder = Encoder::new_borrowed_slice(&mut buffer[..]);

    // Encode a simple value
    encoder.encode_byte(0x01);
    encoder.encode_byte(0x02);

    // Verify the buffer was written without copying
    assert_eq!(buffer, [0x01, 0x02, 0, 0]);
    assert_eq!(encoder.len(), 2);
}