#[test]
fn test_server_udp_no_alloc() {
    // Initialize server and client
    let server_addr: SocketAddr = "127.0.0.1:0".parse().unwrap();
    let mut runner = ServerRunner::new(server_addr, Box::new(HttpServer::new()));

    // Set up UDP socket
    let socket = Socket::bind("127.0.0.1:0".parse().unwrap()).unwrap();

    // Test datagram
    let test_data = b"test";
    let mut buf = [0; 1024];

    // Clear allocation counter
    let _ = alloc_counter::enable();
    let allocs = alloc_counter::Allocs::new();

    // Send request
    socket.send_to(test_data, &server_addr).unwrap();

    // Process response
    let now = Instant::now();
    runner.process().await.unwrap();

    // Check for allocations
    assert_eq!(allocs.count(), 0);
}