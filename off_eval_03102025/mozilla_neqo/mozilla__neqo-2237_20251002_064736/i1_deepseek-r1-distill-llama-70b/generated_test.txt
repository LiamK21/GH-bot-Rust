#[test]
fn test_send_inner_returns_io_error() {
    let socket = UdpSocket::bind("0.0.0.0:0").unwrap();
    let socket = quinn_udp::UdpSockRef::new(socket);
    let datagram = Datagram::new(&[1, 2, 3][..].into());

    // Close the socket to simulate an IO error
    socket.close().unwrap();

    let result = send_inner(
        &UdpSocketState::new(),
        socket,
        &datagram,
    );

    assert!(result.is_err());
}