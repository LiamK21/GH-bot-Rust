<Filename>neqo-transport/src/connection.rs</Filename>
<imports>
use super::Connection;
use crate::events::ConnectionEvent;
use crate::tests::{default_client, default_server, connect};
use crate::stream_id::StreamType;
</imports>
<Rust>
#[test]
fn test_send_stream_writable_with_flow_control() {
    let mut client = default_client();
    let mut server = default_server();
    connect(&mut client, &mut server);

    let stream_id = client.stream_create(StreamType::UniDi).unwrap();
    assert_eq!(stream_id, 2);

    client.handle_max_data(100_000);
    let evts = client.events().collect::<Vec<_>>();
    assert_eq!(evts.len(), 1);
    assert!(matches!(evts[0], ConnectionEvent::SendStreamWritable{..}));
}
</Rust>