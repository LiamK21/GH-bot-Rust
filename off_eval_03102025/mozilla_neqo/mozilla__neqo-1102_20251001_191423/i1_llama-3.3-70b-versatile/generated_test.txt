#[test]
fn test_packet_build_insufficient_space() {
    let mut builder = PacketBuilder::short(Encoder::with_capacity(100), true, &ConnectionId::from(&[0u8; 8]));
    builder.pn(0, 1);
    builder.set_limit(75);
    builder.pad();
    let encoder = builder.build(&mut CryptoDxState::test_default()).unwrap();
    let mut builder = PacketBuilder::long(encoder, PNSpace::Initial, QuicVersion::default(), &ConnectionId::from(&[0u8; 8]), &ConnectionId::from(&[0u8; 8]));
    assert_eq!(builder.remaining(), 0);
    let encoder_copy = builder.abort();
    assert_eq!(encoder_copy.len(), 100);
}