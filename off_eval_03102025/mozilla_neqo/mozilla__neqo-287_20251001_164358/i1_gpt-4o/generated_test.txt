#[test]
fn test_encoder_len_exceeds_pmtu() {
    let mut connection = Connection::new();
    let mut encoder = Vec::new();
    encoder.resize(connection.pmtu() + 1, 0); // Make encoder length exceed PMTU
    let mut out_bytes = Vec::new();
    let token = None;
    let mut tokens = Vec::new();

    // This should not panic after the patch
    connection.some_function(&mut encoder, &mut out_bytes, token, &mut tokens);
}