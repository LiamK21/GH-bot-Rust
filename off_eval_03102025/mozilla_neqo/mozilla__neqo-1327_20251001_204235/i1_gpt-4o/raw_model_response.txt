<Filename>neqo-crypto/src/agent.rs</Filename>
<imports>
use super::get_alpn;
use std::ptr::null_mut;
use crate::err::Res;
use crate::ssl;
</imports>
<Rust>
#[test]
fn test_get_alpn() {
    let fd: *mut ssl::PRFileDesc = null_mut();
    let pre = false;
    let alpn_state = ssl::SSLNextProtoState::SSL_NEXT_PROTO_NEGOTIATED;
    let chosen = vec![104, 116, 116, 112, 47, 49, 46, 49]; // "http/1.1"
    let chosen_len = chosen.len() as u32;

    unsafe {
        ssl::SSL_GetNextProtoNego(fd, &mut alpn_state, chosen.as_ptr(), &mut chosen_len);
    }

    let expected = Some("http/1.1".to_string());
    let actual = get_alpn(fd, pre).unwrap();

    assert_eq!(expected, actual);
}
</Rust>