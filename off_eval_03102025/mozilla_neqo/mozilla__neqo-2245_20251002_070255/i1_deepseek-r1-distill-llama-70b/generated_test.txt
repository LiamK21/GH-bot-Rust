#[test]
fn test_take_ranges_optimization() {
    let mut packets = SentPackets::new();
    // Insert 100 packets
    for i in 1..=100 {
        let packet = format!("packet{}", i);
        packets.insert(i.into(), packet);
    }

    // Simulate an ACK range from 1 to 2
    let acked_range = 1..=2;
    let result = packets.take_ranges(vec![acked_range.into()]);

    // After ACK, packets 3-100 should remain
    assert_eq!(packets.len(), 98);
    assert_eq!(result.len(), 2);
}