#[test]
fn test_datagram_priority() {
  let mut connection = Connection::new();
  let mut builder = FrameBuilder::new();
  let mut stats = Stats::new();
  let tokens = Tokens::new();

  connection.streams.write_frames(TransmissionPriority::Critical, &mut builder, &mut tokens, &mut stats.frame_tx);
  connection.datagrams.write_frames(&mut builder, &mut tokens, &mut stats.frame_tx);

  let actual = builder.frames.len();

  let mut expected_builder = FrameBuilder::new();
  connection.streams.write_frames(TransmissionPriority::Critical, &mut expected_builder, &mut tokens, &mut stats.frame_tx);

  assert_eq!(actual, expected_builder.frames.len());
}