#[test]
fn test_on_ack_does_not_update_rtt_when_send_time_is_in_future() {
    struct MockRtt {
        updated: bool,
    }

    impl MockRtt {
        fn new() -> Self {
            Self { updated: false }
        }

        fn update(&mut self, _qlog: &mut dyn std::any::Any, _sample: Duration, _ack_delay: Duration, _confirmed: bool, _now: Instant) {
            self.updated = true;
        }
    }

    let mut recovery = LossRecovery {
        qlog: None,
        rtt: MockRtt::new(),
        confirmed_time: None,
    };

    let send_time = Instant::now() + Duration::from_secs(1);
    let now = Instant::now();

    recovery.on_ack(&mut MockRtt::new(), send_time, Duration::from_secs(1), now);

    assert!(!recovery.rtt.updated);
}