#[test]
fn test_idle_timeout_expiry() {
    let mut idle_timeout = IdleTimeout::new();
    let now = Instant::now();
    let pto = Duration::from_secs(1);

    // Test Init state
    let expiry_init = idle_timeout.expiry(now, pto);
    assert_eq!(expiry_init, now + Duration::from_secs(3));

    // Test New state
    idle_timeout.state = IdleTimeoutState::New(now);
    let expiry_new = idle_timeout.expiry(now, pto);
    assert_eq!(expiry_new, now + Duration::from_secs(3));

    // Test PacketReceived state
    idle_timeout.state = IdleTimeoutState::PacketReceived(now);
    let expiry_received = idle_timeout.expiry(now, pto);
    assert_eq!(expiry_received, now + Duration::from_secs(3));

    // Test AckElicitingPacketSent state
    idle_timeout.state = IdleTimeoutState::AckElicitingPacketSent(now);
    let expiry_ack = idle_timeout.expiry(now, pto);
    assert_eq!(expiry_ack, now + Duration::from_secs(3));
}