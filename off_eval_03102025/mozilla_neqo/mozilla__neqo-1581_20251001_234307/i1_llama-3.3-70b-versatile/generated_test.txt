#[test]
fn test_emit_packet() {
  let mut socket = UdpSocket::bind("127.0.0.1:0").unwrap();
  let mut dgram = Datagram::new(Vec::new(), SocketAddr::new("127.0.0.1".parse().unwrap(), 1234));
  let mut runner = ServersRunner::new(Args::from_args()).unwrap();
  runner.sockets.push((SocketAddr::new("127.0.0.1".parse().unwrap(), 1234), socket));
  runner.find_socket(SocketAddr::new("127.0.0.1".parse().unwrap(), 1234));
  let result = tokio::runtime::Builder::new_multi_thread().enable_all().build().unwrap().block_on(async {
    let sent = emit_packet(&mut runner.sockets[0].1, dgram).await;
    assert!(sent.is_ok());
    Ok(())
  });
  assert!(result.is_ok());
}