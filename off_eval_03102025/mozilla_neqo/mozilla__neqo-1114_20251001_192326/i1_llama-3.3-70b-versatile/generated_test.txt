#[test]
fn test_create_transport_parameter() {
  let mut cid_manager = ConnectionIdManager::new(&mut Default::default(), [1; 8].into());
  let role = Role::Server;
  let conn_params = ConnectionParameters::default();
  let expected_tps = {
    let mut tps = TransportParametersHandler::default();
    tps.local.set_integer(tparams::INITIAL_MAX_STREAM_DATA_BIDI_REMOTE, u64::try_from(RECV_BUFFER_SIZE).unwrap());
    tps.local.set_integer(tparams::IDLE_TIMEOUT, u64::try_from(LOCAL_IDLE_TIMEOUT.as_millis()).unwrap());
    tps.local.set_integer(tparams::ACTIVE_CONNECTION_ID_LIMIT, u64::try_from(LOCAL_ACTIVE_CID_LIMIT).unwrap());
    tps.local.set_empty(tparams::DISABLE_MIGRATION);
    tps.local.set_empty(tparams::GREASE_QUIC_BIT);
    tps.local.set_integer(tparams::INITIAL_MAX_DATA, conn_params.get_max_data());
    tps.local.set_integer(tparams::INITIAL_MAX_STREAM_DATA_BIDI_LOCAL, conn_params.get_max_stream_data(StreamType::BiDi));
    tps.local.set_integer(tparams::INITIAL_MAX_STREAM_DATA_UNI, conn_params.get_max_stream_data(StreamType::UniDi));
    tps.local.set_integer(tparams::INITIAL_MAX_STREAMS_BIDI, conn_params.get_max_streams(StreamType::BiDi).as_u64());
    tps.local.set_integer(tparams::INITIAL_MAX_STREAMS_UNI, conn_params.get_max_streams(StreamType::UniDi).as_u64());
    tps
  };
  let actual_tps = conn_params.create_transport_parameter(role, &mut cid_manager).unwrap();
  assert_eq!(expected_tps, actual_tps);
}