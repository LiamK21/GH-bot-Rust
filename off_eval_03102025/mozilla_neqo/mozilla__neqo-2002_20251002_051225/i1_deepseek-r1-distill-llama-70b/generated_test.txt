#[test]
fn test_socket_nonblocking() -> Result<(), std::io::Error> {
    let socket = socket()?;
    // Check if the socket is non-blocking by attempting a receive without data.
    let mut buf = [0; 1];
    match socket.inner.recv(&mut buf) {
        Ok(0) => (),
        Err(e) => {
            if e.kind() != std::io::ErrorKind::WouldBlock {
                panic!("Expected WouldBlock, got {:?}", e);
            }
        },
    }
    Ok(())
}