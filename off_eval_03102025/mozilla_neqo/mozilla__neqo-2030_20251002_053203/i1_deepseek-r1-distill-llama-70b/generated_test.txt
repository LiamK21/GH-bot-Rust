#[test]
fn test_init_fails_on_old_nss_version() {
    // Mock an old NSS version
    let original_version_check = unsafe { nss::NSS_VersionCheck };
    unsafe {
        nss::NSS_VersionCheck = || 0;
    }

    let result = init();

    // Restore original behavior
    unsafe {
        nss::NSS_VersionCheck = original_version_check;
    }

    assert!(matches!(result, Err(Error::UnsupportedVersion)));
}