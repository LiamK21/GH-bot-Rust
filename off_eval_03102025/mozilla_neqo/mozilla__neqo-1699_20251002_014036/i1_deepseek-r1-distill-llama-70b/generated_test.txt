#[test]
fn test_init_behavior() {
    // Test when max level is Off
    let result = set_max_level(LevelFilter::Off);
    assert!(result.is_ok());

    let init_once = Once::new();
    let handle = std::thread::spawn({
        let init_once = init_once;
        move || {
            init_once.call_once(|| {
                // If init() doesn't run, this won't print
                eprintln!("init() ran when it shouldn't have");
            });
        }
    });

    handle.join().unwrap();

    // Test when max level is higher
    let result = set_max_level(LevelFilter::Debug);
    assert!(result.is_ok());

    let init_once = Once::new();
    let handle = std::thread::spawn({
        let init_once = init_once;
        move || {
            init_once.call_once(|| {
                // If init() runs, this will print
                eprintln!("init() ran as expected");
            });
        }
    });

    handle.join().unwrap();
}