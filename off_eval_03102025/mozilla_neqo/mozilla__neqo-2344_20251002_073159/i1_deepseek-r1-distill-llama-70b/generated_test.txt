#[test]
fn test_cubic_fast_convergence() {
    let mut cubic = Cubic {
        last_max_cwnd: 100.0,
        estimated_tcp_cwnd: 50.0,
        k: 0.0,
        w_max: 100.0,
        ca_epoch_start: Some(Instant::now() - Duration::from_secs(1)),
        tcp_acked_bytes: 0.0,
    };

    let curr_cwnd = 80;
    let max_datagram_size = 100;

    // Simulate a congestion event where current cwnd is less than last_max_cwnd
    let (new_cwnd, _) = cubic.on_congestion(curr_cwnd, max_datagram_size);

    // After fast convergence, the cwnd should be reduced by CUBIC_FAST_CONVERGENCE
    let expected_cwnd = (curr_cwnd as f64 * CUBIC_FAST_CONVERGENCE) as usize;
    assert_eq!(new_cwnd, expected_cwnd);
}