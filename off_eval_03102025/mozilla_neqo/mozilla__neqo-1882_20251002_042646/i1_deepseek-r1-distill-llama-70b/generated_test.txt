#[test]
fn test_handshake_done_behavior() {
    let mut states = vec![
        StateSignaling::Idle,
        StateSignaling::HandshakeDone,
        StateSignaling::Closing,
    ];

    for mut state in states {
        let original = state;
        state.handshake_done();
        match original {
            StateSignaling::Idle => assert!(matches!(state, StateSignaling::HandshakeDone)),
            _ => assert!(matches!(state, StateSignaling::HandshakeDone | StateSignaling::Closing)),
        }
    }
}