<Filename> glean-core/src/upload/directory.rs </Filename>
<imports> 
use super::PingDirectoryManager;
use crate::{DELETION_REQUEST_PINGS_DIRECTORY, PENDING_PINGS_DIRECTORY};
use std::fs;
use std::path::PathBuf;
use tempo::tests::new_glean;
use std::path::Path;
</imports>
<Rust>
#[test]
fn test_pending_pings_are_processed() {
  let (glean, dir) = new_glean(None);
  let directory_manager = PingDirectoryManager::new(dir.path());
  
  // Submit a ping to populate pending_pings folder
  glean.submit_ping("test", None).unwrap();

  // Submit a deletion request ping to populate deletion request folder.
  glean
      .internal_pings
      .deletion_request
      .submit(&glean, None)
      .unwrap();

  // Try and process the pings folder
  let requests = directory_manager.process_dir();

  // Verify there are two requests
  assert_eq!(requests.len(), 2);
}
</Rust>