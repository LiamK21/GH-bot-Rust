#[test]
fn test_dispatcher_shutdown_prevents_new_tasks() {
  let dispatcher = Dispatcher::new();
  let result = Arc::new(Mutex::new(Vec::new()));
  dispatcher.guard().shutdown().unwrap();
  let _ = dispatcher.guard().launch(move || {
    result.lock().unwrap().push(0);
  });
  dispatcher.join().unwrap();
  assert!(result.lock().unwrap().is_empty());
}