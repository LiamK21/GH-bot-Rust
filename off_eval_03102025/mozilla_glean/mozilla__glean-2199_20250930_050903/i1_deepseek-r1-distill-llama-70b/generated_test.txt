#[test]
fn test_url_within_limit() {
    let (glean, _handle) = Glean::new();
    let metric = UrlMetric::new(
        &glean,
        "store1".into(),
        None,
        MetricType::Url,
        &CommonMetricData::default(),
    );

    // Create a URL well within the 8192 character limit
    let test_url = format!("glean://{}", "a".repeat(4096)); // 4096 + 8 = 4104 characters

    metric.set_sync(&glean, &test_url).unwrap();

    // Verify the value was stored correctly without truncation
    assert_eq!(metric.get_value(&glean, "store1").unwrap(), test_url);

    // Ensure no errors were recorded
    assert_eq!(test_get_num_recorded_errors(&glean, metric.meta(), ErrorType::InvalidOverflow), 0);
}