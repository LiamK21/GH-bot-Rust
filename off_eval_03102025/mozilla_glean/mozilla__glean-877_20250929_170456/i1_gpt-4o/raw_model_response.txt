<Filename>glean-core/ffi/src/upload.rs</Filename>
<imports>
use super::FfiPingUploadTask;
use ffi_support::ByteBuffer;
use std::ffi::CString;
use glean_core::upload::PingUploadTask;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_gzip_ping_upload() {
    let document_id = "test_document_id";
    let path = "/test/path";
    let body = vec![1, 2, 3, 4, 5]; // Simulating gzipped content
    let headers = HashMap::new();

    let request = PingUploadTask::Upload {
        document_id: document_id.to_string(),
        path: path.to_string(),
        body: body.clone(),
        headers: headers.clone(),
    };

    let ffi_task: FfiPingUploadTask = request.into();

    if let FfiPingUploadTask::Upload { body: actual_body, .. } = ffi_task {
        let expected_body = ByteBuffer::from_vec(body);
        assert_eq!(actual_body, expected_body);
    } else {
        panic!("Expected FfiPingUploadTask::Upload variant");
    }
}
</Rust>