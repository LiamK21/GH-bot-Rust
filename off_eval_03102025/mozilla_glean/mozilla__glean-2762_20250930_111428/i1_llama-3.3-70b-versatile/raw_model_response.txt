<Filename> tools/embedded-uniffi-bindgen/src/main.rs </Filename>
<imports> 
use std::env;
use anyhow::{bail, Result};
use uniffi::{generate_bindings, TargetLanguage};
use uniffi_bindgen::BindingGeneratorDefault;
</imports>
<Rust>
#[test]
fn test_main_resolves_error() {
  let out_dir = Utf8PathBuf::from(env::temp_dir());
  let udl_file = Utf8PathBuf::from("test.udl");
  let config = Utf8PathBuf::from("test.toml");
  let target_languages = vec![TargetLanguage::Rust];
  let result_before_patch = std::panic::catch_unwind(|| {
    let _ = super::main();
  });
  assert!(result_before_patch.is_err());
  let generator = BindingGeneratorDefault {
    target_languages: target_languages.clone(),
    try_format_code: false,
  };
  let result_after_patch = generate_bindings(
    &udl_file,
    Some(config.as_str()),
    generator,
    out_dir.as_str(),
    None,
    Some("glean_core"),
  );
  assert!(result_after_patch.is_ok());
}</Rust>