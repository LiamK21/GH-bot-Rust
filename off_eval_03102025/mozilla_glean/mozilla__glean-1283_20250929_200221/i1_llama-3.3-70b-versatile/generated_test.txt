#[test]
fn test_recoverable_upload_failure_logging() {
  let (tx, rx) = mpsc::channel();
  let _ = log::set_max_level(Level::Info);
  let _ = log::set_logger(&mut move |msg: &str| {
    tx.send(msg.to_string()).unwrap();
  });
  let mut manager = PingUploadManager {};
  let status = "RecoverableFailure";
  let document_id = "12345";
  manager.upload_ping(document_id, status);
  let msg = rx.recv().unwrap();
  assert!(msg.contains("Recoverable upload failure while attempting to send ping"));
  assert!(msg.contains("will retry"));
  assert!(msg.contains("Error was RecoverableFailure"));
}