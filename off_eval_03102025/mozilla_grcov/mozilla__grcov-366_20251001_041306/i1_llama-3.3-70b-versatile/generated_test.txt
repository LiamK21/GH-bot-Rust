#[test]
fn test_get_coveralls_git_info() {
  let commit_sha = "b31f08d07ae564b08237e5a336e478b24ccc4a65";
  let vcs_branch = "master";
  let expected = json!({
    "head": {
      "id": commit_sha,
    },
    "branch": vcs_branch,
  });
  let actual = get_coveralls_git_info(commit_sha, vcs_branch);
  let expected_head_id = expected["head"]["id"].as_str().unwrap();
  let actual_head_id = actual["head"]["id"].as_str().unwrap();
  assert_eq!(expected_head_id, actual_head_id);
  let expected_branch = expected["branch"].as_str().unwrap();
  let actual_branch = actual["branch"].as_str().unwrap();
  assert_eq!(expected_branch, actual_branch);
  // check if other fields are present
  assert!(actual["head"].is_object());
  assert!(actual["head"]["id"].is_string());
  assert!(actual["branch"].is_string());
  // if git is not installed, get_coveralls_git_info will return with only id and branch
  let command = Command::new("git");
  if command.arg("status").stdin(std::process::Stdio::null()).stdout(std::process::Stdio::null()).stderr(std::process::Stdio::null()).status().unwrap().success() {
      assert!(actual["head"].as_object().unwrap().len() > 2);
      assert!(actual["remotes"].is_array());
  }
}