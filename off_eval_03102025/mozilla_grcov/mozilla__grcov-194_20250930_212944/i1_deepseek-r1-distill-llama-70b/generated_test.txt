#[test]
fn test_path_rewriting_with_mapping() {
    let result_map = CovResultMap::new();
    let path_mapping = Some(serde_json::json!({
        "path1": "mapped_path1",
        "PATH2": "mapped_path2"
    }));
    let source_dir = None;
    let prefix_dir = None;
    let ignore_not_existing = false;
    let to_ignore_dirs = Vec::new();
    let filter_option = None;

    let mut results = rewrite_paths(
        result_map,
        path_mapping,
        source_dir,
        prefix_dir,
        ignore_not_existing,
        to_ignore_dirs,
        filter_option,
    );

    let expected = "mapped_path1";
    let actual = results.next().unwrap().0.to_str().unwrap();
    assert_eq!(expected, actual);
}