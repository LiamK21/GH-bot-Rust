#[test]
fn test_dump_json_to_stdout() {
    let space = FuncSpace {
        name: Some("test_function"),
        start_line: 1,
        end_line: 10,
        kind: crate::spaces::SpaceKind::Function,
        spaces: vec![],
        metrics: crate::spaces::CodeMetrics::default(),
    };

    let path = PathBuf::from("test.rs");
    let output_format = super::Format::Json;
    let pretty = false;

    let mut buffer = Vec::new();
    let stdout = std::io::stdout();
    let mut handle = stdout.lock();
    let _ = write!(handle, "{}", serde_json::to_string(&space).unwrap());

    dump_formats(&space, &path, &None, output_format, pretty).unwrap();

    let expected_output = serde_json::to_string(&space).unwrap();
    assert_eq!(String::from_utf8(buffer).unwrap(), expected_output);
}