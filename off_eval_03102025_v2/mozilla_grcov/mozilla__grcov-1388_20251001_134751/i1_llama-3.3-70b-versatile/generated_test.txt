#[test]
fn test_known_binary_detection() {
  let elf_bytes = vec![0x7F, b'E', b'L', b'F'];
  let pe_bytes = vec![0x4D, 0x5A];
  let macho_bytes = vec![0xFE, 0xED, 0xFA, 0xCE];
  let coff_bytes = vec![0x14, 0xC0];
  let wasm_bytes = vec![0x00, 0x61, 0x73, 0x6D];
  let bitcode_bytes = vec![0x42, 0x43, 0xC0, 0xDE];

  let test_cases = vec![
    (elf_bytes, true),
    (pe_bytes, true),
    (macho_bytes, true),
    (coff_bytes, true),
    (wasm_bytes, true),
    (bitcode_bytes, true),
    (vec![0x00, 0x00, 0x00, 0x00], false),
  ];

  for (bytes, expected) in test_cases {
    let actual = is_known_binary(&bytes);
    assert_eq!(actual, expected);
  }
}