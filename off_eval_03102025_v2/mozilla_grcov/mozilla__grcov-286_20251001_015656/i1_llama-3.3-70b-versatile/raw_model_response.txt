<Filename> src/output.rs </Filename>
<imports> 
use super::output_covdir;
use std::collections::BTreeMap;
use std::path::PathBuf;
use crate::defs::{CovResult, CovResultIter};
</imports>
<Rust>
#[test]
fn test_output_covdir() {
  let results = vec![
    (PathBuf::from("foo/bar/a.cpp"),
     PathBuf::from("foo/bar/a.cpp"),
     CovResult {
         lines: [(1, 10), (2, 11)].iter().cloned().collect(),
         branches: BTreeMap::new(),
         functions: std::collections::HashMap::new(),
     }),
    (PathBuf::from("foo/bar/b.cpp"),
     PathBuf::from("foo/bar/b.cpp"),
     CovResult {
         lines: [(1, 0), (2, 10), (4, 0)].iter().cloned().collect(),
         branches: BTreeMap::new(),
         functions: std::collections::HashMap::new(),
     }),
  ];
  let results: CovResultIter = Box::new(results.into_iter());
  let output_file = "test_covdir.json";
  output_covdir(results, Some(output_file));
  let expected_path = PathBuf::from("./test/").join("test_covdir.json");
  let expected: serde_json::Value = serde_json::from_str(&std::fs::read_to_string(&expected_path).unwrap()).unwrap();
  let actual: serde_json::Value = serde_json::from_str(&std::fs::read_to_string(output_file).unwrap()).unwrap();
  assert_eq!(expected, actual);
}</Rust>