<Filename>src/lib.rs</Filename>
<imports>
use std::sync::Arc;
use super::producer;
use super::consumer;
use super::WorkQueue;
use tempdir::TempDir;
use std::path::PathBuf;
use std::collections::HashMap;
use std::cell::RefCell;
use std::fs::File;
use std::io::{BufReader, Cursor};
use std::panic;
</imports>
<Rust>
#[test]
fn test_produce_and_consume_jacoco_reports() {
    let queue: Arc<WorkQueue> = Arc::new(MsQueue::new());

    let tmp_dir = TempDir::new("grcov").expect("Failed to create temporary directory");
    let tmp_path = tmp_dir.path().to_owned();

    producer(
        &tmp_path,
        &[
            "test/jacoco1.zip".to_string(),
            "test/jacoco2.zip".to_string(),
        ],
        &queue,
        false,
        false,
    );

    let result_map: SyncCovResultMap = Arc::new(Mutex::new(HashMap::new()));
    let working_dir = PathBuf::from(".");
    let source_dir = None;

    consumer(
        &working_dir,
        &source_dir,
        &result_map,
        &queue,
        false,
        false,
    );

    let result_map = result_map.lock().unwrap();
    assert!(result_map.contains_key("jacoco/basic-jacoco.xml"));
    assert!(result_map.contains_key("inner-classes.xml"));
}
</Rust>