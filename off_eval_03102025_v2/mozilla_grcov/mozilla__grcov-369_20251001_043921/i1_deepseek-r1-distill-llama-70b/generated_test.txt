#[test]
fn test_lcov_parser_duplicate_top_level() {
    let test_content = "TN:top-level
SF:src/parser.rs
FN:1,top-level
FNDA:1,1
FN:17,top-level
FNDA:1,1
FN:176,top-level
FNDA:1,1
FNF:3
FNH:3
DA:1,1
DA:17,1
DA:176,1
LF:3
LH:3
end_of_record
";
    let mut lines = test_content.lines();
    let first_line = lines.next().unwrap();
    let file = File::open(Path::new("test_lcov_parser_duplicate_top_level.info")).unwrap();
    let mut reader = BufReader::new(file);
    let results = parse_lcov(reader, true).unwrap();
    assert_eq!(results.len(), 1);
    let (source_name, result) = &results[0];
    assert_eq!(source_name, "src/parser.rs");
    assert_eq!(result.lines.len(), 3);
    assert_eq!(result.lines[0], (1, 1));
    assert_eq!(result.lines[1], (17, 1));
    assert_eq!(result.lines[2], (176, 1));
    assert!(result.functions.contains_key("top-level"));
    let func = result.functions.get("top-level").unwrap();
    assert_eq!(func.start, 1);
    assert_eq!(func.executed, true);
}