#[test]
fn test_profraw_producer_multiple_files() {
    let tmp_dir = PathBuf::from("test_profraw_producer");
    let mut profraws = FxHashMap::default();

    // Add two test profraw files
    let key1 = "test1".to_string();
    let key2 = "test2".to_string();
    profraws.insert(key1.clone(), vec![&Archive::default()]);
    profraws.insert(key2.clone(), vec![&Archive::default()]);

    let (sender, receiver) = JobSender::channel();

    profraw_producer(&tmp_dir, &profraws, &sender);

    let mut received = 0;
    while let Some(item) = receiver.recv().unwrap() {
        received += 1;
        if let ItemType::Paths(paths) = item.item {
            assert_eq!(paths.len(), 2);
        }
    }

    assert_eq!(received, 1);
}