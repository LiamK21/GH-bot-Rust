#[test]
fn test_frame_reading_when_stream_is_closed_before_sending_data() {
    let (mut conn_c, mut conn_s) = connect();

    // create a stream
    let stream_id = conn_s.stream_create(neqo_transport::StreamType::BiDi).unwrap();
    conn_s.stream_send(stream_id, &[0x00]).unwrap();
    let out = conn_s.process(None, SystemTime::now());
    conn_c.process(out.dgram(), SystemTime::now());

    let mut fr: HFrameReader = HFrameReader::new();
    assert_eq!(Ok(()), conn_c.stream_close_send(stream_id));
    let out = conn_c.process(None, SystemTime::now());
    conn_s.process(out.dgram(), SystemTime::now());
    assert_eq!(Ok(true), fr.receive(&mut conn_s, stream_id));
}