#[test]
fn test_pmtu_calculates_correctly() {
    let mut connection = Connection::new(Role::Client, 1, 1);

    // Test IPv4 path
    let ipv4_path = Path::new(
        Ipv4Addr::new(127, 0, 0, 1).into(),
        Ipv4Addr::new(127, 0, 0, 2).into(),
    );
    connection.paths = Some(ipv4_path);
    assert_eq!(connection.pmtu(), 1252);

    // Test IPv6 path
    let ipv6_path = Path::new(
        Ipv6Addr::new(0, 0, 0, 0, 0, 0, 0, 1).into(),
        Ipv6Addr::new(0, 0, 0, 0, 0, 0, 0, 2).into(),
    );
    connection.paths = Some(ipv6_path);
    assert_eq!(connection.pmtu(), 1232);

    // Test no path
    connection.paths = None;
    assert_eq!(connection.pmtu(), 1280);
}