#[test]
fn test_pmtu_discovery() {
  let mut connection = Connection {
    role: Role::Client,
    state: State::Init,
    paths: Some((Ipv4Addr::new(127, 0, 0, 1), Ipv6Addr::new(0xfe80, 0, 0, 0, 0, 0, 0, 1))),
    connection_ids: std::collections::HashMap::new(),
    send_streams: Default::default(),
    recv_streams: Default::default(),
    flow_mgr: std::rc::Rc::new(std::cell::RefCell::new(Default::default())),
    loss_recovery: Default::default(),
    loss_recovery_state: Default::default(),
  };
  let expected_pmtu = 1252;
  let actual_pmtu = connection.pmtu();
  assert_eq!(expected_pmtu, actual_pmtu);

  let mut connection = Connection {
    role: Role::Client,
    state: State::Init,
    paths: Some((Ipv4Addr::new(127, 0, 0, 1), Ipv6Addr::new(0xfe80, 0, 0, 0, 0, 0, 0, 2))),
    connection_ids: std::collections::HashMap::new(),
    send_streams: Default::default(),
    recv_streams: Default::default(),
    flow_mgr: std::rc::Rc::new(std::cell::RefCell::new(Default::default())),
    loss_recovery: Default::default(),
    loss_recovery_state: Default::default(),
  };
  let expected_pmtu = 1232;
  let actual_pmtu = connection.pmtu();
  assert_eq!(expected_pmtu, actual_pmtu);

  let mut connection = Connection {
    role: Role::Client,
    state: State::Init,
    paths: None,
    connection_ids: std::collections::HashMap::new(),
    send_streams: Default::default(),
    recv_streams: Default::default(),
    flow_mgr: std::rc::Rc::new(std::cell::RefCell::new(Default::default())),
    loss_recovery: Default::default(),
    loss_recovery_state: Default::default(),
  };
  let expected_pmtu = 1280;
  let actual_pmtu = connection.pmtu();
  assert_eq!(expected_pmtu, actual_pmtu);
}