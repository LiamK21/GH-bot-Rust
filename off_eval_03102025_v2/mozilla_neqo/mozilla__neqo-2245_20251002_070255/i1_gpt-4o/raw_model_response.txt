<Filename>neqo-transport/src/recovery/sent.rs</Filename>
<imports>
use super::SentPackets;
use std::collections::BTreeMap;
use std::ops::RangeInclusive;
</imports>
<Rust>
#[test]
fn test_take_ranges_optimization() {
    let mut sent_packets = SentPackets {
        packets: BTreeMap::new(),
    };

    // Simulate packets in flight
    for i in 0..100 {
        sent_packets.packets.insert(i, i);
    }

    // Define the acked range
    let acked_ranges = vec![0..=1];

    // Expected result after taking the acked range
    let expected_acked = vec![1, 0];

    // Call the function under test
    let actual_acked = sent_packets.take_ranges(acked_ranges.into_iter());

    // Check if the actual result matches the expected result
    assert_eq!(actual_acked, expected_acked);

    // Check if the remaining packets are as expected
    assert_eq!(sent_packets.packets.len(), 98);
    assert!(sent_packets.packets.contains_key(&2));
    assert!(sent_packets.packets.contains_key(&99));
}
</Rust>