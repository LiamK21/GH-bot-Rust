<Filename> neqo-transport/src/recovery.rs </Filename>
<imports> 
use neqo_transport::src::recovery::{LossRecovery, SentPacket, PNSpace};
use std::collections::BTreeMap;
use std::time::Duration;
use std::time::Instant;
</imports>
<Rust>
#[test]
fn test_detect_lost_packets() {
  let mut loss_recovery = LossRecovery::default();
  let pn_space = PNSpace::ApplicationData;
  loss_recovery.spaces.insert(pn_space, Default::default());
  let now = Instant::now();
  let packet = SentPacket {
    ack_eliciting: true,
    time_sent: now - Duration::from_millis(100),
    tokens: vec![],
    time_declared_lost: None,
  };
  loss_recovery.spaces.get_mut(&pn_space).unwrap().sent_packets.insert(1, packet);
  let lost_packets = loss_recovery.detect_lost_packets(pn_space, now);
  assert_eq!(lost_packets.len(), 1);
  let mut loss_recovery = LossRecovery::default();
  let pn_space = PNSpace::ApplicationData;
  loss_recovery.spaces.insert(pn_space, Default::default());
  let now = Instant::now();
  let packet = SentPacket {
    ack_eliciting: true,
    time_sent: now - Duration::from_millis(100),
    tokens: vec![],
    time_declared_lost: Some(now - Duration::from_millis(200)),
  };
  loss_recovery.spaces.get_mut(&pn_space).unwrap().sent_packets.insert(1, packet);
  let lost_packets = loss_recovery.detect_lost_packets(pn_space, now);
  assert_eq!(loss_recovery.spaces.get(&pn_space).unwrap().sent_packets.len(), 0);
}</Rust>