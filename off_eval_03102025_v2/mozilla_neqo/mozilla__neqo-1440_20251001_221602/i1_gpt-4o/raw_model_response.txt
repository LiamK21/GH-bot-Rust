<Filename>neqo-transport/src/connection/mod.rs</Filename>
<imports>
use super::Connection;
use super::TransmissionPriority;
use super::Builder;
use super::Tokens;
use super::FrameStats;
</imports>
<Rust>
#[test]
fn test_datagram_priority() {
    let mut connection = Connection::new();
    let mut builder = Builder::new();
    let mut tokens = Tokens::new();
    let mut frame_stats = FrameStats::new();

    // Simulate the condition where the builder is not full
    connection.streams.write_frames(TransmissionPriority::Critical, &mut builder, &mut tokens, &mut frame_stats);
    assert!(!builder.is_full());

    // Check that datagrams are sent after Critical and Important priorities
    connection.streams.write_frames(TransmissionPriority::Important, &mut builder, &mut tokens, &mut frame_stats);
    assert!(!builder.is_full());

    // Now, datagrams should be sent
    connection.datagrams.write_frames(&mut builder, &mut tokens, &mut frame_stats);
    assert!(!builder.is_full());
}
</Rust>