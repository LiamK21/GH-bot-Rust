#[test]
fn test_ack_ranges_affect_cwnd() {
    let mut cc = ClassicCongestionControl::new(NewReno::default());
    let mut now = Instant::now();
    let rtt = Duration::from_millis(100);
    let mut next_pn = 0;

    // Send packets to fill the congestion window
    let mut pkts = Vec::new();
    for _ in 0..10 {
        let p = SentPacket::new(
            PacketType::Short,
            next_pn,
            now,
            true,
            Vec::new(),
            1200,
        );
        next_pn += 1;
        cc.on_packet_sent(&p);
        pkts.push(p);
    }

    // Acknowledge packets in multiple ranges
    now += rtt;
    cc.on_packets_acked(&pkts[0..5], rtt, now);
    cc.on_packets_acked(&pkts[5..10], rtt, now);

    // Check if congestion window increased
    assert!(cc.congestion_window > 12000);
}