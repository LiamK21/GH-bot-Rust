#[test]
fn test_disable_random() {
  let mut agent = SecretAgent::new().unwrap();
  let grease = true;
  let result_with_random = agent.set_option(ssl::Opt::Grease, grease).is_ok();
  let result_without_random = agent.set_option(ssl::Opt::Grease, false).is_ok();
  assert!(result_with_random);
  assert!(result_without_random);
  let result_with_random_disabled = agent.set_option(ssl::Opt::Grease, grease).is_ok();
  cfg_if::cfg_if! {
    if #[cfg(feature = "disable-random")] {
      assert!(!result_with_random_disabled);
    } else {
      assert!(result_with_random_disabled);
    }
  }
}