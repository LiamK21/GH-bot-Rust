<Filename> neqo-crypto/src/agent.rs </Filename>
<imports> 
use neqo_crypto::agent::SecretAgent;
use neqo_crypto::ssl;
use std::convert::TryInto;
</imports>
<Rust>
#[test]
fn test_disable_random() {
  let mut agent = SecretAgent::new().unwrap();
  let grease = true;
  let result_with_random = agent.set_option(ssl::Opt::Grease, grease).is_ok();
  let result_without_random = agent.set_option(ssl::Opt::Grease, false).is_ok();
  assert!(result_with_random);
  assert!(result_without_random);
  let result_with_random_disabled = agent.set_option(ssl::Opt::Grease, grease).is_ok();
  cfg_if::cfg_if! {
    if #[cfg(feature = "disable-random")] {
      assert!(!result_with_random_disabled);
    } else {
      assert!(result_with_random_disabled);
    }
  }
}</Rust>