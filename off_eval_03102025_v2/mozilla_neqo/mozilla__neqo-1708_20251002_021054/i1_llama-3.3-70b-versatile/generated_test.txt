#[test]
fn test_recv_multiple_datagrams() {
  let receiver = Socket::bind("127.0.0.1:0").unwrap();
  let sender = Socket::bind("127.0.0.1:0").unwrap();
  let receiver_addr: SocketAddr = receiver.local_addr().unwrap();
  let msg1 = vec![0xAB; 128];
  let msg2 = vec![0xCD; 128];
  sender.send(&msg1, &receiver_addr).unwrap();
  sender.send(&msg2, &receiver_addr).unwrap();
  let dgrams = receiver.recv(&receiver_addr).unwrap();
  assert_eq!(dgrams.len(), 2);
  assert_eq!(dgrams[0].d, msg1);
  assert_eq!(dgrams[1].d, msg2);
}