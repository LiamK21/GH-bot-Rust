<Filename>glean-core/rlb/src/lib.rs</Filename>
<imports>
use super::destroy_glean;
use super::initialize;
use super::test_reset_glean;
use std::thread;
use std::time::Duration;
</imports>
<Rust>
#[test]
fn test_init_before_destroy() {
  let cfg = super::configuration::Configuration::default();
  let client_info = super::configuration::ClientInfoMetrics::default();

  // Initialize and destroy Glean in quick succession to simulate a crash.
  let handle = thread::spawn(move || {
    initialize(cfg, client_info);
    destroy_glean(true);
  });
  
  // Wait for the thread to finish to ensure test_reset_glean is called after destroy_glean.
  handle.join().unwrap();

  // Attempt to reset Glean after the crash simulation.
  test_reset_glean(cfg, client_info, true);
}
</Rust>