#[test]
fn test_global_dispatcher_limit() {
  let limit = if cfg!(feature = "preinit_million_queue") {
    1000000
  } else {
    1000
  };
  let global_dispatcher = Lazy::new(|| RwLock::new(Some(Dispatcher::new(limit))));
  let dispatcher = global_dispatcher.force_deref().read().unwrap().as_ref().unwrap();
  assert_eq!(dispatcher.limit(), limit);
}