#[test]
fn test_labeled_metric_with_cow_labels() {
    let meta = CommonMetricData {
        name: "test_counter".into(),
        lifetime: Lifetime::Application,
        send_in_pings: vec![],
        ..Default::default()
    };

    let labels: Vec<Cow<'static, str>> = vec![
        Cow::from("label1"),
        Cow::from("label2"),
    ];

    let metric = LabeledMetric::<CounterMetric>::new(meta, Some(labels));

    metric.get("label1").unwrap().add(1);
    metric.get("label2").unwrap().add(2);

    let data = metric.collect().unwrap();
    assert_eq!(data.iter().map(|(k, v)| (k, v.get().unwrap())).collect::<Vec<(&str, i32)>>(), vec![
        ("label1", 1),
        ("label2", 2),
    ]);
}