<Filename>glean-core/src/dispatcher/mod.rs</Filename>
<imports>
use super::Dispatcher;
use super::DispatchError;
use super::Command;
use crossbeam_channel::unbounded;
</imports>
<Rust>
#[test]
fn test_preinit_queue_size_limit() {
    let max_queue_size = 5;
    let dispatcher = Dispatcher::new(max_queue_size);
    let (sender, receiver) = unbounded();

    // Fill the queue to its maximum size
    for _ in 0..max_queue_size {
        dispatcher.send(Command::new(sender.clone())).unwrap();
    }

    // This should exceed the queue size and return a QueueFull error
    let result = dispatcher.send(Command::new(sender));
    assert_eq!(result, Err(DispatchError::QueueFull));
}
</Rust>