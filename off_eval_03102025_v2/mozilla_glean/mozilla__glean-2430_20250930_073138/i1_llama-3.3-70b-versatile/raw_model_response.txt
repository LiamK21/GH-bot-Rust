<Filename> glean-core/src/metrics/memory_distribution.rs </Filename>
<imports>
use glean_core::metrics::memory_distribution::MemoryDistributionMetric;
use glean_core::Glean;
use log::warn;
</imports>
<Rust>
#[test]
fn test_memory_distribution_metric_records_with_storage_opt() {
  let glean = Glean::new();
  let storage = glean.storage();
  let metric = MemoryDistributionMetric::new("test_metric".to_string());
  let sample = 10;
  metric.accumulate(sample);
  let expected = true;
  let actual = glean.storage_opt().is_some();
  assert_eq!(expected, actual);
  let glean = Glean::new();
  glean.data_store = None;
  let metric = MemoryDistributionMetric::new("test_metric".to_string());
  let sample = 10;
  metric.accumulate(sample);
  let expected = false;
  let actual = glean.storage_opt().is_some();
  assert_eq!(expected, actual);
}</Rust>