#[test]
fn test_removed_legacy_headers() {
  let mut builder = Builder::new();
  let request = builder.build();
  let expected_headers = vec!["Date", "X-Telemetry-Agent", "Content-Type", "Content-Length"];
  let actual_headers: Vec<_> = request.headers.keys().cloned().collect();
  let actual_headers_set: HashMap<_, _> = actual_headers.iter().map(|&x| (x, "")).collect();
  for header in expected_headers {
    assert!(actual_headers_set.contains_key(header));
  }
  assert!(!actual_headers_set.contains_key("X-Client-Type"));
  assert!(!actual_headers_set.contains_key("X-Client-Version"));
}