<Filename>glean-core/src/upload/mod.rs</Filename>
<imports>
use super::PingUploadManager;
use super::PingUploadTask;
use super::create_date_header_value;
use chrono::Utc;
</imports>
<Rust>
#[test]
fn test_date_header_set_at_upload_time() {
    let mut manager = PingUploadManager::new();
    let request = manager.get_upload_task().unwrap();
    
    if let PingUploadTask::Upload { request } = request {
        let expected_date = create_date_header_value(Utc::now());
        let actual_date = request.headers.get("Date").unwrap();
        assert_eq!(expected_date, *actual_date);
    } else {
        panic!("Expected an upload task");
    }
}
</Rust>