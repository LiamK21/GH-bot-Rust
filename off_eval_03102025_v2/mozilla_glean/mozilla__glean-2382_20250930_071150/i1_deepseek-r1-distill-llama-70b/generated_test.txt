#[test]
fn test_missing_send_ids_incremented() {
    initialize();
    let logger = Logger::new();
    let upload_manager = PingUploadManager::new(Arc::new(UploadMetrics::new()));

    // Simulate the scenario where send_ids is None
    let document_id = "test-doc-id".into();
    let status = HttpStatus { code: 200 };

    upload_manager.process(
        document_id,
        None,
        status,
        std::time::Duration::from_secs(0),
        &logger,
    );

    // Verify the missing_send_ids counter was incremented
    assert_eq!(
        upload_manager.upload_metrics.missing_send_ids.get_sync(&glean),
        1
    );
}