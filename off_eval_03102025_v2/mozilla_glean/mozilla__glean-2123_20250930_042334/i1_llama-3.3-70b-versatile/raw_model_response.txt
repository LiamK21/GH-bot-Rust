<Filename> glean-core/src/database/mod.rs </Filename>
<imports> 
use super::rkv_new;
use std::path::Path;
use tempfile::TempDir;
use std::fs;
</imports>
<Rust>
#[test]
fn test_rkv_new_with_safe_mode() {
  let temp_dir = TempDir::new().unwrap();
  let path = temp_dir.path().join("db");
  fs::create_dir_all(&path).expect("create database dir");
  let safebin = path.join("data.safe.bin");
  let mut file = fs::File::create(safebin).expect("create database file");
  file.write_all(b"corrupted data").expect("write to file");
  drop(file);

  let result = rkv_new(&path);
  assert!(result.is_ok());
}
</Rust>