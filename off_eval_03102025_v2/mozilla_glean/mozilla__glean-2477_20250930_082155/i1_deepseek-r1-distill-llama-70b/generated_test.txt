#[test]
fn test_glean_shutdown() {
    let (sender, receiver) = mpsc::channel();

    let mut cfg = InternalConfiguration::default();
    cfg.submit = Box::new(move |s| {
        sender.send(s).unwrap();
    });

    let client_info = ClientInfoMetrics::default();
    let callbacks = Box::new(|_| {});

    glean_initialize(cfg, client_info, callbacks);

    // Verify that Glean is working before shutdown
    let ping = collect("test_ping", None).unwrap();
    assert!(ping.len() > 0);

    glean_shutdown();

    // Verify that Glean is shutdown by trying to collect pings
    let result = collect("test_ping", None);
    assert!(result.is_err());
}