<Filename> src/main.rs </Filename>
<imports> 
use std::process;
use std::thread;
use super::main;
</imports>
<Rust>
#[test]
fn test_thread_failure_return_code() {
  let original_hook = std::panic::take_hook();
  std::panic::set_hook(Box::new(|_| {}));
  let handle = thread::spawn(move || {
    main();
    process::exit(1);
  });
  handle.join().unwrap();
  let status = handle.thread().unwrap().join().unwrap();
  assert_ne!(status.code(), Some(0));
  std::panic::set_hook(original_hook);
}</Rust>