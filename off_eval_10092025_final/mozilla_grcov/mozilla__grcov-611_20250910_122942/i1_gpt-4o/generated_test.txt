#[test]
fn test_execution_count_overflow_warning() {
    struct TestLogger {
        messages: Mutex<Vec<String>>,
    }

    impl log::Log for TestLogger {
        fn enabled(&self, _: &Metadata) -> bool {
            true
        }

        fn log(&self, record: &Record) {
            if record.level() == Level::Warn {
                self.messages.lock().unwrap().push(format!("{}", record.args()));
            }
        }

        fn flush(&self) {}
    }

    let test_logger = TestLogger {
        messages: Mutex::new(Vec::new()),
    };

    set_logger(Box::leak(Box::new(test_logger))).unwrap();
    set_max_level(Level::Warn.to_level_filter());

    let mut results = Vec::new();
    let warn_overflow = true;

    add_results(&mut results, warn_overflow);

    let messages = test_logger.messages.lock().unwrap();
    assert!(messages.contains(&"Execution count overflow detected.".to_string()));
}