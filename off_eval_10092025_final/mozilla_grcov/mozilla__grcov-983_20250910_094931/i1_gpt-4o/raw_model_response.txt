<Filename> src/main.rs </Filename>
<imports>
use super::main;
use std::path::Path;
use std::fs;
</imports>
<Rust>
#[test]
fn test_output_path_is_directory() {
    let temp_dir = tempfile::tempdir().unwrap();
    let output_path = temp_dir.path().join("output");
    fs::create_dir(&output_path).unwrap();

    let opt = Opt {
        output_path: Some(output_path.to_str().unwrap().to_string()),
        output_types: vec!["type1".to_string(), "type2".to_string()],
    };

    let expected = Some(output_path.as_path());
    let actual = match opt.output_types.len() {
        0 => None,
        1 => opt.output_path.as_deref(),
        _ => match opt.output_path.as_deref() {
            Some(output_path) => {
                if Path::new(output_path).is_dir() {
                    Some(Path::new(output_path))
                } else {
                    panic!("output_path must be a directory when using multiple outputs");
                }
            }
            _ => None,
        },
    };

    assert_eq!(expected, actual);
}
</Rust>