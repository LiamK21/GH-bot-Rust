#[test]
fn test_skip_symlinks_in_path_rewriting() -> Result<(), io::Error> {
    let temp_dir = tempfile::tempdir()?;
    let source_dir = temp_dir.path().join("test_dir");
    fs::create_dir_all(&source_dir)?;

    // Create a file
    let file_path = source_dir.join("Variant_inl.h");
    fs::touch(&file_path)?;

    // Create a symlink to the file
    let symlink_path = source_dir.join("symlink_Variant_inl.h");
    symlink(file_path.to_str().unwrap(), symlink_path.to_str().unwrap())?;

    let result_map = Default::default();
    let path_mapping = None;
    let prefix_dir = None;
    let ignore_not_existing = false;
    let to_ignore_dirs = vec![];
    let filter_option = None;

    // The test passes if no panic occurs when processing symlinks
    rewrite_paths(
        result_map,
        path_mapping,
        Some(source_dir),
        prefix_dir,
        ignore_not_existing,
        to_ignore_dirs,
        filter_option,
    )?;

    Ok(())
}