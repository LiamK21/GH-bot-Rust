#[test]
fn test_non_utf8_version_handling() {
    let mut reader = GcovReaderBuf::new();
    // Setup buffer with invalid UTF8 version string
    let buffer = [
        0x67, 0x63, 0x6f, 0x76, // "gcov"
        0x32, 0x30, 0x62, 0x30, // "200b"
        0x00, 0x00, 0x00, 0x00, // padding
        0x61, 0xdc, 0x0b, 0xff, // "adcg" followed by invalid UTF8
    ];
    reader.buffer = buffer.to_vec();

    let result = reader.read_record();
    match result {
        Err(GcovError::Str(_)) => (),
        _ => panic!("Expected Str error, got different error"),
    }
}