<Filename> glean-core/src/database/mod.rs </Filename>
<imports> 
use super::Database;
use std::collections::BTreeMap;
use std::fs::File;
use std::io::Write;
use std::path::Path;
use tempdir::TempDir;
use std::sync::RwLock;
</imports>
<Rust>
#[test]
fn test_persist_ping_lifetime_data() {
  let temp_dir = TempDir::new("glean_test").unwrap();
  let data_path = temp_dir.path().to_str().unwrap();
  let db = Database::new(data_path, true).unwrap();
  let mut ping_lifetime_data = BTreeMap::new();
  ping_lifetime_data.insert("metric1".to_string(), "value1".to_string());
  let mut ping_data = RwLock::new(ping_lifetime_data);
  db.ping_lifetime_data = Some(ping_data);
  db.persist_ping_lifetime_data().unwrap();
  let store: super::SingleStore = db.rkv.open_single(super::Lifetime::Ping.as_str(), super::StoreOptions::create()).unwrap();
  let reader = db.rkv.read().unwrap();
  assert!(store.get(&reader, "metric1").unwrap_or(None).is_some());
}</Rust>