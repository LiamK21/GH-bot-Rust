<Filename> glean-core/src/metrics/url.rs </Filename>
<imports> 
use super::UrlMetric;
use super::Glean;
use crate::metrics::MetricType;
use crate::error_recording::{test_get_num_recorded_errors, ErrorType};
</imports>
<Rust>
#[test]
fn test_url_metric_truncation() {
  let glean = Glean::new();
  let metric = UrlMetric::new("test_url_metric", "store1", None);
  let long_path_base = "abcdefgh";
  let test_url = format!("glean://{}", long_path_base.repeat(2000));
  let expected = format!("glean://{}", long_path_base.repeat(1023));

  metric.set_sync(&glean, &test_url);
  let actual = metric.get_value(&glean, "store1").unwrap();
  assert_eq!(actual, expected);
  assert_eq!(0, test_get_num_recorded_errors(&glean, metric.meta(), ErrorType::InvalidOverflow));
}
</Rust>