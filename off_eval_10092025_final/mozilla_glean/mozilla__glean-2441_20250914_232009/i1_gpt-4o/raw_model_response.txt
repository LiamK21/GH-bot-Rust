<Filename>glean-core/src/metrics/event.rs</Filename>
<imports>
use super::EventMetric;
use std::collections::HashMap;
use crate::Glean;
</imports>
<Rust>
#[test]
fn test_event_max_events_overflow_triggers_upload() {
    let glean = Glean::new();
    let event_metric = EventMetric::new();
    let timestamp = 123456789;
    let extra = HashMap::new();

    // Simulate reaching max_events limit
    for _ in 0..glean.max_events() {
        event_metric.record_with_time(timestamp, extra.clone());
    }

    // The next event should trigger an upload
    let expected = true;
    let actual = event_metric.record_sync(&glean, timestamp, extra);

    assert_eq!(expected, actual);
}
</Rust>