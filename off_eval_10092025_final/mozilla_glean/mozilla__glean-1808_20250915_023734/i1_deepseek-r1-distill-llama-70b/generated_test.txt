#[test]
fn test_logging_filters_only_glean_modules() {
    let (sender, receiver) = mpsc::channel();
    let filter = FilterBuilder::new()
        .filter_module("glean_ffi", LevelFilter::Debug)
        .filter_module("glean_core", LevelFilter::Debug)
        .filter_module("glean", LevelFilter::Debug)
        .build();
    android_logger::init_once(
        android_logger::Config::default()
            .with_min_level(LevelFilter::Debug)
            .with_filter(filter)
            .with_tag("libglean_ffi"),
    );

    // Test logging from different modules
    debug!("glean_ffi: This should be logged");
    debug!("other_module: This should NOT be logged");
    debug!("webrender: This should NOT be logged");

    // Capture logs
    let handle = thread::spawn(move || {
        let logger = Logger::new(sender);
        logger.init().unwrap();
    });

    // Ensure thread completes
    handle.join().unwrap();

    // Collect all logs
    let mut logs = Vec::new();
    receiver.iter().for_each(|log| {
        logs.push(log);
    });

    // Verify only Glean module logs are present
    let mut expected_logs = Vec::new();
    for log in logs {
        if log.module_path == Some("glean_ffi") {
            expected_logs.push(log);
        }
    }

    assert_eq!(logs.len(), expected_logs.len());
}