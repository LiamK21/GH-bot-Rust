<Filename> glean-core/ffi/src/lib.rs </Filename>
<imports> 
use super::glean_enable_logging;
use log::LevelFilter;
use android_logger::FilterBuilder;
use std::sync::atomic::{AtomicBool, Ordering};
use std::sync::Arc;
</imports>
<Rust>
#[test]
fn test_glean_enable_logging_filters_modules() {
  let glean_logged = Arc::new(AtomicBool::new(false));
  let neqo_logged = Arc::new(AtomicBool::new(false));
  let webrender_logged = Arc::new(AtomicBool::new(false));
  
  let glean_handle = glean_logged.clone();
  let neqo_handle = neqo_logged.clone();
  let webrender_handle = webrender_logged.clone();
  
  std::panic::catch_unwind(|| {
    let _filter = android_logger::FilterBuilder::new()
      .filter_module("glean_ffi", LevelFilter::Debug)
      .filter_module("glean_core", LevelFilter::Debug)
      .filter_module("glean", LevelFilter::Debug)
      .filter_module("neqo", LevelFilter::Off)
      .filter_module("webrender", LevelFilter::Off)
      .build();
    android_logger::init_once(
      android_logger::Config::default()
        .with_min_level(LevelFilter::Debug)
        .with_filter(_filter)
        .with_tag("libglean_ffi"),
    );
  });
  
  log::set_max_level(LevelFilter::Debug);
  log::debug!("Test log from glean");
  
  std::panic::catch_unwind(|| {
    log::set_module_level("neqo", LevelFilter::Debug);
    log::debug!("Test log from neqo");
  });
  
  std::panic::catch_unwind(|| {
    log::set_module_level("webrender", LevelFilter::Debug);
    log::debug!("Test log from webrender");
  });
  
  assert!(glean_logged.load(Ordering::SeqCst));
  assert!(!neqo_logged.load(Ordering::SeqCst));
  assert!(!webrender_logged.load(Ordering::SeqCst));
  
  glean_enable_logging();
}
</Rust>