#[test]
fn test_registering_pings_before_init() {
    static INIT: Once = Once::new();
    INIT.call_once(|| {
        // Ensure Glean is uninitialized
        crate::destroy_glean(true);
    });

    // Create a custom ping and attempt its registration before initialization
    let sample_ping = PingType::new("pre-register", true, true, vec![]);
    register_ping_type(&sample_ping);

    // Initialize Glean
    let cfg = Configuration {
        data_path: "/tmp".into(),
        application_id: GLOBAL_APPLICATION_ID.into(),
        upload_enabled: true,
        max_events: None,
        delay_ping_lifetime_io: false,
        channel: Some("testing".into()),
        server_endpoint: Some("http://localhost".into()),
        uploader: None,
    };
    let client_info = ClientInfoMetrics::default();
    initialize(cfg, client_info);

    // Check if the ping is registered by submitting it
    let result = std::panic::catch_unwind(|| {
        sample_ping.submit(None);
    });

    assert!(result.is_ok(), "Ping registration before init should work");
}