#[test]
fn test_lock_order_inversion() {
    let timing_distribution = RwLock::new(TimingDistributionMetric::new());
    let ping_name = Some("test_ping");

    let result = with_glean(|glean| {
        let inner = timing_distribution.read().unwrap();
        let queried_ping_name = ping_name.unwrap_or_else(|| &inner.meta().send_in_pings[0]);
        inner.test_get_value(glean, queried_ping_name)
    });

    assert!(result.is_some());
}