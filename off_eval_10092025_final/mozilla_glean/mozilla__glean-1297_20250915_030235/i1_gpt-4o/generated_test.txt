#[test]
fn test_tasks_after_shutdown_are_not_processed() {
    let dispatcher = dispatcher::new();
    let result = Arc::new(Mutex::new(Vec::new()));

    dispatcher.guard().shutdown().unwrap();

    {
        let result = Arc::clone(&result);
        let _ = dispatcher.guard().launch(move || {
            result.lock().unwrap().push(0);
        });
    }

    dispatcher.join().unwrap();

    let actual = result.lock().unwrap().len();
    let expected = 0;
    assert_eq!(actual, expected, "Task was processed after shutdown");
}