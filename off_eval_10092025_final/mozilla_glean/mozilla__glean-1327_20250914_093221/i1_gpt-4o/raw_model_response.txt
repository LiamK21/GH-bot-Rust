<Filename>glean-core/rlb/src/test.rs</Filename>
<imports>
use super::destroy_glean;
use crate::common_test::lock_test;
use crate::common_test::new_glean;
use crate::private::LabeledMetric;
use crate::private::CounterMetric;
use crate::CommonMetricData;
</imports>
<Rust>
#[test]
fn test_labeled_metric_initialization() {
    let _lock = lock_test();

    // Destroy any existing Glean instance to start fresh.
    destroy_glean(true);

    // Initialize a new labeled metric before Glean is initialized.
    let metric: LabeledMetric<CounterMetric> = LabeledMetric::new(
        CommonMetricData {
            name: "labeled_counter".into(),
            category: "labeled".into(),
            send_in_pings: vec!["test1".into()],
            ..Default::default()
        },
        None,
    );

    // Record some data in the labeled metric.
    metric.get("label1").add(1);

    // Initialize Glean.
    let _t = new_glean(None, false);

    // Verify that the data recorded before Glean initialization is correctly recorded.
    assert_eq!(1, metric.get("label1").test_get_value("test1").unwrap());
}
</Rust>