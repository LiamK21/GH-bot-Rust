<Filename> glean-core/src/dispatcher/mod.rs </Filename>
<imports>
use super::Dispatcher;
use super::DispatchError;
use super::Command;
</imports>
<Rust>
#[test]
fn test_preinit_queue_size_limit() {
    let max_queue_size = 5;
    let dispatcher = Dispatcher::new(max_queue_size);

    // Simulate sending commands to the preinit queue
    for _ in 0..max_queue_size {
        assert!(dispatcher.guard.send(Command::new()).is_ok());
    }

    // The next command should cause an overflow
    let result = dispatcher.guard.send(Command::new());
    assert_eq!(result, Err(DispatchError::QueueFull));
}
</Rust>