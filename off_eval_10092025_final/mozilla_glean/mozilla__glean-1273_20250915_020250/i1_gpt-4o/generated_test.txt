#[test]
fn test_boolean_metric_set_dispatch() {
    let metric_data = CommonMetricData {
        name: "test_metric".into(),
        category: "test_category".into(),
        send_in_pings: vec!["test_ping".into()],
        lifetime: glean_core::Lifetime::Ping,
        disabled: false,
        ..Default::default()
    };
    let boolean_metric = BooleanMetric::new(metric_data);

    boolean_metric.set(true);

    dispatcher::block_on_queue();

    let value = with_glean(|glean| {
        boolean_metric.0.test_get_value(glean, "test_ping")
    });

    assert_eq!(value, Some(true));
}