#[test]
fn test_env_logger_initialization() {
    // Test with feature flag enabled
    env::set_var("CARGO_FEATURE_ENABLE_ENV_LOGGER", "1");
    let (sender, receiver) = mpsc::channel();
    ctrlc::set_handler(move || {
        sender.send(()).unwrap();
    })
    .unwrap();

    let handle = std::thread::spawn(move || {
        glean_enable_logging();
        let _ = env_logger::try_init().unwrap();
    });

    // Test with feature flag disabled
    env::set_var("CARGO_FEATURE_ENABLE_ENV_LOGGER", "0");
    let (sender, receiver) = mpsc::channel();
    ctrlc::set_handler(move || {
        sender.send(()).unwrap();
    })
    .unwrap();

    let handle = std::thread::spawn(move || {
        glean_enable_logging();
        let _ = env_logger::try_init().unwrap();
    });

    // Check if logging is initialized as expected
    let log_level = env::var("RUST_LOG").unwrap_or_default();
    if log_level == "debug" {
        // Logging should be enabled
        let message = "stdout logging should be hooked up!";
        let actual = log::log!(Level::Trace, message);
        assert!(actual.is_some());
    } else {
        // Logging should not be enabled
        let message = "stdout logging should be hooked up!";
        let actual = log::log!(Level::Trace, message);
        assert!(actual.is_none());
    }
}