#[test]
fn test_global_dispatcher_limit() {
    // Set the testing mode to true to allow dispatcher initialization
    TESTING_MODE.store(true, Ordering::SeqCst);

    // Initialize the dispatcher with the current global limit
    let dispatcher_lock = GLOBAL_DISPATCHER.read().unwrap();
    let dispatcher = dispatcher_lock.as_ref().unwrap();

    // Check if the dispatcher limit is set to 1,000,000 when the feature is enabled
    #[cfg(feature = "preinit_million_queue")]
    assert_eq!(dispatcher.limit(), 1_000_000);

    // Check if the dispatcher limit is set to 1,000 when the feature is not enabled
    #[cfg(not(feature = "preinit_million_queue"))]
    assert_eq!(dispatcher.limit(), 1_000);
}