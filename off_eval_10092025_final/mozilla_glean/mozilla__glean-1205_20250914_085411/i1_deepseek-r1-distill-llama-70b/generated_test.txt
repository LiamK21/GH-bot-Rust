#[test]
fn test_non_deletion_pings_not_uploaded_when_upload_disabled() {
    let data_path = PathBuf::from(tempdir::TempDir::new("glean-test").unwrap().path());
    let mut glean = Glean::new(Configuration {
        upload_enabled: false,
        data_path: data_path.clone(),
        application_id: "test-app".to_string(),
        ..Default::default()
    }).unwrap();

    // Submit a deletion ping
    let ping_id = "test-ping";
    glean.submit_deletion_ping(ping_id).unwrap();

    // Check that the upload manager has no pending pings
    let upload_manager = &glean.upload_manager;
    assert_eq!(upload_manager.queue.read().unwrap().len(), 0);
}