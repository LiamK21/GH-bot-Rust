#[test]
fn test_new_parser_enforces_type() {
    let shell = Shell::new().unwrap();
    let mut builder = Builder::new(&shell);
    // Attempt to create a metric without the 'type' field.
    let metric = r#"
        metric common {
            name: "test_metric"
            // type is omitted to test enforcement
        }"#;
    let result = builder.parse_metric(metric).unwrap();
    // With the new parser, this should fail because 'type' is required.
    assert!(result.is_err());
}