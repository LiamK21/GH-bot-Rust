#[test]
fn test_enqueue_and_get_next_ping() {
    let data_dir = tempfile::tempdir().unwrap();
    let tmpname = data_dir.path().display().to_string();
    let upload_manager = PingUploadManager::new(&tmpname);

    let uuid = "c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0";
    let url = "http://example.com";
    let body = json!({});

    upload_manager.enqueue_ping(uuid, url, body.clone());

    let request = upload_manager.get_next_ping();
    assert!(request.is_some());
    let request = request.unwrap();
    assert_eq!(request.uuid, uuid);
    assert_eq!(request.url, url);
    assert_eq!(request.body, body);
}