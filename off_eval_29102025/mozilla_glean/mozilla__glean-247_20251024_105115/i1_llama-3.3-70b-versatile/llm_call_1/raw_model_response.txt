<Filename> glean-core/src/metrics/experiment.rs </Filename>
<imports> 
use crate::metrics::ExperimentMetric;
use crate::storage::Storage;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_experiments_extra_limits() {
  let mut extra = HashMap::new();
  let too_long_key = "0123456789".repeat(5);
  let too_long_value = "0123456789".repeat(6);
  for n in 0..21 {
    extra.insert(format!("{}-{}", n, too_long_key), too_long_value.clone());
  }
  let experiment_id = "test-experiment_id".to_string();
  let branch_id = "test-branch-id".to_string();
  let experiment = ExperimentMetric::new(experiment_id, branch_id, Some(extra));
  let truncated_extras = experiment.extra.unwrap();
  assert!(truncated_extras.len() <= 20);
  for (key, value) in truncated_extras.iter() {
    assert!(key.len() <= 30);
    assert!(value.len() <= 50);
  }
}
</Rust>