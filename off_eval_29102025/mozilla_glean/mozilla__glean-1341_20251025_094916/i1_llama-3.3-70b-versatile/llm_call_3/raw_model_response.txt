<Filename>glean-core/rlb/src/test.rs</Filename>
<imports>
use super::set_debug_view_tag;
use super::submit_ping_by_name;
use super::initialize;
use super::Configuration;
use super::ClientInfoMetrics;
use std::sync::atomic::AtomicBool;
use std::sync::atomic::Ordering;
use std::sync::OnceCell;
use std::sync::Mutex;
use std::vec::Vec;
use std::thread;
use std::time::Duration;
use std::cell::OnceCell as CellOnceCell;
</imports>
<Rust>
#[test]
fn test_set_debug_view_tag_before_initialization() {
  let initialize_called = AtomicBool::new(false);
  let pre_init_debug_view_tag = CellOnceCell::new();
  let pre_init_log_pings = AtomicBool::new(false);
  let pre_init_source_tags = CellOnceCell::new();
  let cfg = Configuration {
    data_path: "/tmp".to_string(),
    application_id: "test".to_string(),
    upload_enabled: true,
    max_events: None,
    delay_ping_lifetime_io: false,
    channel: Some("testing".to_string()),
    server_endpoint: Some("invalid-test-host".to_string()),
    uploader: None,
  };
  let client_info = ClientInfoMetrics {
    app_display_version: "1.0".to_string(),
    app_build: "123".to_string(),
  };
  assert_eq!(set_debug_view_tag("test-tag"), true);
  initialize(cfg, client_info);
  assert_eq!(set_debug_view_tag("test-tag"), true);
  thread::sleep(Duration::from_millis(100));
  submit_ping_by_name("baseline", Some("background"));
}
</Rust>