<Filename>glean-core/src/metrics/url.rs</Filename>
<imports>
use crate::Glean;
use crate::metrics::UrlMetric;
use crate::error::Error;
use crate::InternalConfiguration;
use std::default::Default;
use crate::util::truncate_string_at_boundary_with_error;
use crate::metrics::MetricType;
use crate::storage::StorageManager;
use crate::CommonMetricData;
use crate::error_recording::{record_error, test_get_num_recorded_errors, ErrorTy};
use crate::metrics::Metric;
</imports>
<Rust>
#[test]
fn test_url_truncation() {
  let config = InternalConfiguration { ..Default::default() };
  let glean = Glean::new(config).unwrap();
  let metric = UrlMetric::new(Default::default());
  let long_path_base = "abcdefgh";
  let test_url = format!("glean://{}", long_path_base.repeat(2000));
  let expected = format!("glean://{}", long_path_base.repeat(1023));
  metric.set_sync(&glean, &test_url);
  let actual = metric.get_value(&glean, "store1").unwrap();
  assert_eq!(actual, expected);
}
</Rust>