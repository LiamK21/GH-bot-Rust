#[test]
fn test_url_truncation() {
  let config = InternalConfiguration { ..Default::default() };
  let glean = Glean::new(config).unwrap();
  let metric = UrlMetric::new(Default::default());
  let long_path_base = "abcdefgh";
  let test_url = format!("glean://{}", long_path_base.repeat(2000));
  let expected = format!("glean://{}", long_path_base.repeat(1023));
  metric.set_sync(&glean, &test_url);
  let actual = metric.get_value(&glean, "store1").unwrap();
  assert_eq!(actual, expected);
}