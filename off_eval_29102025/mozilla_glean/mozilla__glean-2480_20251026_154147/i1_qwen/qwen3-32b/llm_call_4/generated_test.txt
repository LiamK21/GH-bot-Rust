#[test]
fn test_merge_two_configurations() {
    let (glean, _t) = new_glean(None);

    let metric1 = StringMetric::new(CommonMetricData {
        category: "category1".to_string(),
        name: "metric1".to_string(),
        send_in_pings: vec!["baseline".to_string()],
        ..Default::default()
    });

    let metric2 = StringMetric::new(CommonMetricData {
        category: "category2".to_string(),
        name: "metric2".to_string(),
        send_in_pings: vec!["baseline".to_string()],
        ..Default::default()
    });

    let config1 = MetricsEnabledConfig::try_from(json!({"category1.metric1": true}).to_string()).unwrap();
    glean.set_metrics_enabled_config(config1);

    let config2 = MetricsEnabledConfig::try_from(json!({"category2.metric2": true}).to_string()).unwrap();
    glean.set_metrics_enabled_config(config2);

    metric1.set_sync(&glean, "VALUE1");
    metric2.set_sync(&glean, "VALUE2");

    assert_eq!(Some("VALUE1"), metric1.get_value(&glean, "baseline").as_deref());
    assert_eq!(Some("VALUE2"), metric2.get_value(&glean, "baseline").as_deref());
}