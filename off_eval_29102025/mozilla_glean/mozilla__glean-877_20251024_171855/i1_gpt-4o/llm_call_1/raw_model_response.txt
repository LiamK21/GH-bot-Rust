<Filename>glean-core/ffi/src/upload.rs</Filename>
<imports>
use super::FfiPingUploadTask;
use ffi_support::ByteBuffer;
use std::ffi::CString;
use std::os::raw::c_char;
</imports>
<Rust>
#[test]
fn test_gzip_ping_upload() {
    let document_id = CString::new("test_document_id").unwrap();
    let path = CString::new("/test/path").unwrap();
    let body_data = vec![1, 2, 3, 4, 5]; // Example gzipped data
    let headers = CString::new("{\"Content-Encoding\": \"gzip\"}").unwrap();

    let task = FfiPingUploadTask::Upload {
        document_id: document_id.into_raw(),
        path: path.into_raw(),
        body: ByteBuffer::from_vec(body_data.clone()),
        headers: headers.into_raw(),
    };

    if let FfiPingUploadTask::Upload { body, .. } = task {
        let actual_body = unsafe { Vec::from_raw_parts(body.data, body.len, body.capacity) };
        assert_eq!(actual_body, body_data);
    } else {
        panic!("Expected FfiPingUploadTask::Upload variant");
    }
}
</Rust>