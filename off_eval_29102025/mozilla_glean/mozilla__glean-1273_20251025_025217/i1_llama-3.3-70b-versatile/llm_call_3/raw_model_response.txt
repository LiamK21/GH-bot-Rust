<Filename>glean-core/rlb/src/dispatcher/global.rs</Filename>
<imports>
use super::launch;
use super::block_on_queue;
use std::sync::{Arc, Mutex};
use std::thread;
use std::time::Duration;
</imports>
<Rust>
#[test]
fn test_launch_off_main_thread() {
  let main_thread_id = thread::current().id();
  let thread_canary = Arc::new(Mutex::new(false));

  let canary_clone = Arc::clone(&thread_canary);
  launch(move || {
    assert!(thread::current().id() != main_thread_id);
    *canary_clone.lock().unwrap() = true;
  });

  block_on_queue();
  assert!(*thread_canary.lock().unwrap());
}
</Rust>