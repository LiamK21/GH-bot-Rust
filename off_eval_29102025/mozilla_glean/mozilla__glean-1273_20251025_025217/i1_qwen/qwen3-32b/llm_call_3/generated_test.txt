#[test]
fn test_dispatcher_runs_tasks_off_main_thread() {
    let main_thread_id = thread::current().id();
    let captured_thread = Arc::new(Mutex::new(None));
    let captured_clone = Arc::clone(&captured_thread);

    dispatcher::launch(move || {
        *captured_clone.lock().unwrap() = Some(thread::current().id());
    });

    dispatcher::block_on_queue();

    let captured_id = captured_thread.lock().unwrap().unwrap();
    assert_ne!(captured_id, main_thread_id);
}