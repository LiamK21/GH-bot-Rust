#[test]
fn test_zero_sample_clamping() {
    let dir = tempfile::tempdir().unwrap();
    let (glean, _) = new_glean(Some(dir));
    let mut dist = TimingDistributionMetric::new(
        CommonMetricData {
            name: "zero_clamp_test".into(),
            category: "test".into(),
            send_in_pings: vec!["baseline".into()],
            ..Default::default()
        },
        TimeUnit::Nanosecond,
    );
    dist.accumulate_samples_signed(&glean, vec![0_i64]);
    let hist = dist.test_get_value(&glean, "baseline").unwrap();
    let keys: HashSet<u64> = HashSet::from_iter(hist.values().keys().cloned());
    assert!(!keys.contains(&0), "Zero should be clamped to 1");
    assert!(keys.contains(&1), "Zero sample must be stored as 1 nanosecond");
}