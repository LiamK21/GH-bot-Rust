<Filename>glean-core/ffi/src/lib.rs</Filename>
<imports>
use glean_core::Glean;
use glean_core::Configuration;
use std::sync::Mutex;
use std::ffi::CString;
use std::os::raw::c_char;
use glean_core::Error;
use glean_core::ffi::FfiConfiguration;
use super::glean_initialize;
use super::glean_destroy_glean;
use super::glean_is_first_run;
use super::glean_clear_application_lifetime_metrics;
use super::glean_test_clear_all_stores;
use super::glean_set_upload_enabled;
use super::glean_is_upload_enabled;
use super::glean_on_ready_to_submit_pings;
use super::glean_submit_pings_by_name;
use super::glean_ping_collect;
use super::glean_set_experiment_active;
use super::glean_set_experiment_inactive;
use super::glean_experiment_test_is_active;
use super::glean_experiment_test_get_data;
use super::glean_new_ping_type;
use super::glean_register_ping_type;
use super::glean_test_has_ping_type;
use super::glean_boolean_set;
use super::glean_boolean_test_has_value;
use super::glean_custom_distribution_accumulate_samples;
use super::glean_custom_distribution_test_has_value;
use super::glean_datetime_set;
use super::glean_datetime_test_has_value;
use super::glean_event_record;
use super::glean_event_test_has_value;
use super::glean_memory_distribution_accumulate_samples;
use super::glean_memory_distribution_test_has_value;
use super::glean_new_event_metric;
</imports>
<Rust>
#[test]
fn test_glean_initialize_and_destroy() {
  let cfg = FfiConfiguration {
    debug_logger: None,
    data_path: CString::new("/tmp/data").unwrap().into_raw(),
    max_pings: 10,
  };
  let result = unsafe { glean_initialize(&cfg as *const _ as *const FfiConfiguration) };
  assert_eq!(result, 0);
  let is_first_run = glean_is_first_run();
  assert_eq!(is_first_run, 1);
  glean_clear_application_lifetime_metrics();
  glean_test_clear_all_stores();
  glean_set_upload_enabled(1);
  assert_eq!(glean_is_upload_enabled(), 1);
  glean_on_ready_to_submit_pings();
  glean_submit_pings_by_name(
    std::ptr::null_mut(),
    0,
  );
  glean_ping_collect(0);
  glean_set_experiment_active(
    CString::new("experiment").unwrap().into_raw(),
    CString::new("branch").unwrap().into_raw(),
    std::ptr::null_mut(),
    std::ptr::null_mut(),
    0,
  );
  glean_set_experiment_inactive(
    CString::new("experiment").unwrap().into_raw(),
  );
  assert_eq!(glean_experiment_test_is_active(
    CString::new("experiment").unwrap().into_raw(),
  ), 1);
  glean_experiment_test_get_data(
    CString::new("experiment").unwrap().into_raw(),
  );
  glean_new_ping_type(
    CString::new("ping").unwrap().into_raw(),
    1,
    1,
  );
  glean_register_ping_type(0);
  assert_eq!(glean_test_has_ping_type(
    CString::new("ping").unwrap().