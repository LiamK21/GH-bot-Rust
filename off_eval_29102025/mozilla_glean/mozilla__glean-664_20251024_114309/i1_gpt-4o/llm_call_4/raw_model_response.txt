<Filename>glean-core/ffi/src/lib.rs</Filename>
<imports>
use super::glean_initialize;
use super::glean_is_upload_enabled;
use super::glean_set_upload_enabled;
use std::ptr;
use ffi_support::FfiStr;
use glean_core::Glean;
</imports>
<Rust>
#[test]
fn test_initialize_and_check_upload_enabled() {
    unsafe {
        let config = Box::into_raw(Box::new(FfiConfiguration {
            data_path: FfiStr::from_str("/tmp"),
            application_id: FfiStr::from_str("test_app"),
            upload_enabled: 1,
            max_events: 1000,
            delay_ping_lifetime_io: 0,
        }));
        let init_result = glean_initialize(config);
        assert_eq!(init_result, 1);

        glean_set_upload_enabled(1);
        let upload_enabled = glean_is_upload_enabled();
        assert_eq!(upload_enabled, 1);
    }
}
</Rust>