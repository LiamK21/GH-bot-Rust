#[test]
fn test_pending_pings_directory_size_in_kilobytes() {
    let (glean, _temp_dir) = with_glean!("test").unwrap();

    // Create a PingUploadManager instance with two pings 
    // that total exactly 2048 bytes (2 KB)
    let mut upload_manager = PingUploadManager::default();

    // Simulate pending_pings_directory_size being 2048 bytes 
    // (this would typically happen naturally during ping processing)
    upload_manager.pending_pings_directory_size = 2048;

    // Trigger the metric accumulation logic
    upload_manager.process(&glean);

    // Validate the metric is stored as 2 KB (2048 / 1024) 
    // The metric name is assumed based on the patch context
    let value = test_get_value!("upload.metrics.pending_pings_directory_size").unwrap();
    assert_eq!(value, 2);
}