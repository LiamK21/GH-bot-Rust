#[test]
fn test_custom_distribution_invalid_value_error_count() {
    let tmpdir = tempdir().unwrap();
    let glean = Glean::new(tmpdir.path(), Some("RLB Test".to_string())).unwrap();
    setup_glean(glean).unwrap();

    let metric = CustomDistributionMetric::new(
        CommonMetricData {
            category: "testing".into(),
            name: "custom_dist".into(),
            send_in_pings: vec!["test_ping".into()],
            ..Default::default()
        },
        0,
        100,
        10,
        HistogramType::Linear,
    );

    metric.accumulate_samples_signed(vec![5, -5, -10]);

    block_on_dispatcher();

    let error_count = metric.test_get_num_recorded_errors(ErrorType::InvalidValue, None);
    assert_eq!(error_count, 2);
}