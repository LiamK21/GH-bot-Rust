#[test]
fn test_metrics_enabled_inversion() {
    with_glean(|glean| {
        let category = "category";
        let name = "enabled_metric";

        let metric = StringMetric::new(
            &glean,
            category,
            name,
            "test string metric",
            false,
        );

        let base_identifier = metric.meta().base_identifier();

        let config = json!({base_identifier: true}).to_string();
        glean_set_metrics_enabled_config(config);

        metric.set("test_value");

        assert_eq!(metric.test_get_value(&glean, None), Some("test_value"));
    });
}