#[test]
fn test_pending_pings_deleted_when_upload_disabled() {
    let dir = tempdir().unwrap();
    let ping_dir = dir.path().join("pending-pings");
    fs::create_dir_all(&ping_dir).unwrap();
    let ping_file = ping_dir.join("test.ping");
    fs::write(&ping_file, "{}").unwrap();

    let config = Configuration {
        data_path: dir.path().to_str().unwrap().to_string(),
        application_id: "test".to_string(),
        upload_enabled: false,
        language_binding_name: "glean-core-test".to_string(),
        delay_ping_lifetime_io: false,
        max_events: 1000,
    };

    Glean::new(config).unwrap();

    assert!(!ping_file.exists());
}