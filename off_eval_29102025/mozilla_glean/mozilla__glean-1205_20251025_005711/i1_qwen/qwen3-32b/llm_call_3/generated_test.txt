#[test]
fn test_pending_pings_deleted_when_upload_disabled() {
    let dir = tempdir().unwrap();
    let ping_file = dir.path().join("pending-pings").join("test.ping");
    fs::create_dir_all(ping_file.parent().unwrap()).unwrap();
    fs::write(&ping_file, "{}").unwrap();

    let config = Configuration {
        data_path: dir.path().to_str().unwrap().to_string(),
        application_id: "test".to_string(),
        upload_enabled: false,
        ..Default::default()
    };

    Glean::new(config).unwrap();

    assert!(!ping_file.exists());
}