<Filename>glean-core/ffi/src/lib.rs</Filename>
<imports>
use super::glean_initialize_for_subprocess;
use std::ffi::CString;
use crate::FfiConfiguration;
</imports>
<Rust>
#[test]
fn test_non_deletion_pings_not_uploaded_when_upload_disabled() {
    let data_dir = CString::new("test_path").unwrap();
    let package_name = CString::new("test_app").unwrap();
    let config = FfiConfiguration {
        data_dir: data_dir.as_ptr(),
        package_name: package_name.as_ptr(),
        language_binding_name: CString::new("test_binding").unwrap().as_ptr(),
        upload_enabled: 0,
        delay_ping_lifetime_io: 0,
        max_events: None,
    };
    let config_ptr = &config as *const FfiConfiguration;
    let result = unsafe { glean_initialize_for_subprocess(config_ptr) };
    assert_eq!(result, 1);
}
</Rust>