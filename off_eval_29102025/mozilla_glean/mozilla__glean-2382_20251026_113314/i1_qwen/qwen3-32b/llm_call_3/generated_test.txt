#[test]
fn test_missing_send_ids_counter_incremented() {
    let glean = TestGlean::new();
    let document_id = "untracked_doc";

    let upload_metrics = UploadMetrics::new();
    let mut manager = PingUploadManager {
        upload_metrics,
        send_ids: Mutex::new(HashMap::new()),
        ..Default::default()
    };

    let status = UploadResult::HttpStatus { code: 500 };
    manager.handle_upload(document_id, &status);

    assert_eq!(glean.get_metric("glean.upload.missing_send_ids", None).unwrap(), 1);
}