#[test]
fn test_missing_send_ids_counter_incremented() {
    let glean = TestGlean::new();
    let document_id = "untracked_doc";

    let upload_metrics = UploadMetrics::new();
    let manager = PingUploadManager {
        upload_metrics,
        send_ids: Mutex::new(HashMap::new()),
        ..PingUploadManager::default()
    };

    manager.handle_upload(document_id, &UploadResult::HttpStatus { code: 500 });

    assert_eq!(glean.get_metric::<_, u32>("glean.upload.missing_send_ids", None).unwrap(), 1);
}