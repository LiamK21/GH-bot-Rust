<Filename>glean-core/src/upload/mod.rs</Filename>
<imports>
use super::PingUploadManager;
use crate::internal_metrics::UploadMetrics;
use crate::glean::Glean;
use crate::glean::CommonMetricData;
use crate::metrics::CounterMetric;
use crate::metrics::Lifetime;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_missing_send_ids_increments_counter() {
    let glean = Glean::new();
    let upload_metrics = UploadMetrics {
        send_success: TimingDistributionMetric::new(CommonMetricData::default()),
        send_failure: TimingDistributionMetric::new(CommonMetricData::default()),
        in_flight_pings_dropped: CounterMetric::new(CommonMetricData::default()),
        missing_send_ids: CounterMetric::new(CommonMetricData {
            name: "missing_send_ids".into(),
            category: "glean.upload".into(),
            send_in_pings: vec!["metrics".into()],
            lifetime: Lifetime::Ping,
            disabled: false,
            dynamic_label: None,
        }),
    };
    let mut ping_upload_manager = PingUploadManager {
        upload_metrics,
        // other fields initialized as needed
    };
    let document_id = "test_doc_id";
    let status = HttpStatus { code: 404 };
    let mut lock = HashMap::new();

    ping_upload_manager.handle_upload_status(&glean, document_id, status, &mut lock);

    let expected = 1;
    let actual = ping_upload_manager.upload_metrics.missing_send_ids.test_get_value(&glean, "metrics");
    assert_eq!(expected, actual);
}
</Rust>