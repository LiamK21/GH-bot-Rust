#[test]
fn test_process_ping_upload_response_re_enqueues_on_server_error() {
  let directory_manager = PingDirectoryManager::new("/tmp");
  let upload_manager = super::PingUploadManager::new("/tmp");
  let uuid = "some_uuid";
  let _ = directory_manager.process_file(uuid);
  upload_manager.process_ping_upload_response(uuid, 500);
  let mut upload_task = upload_manager.get_upload_task();
  while upload_task == super::PingUploadTask::Wait {
      thread::sleep(Duration::from_millis(10));
      upload_task = upload_manager.get_upload_task();
  }
  match upload_task {
      super::PingUploadTask::Upload(request) => {
          assert_eq!(request.uuid, uuid);
      }
      _ => panic!("Expected upload manager to return the next request!"),
  }
}