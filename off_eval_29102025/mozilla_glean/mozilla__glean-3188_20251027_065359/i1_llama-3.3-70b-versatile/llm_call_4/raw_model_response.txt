<Filename>glean-core/src/ping/mod.rs</Filename>
<imports>
use serde_json::json;
use serde_json::Value;
use super::PingMaker;
</imports>
<Rust>
#[test]
fn test_uploader_capabilities_included_in_ping() {
  let ping = PingMaker::new();
  let uploader_capabilities = vec!["capability1".to_string(), "capability2".to_string()];
  let metrics_data = ping.event_storage().snapshot_as_json("glean", "test_ping", true);
  let expected_key = "glean.ping.uploader_capabilities";
  let expected_value = json!(uploader_capabilities);
  if let Some(map) = metrics_data.as_object() {
    if let Some(string_list) = map.get("string_list") {
      if let Some(lists) = string_list.as_object() {
        assert!(lists.contains_key(expected_key));
        assert_eq!(lists.get(expected_key), Some(&expected_value));
      }
    }
  }
}
</Rust>