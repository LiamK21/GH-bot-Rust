#[test]
fn test_in_flight_pings_dropped_counter_incremented() {
    let glean = TestingGlean::new(
        Configuration::new("test".into(), "test.app".into(), None),
        true,
    );
    let upload_metrics = UploadMetrics {
        pending_pings: Default::default(),
        send_success: Default::default(),
        send_failure: Default::default(),
        in_flight_pings_dropped: Default::default(),
    };
    let mut in_flight_pings = HashSet::new();
    in_flight_pings.insert("existing_ping".to_string());
    let mut manager = PingUploadManager {
        upload_metrics,
        in_flight_pings,
        ..Default::default()
    };

    manager.upload("existing_ping", "path/to/ping");

    let counter = manager.upload_metrics.in_flight_pings_dropped.get_value(&glean, None).unwrap();
    assert_eq!(counter, 1);
}