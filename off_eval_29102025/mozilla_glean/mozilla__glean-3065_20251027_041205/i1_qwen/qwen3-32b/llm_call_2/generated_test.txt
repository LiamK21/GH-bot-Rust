#[test]
fn test_ohttp_ping_fails_on_non_desktop() {
    let tmp_dir = Shell::new().unwrap().pushd_dir("ohttp_test").unwrap();
    let pings_yaml = tmp_dir.join("pings.yaml");
    let mut pings_file = std::fs::File::create(&pings_yaml).unwrap();
    writeln!(
        pings_file,
        "pings:\n  my_pings:\n    type: ping\n    method: OHTTP"
    )
    .unwrap();
    let builder = Builder::new();
    let result = builder.generate();
    assert!(matches!(result, Err(e) if e.to_string().contains("OHTTP pings must only be used on Desktop")));
}