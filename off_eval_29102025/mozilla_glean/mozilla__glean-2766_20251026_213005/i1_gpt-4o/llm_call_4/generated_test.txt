#[test]
fn test_record_error() {
    let glean = Arc::new(Glean::new(InternalConfiguration {
        application_id: "test_app_id".into(),
        language_binding_name: "test_language_binding".into(),
        max_events: 0,
        delay_ping_lifetime_io: false,
        app_build: "test_build".into(),
        data_path: "".into(),
        upload_enabled: true,
        server_endpoint: None,
        rate_limit: None,
        log_pings: false,
        debug_view_tag: None,
    }).unwrap());

    let metric = CounterMetric::new(CommonMetricData {
        name: "test_name".into(),
        category: "test_category".into(),
        send_in_pings: vec!["test_send_in_pings".into()],
        lifetime: Lifetime::Ping,
        disabled: false,
        ..Default::default()
    });

    let error_type = ErrorType::InvalidValue;
    let count = 1;

    let expected_error_count = 1;

    metric.record_error(error_type, count);

    let actual_error_count = error_recording::get_error_count(glean, &metric, error_type);

    assert_eq!(expected_error_count, actual_error_count);
}