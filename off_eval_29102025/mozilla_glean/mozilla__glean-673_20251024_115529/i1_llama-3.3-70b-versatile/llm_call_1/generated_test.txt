#[test]
fn test_ping_upload_manager_processes_pending_pings() {
  let data_dir = tempfile::tempdir().unwrap();
  let tmpname = data_dir.path().display().to_string();
  let upload_manager = PingUploadManager::new(&tmpname);
  let uuid = "c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0";
  let url = "http://example.com";
  let body = serde_json::json!({});
  upload_manager.enqueue_ping(uuid, url, body);
  thread::sleep(Duration::from_millis(100));
  let request = upload_manager.get_next_ping();
  assert!(request.is_some());
}