<Filename>glean-core/src/lib_unit_tests.rs</Filename>
<imports>
use super::new_glean;
use crate::metrics::StringMetric;
use crate::metrics::CommonMetricData;
</imports>
<Rust>
#[test]
fn test_new_glean_with_tempdir() {
    let tempdir = tempfile::tempdir().unwrap();
    let (glean, dir) = new_glean(Some(tempdir));
    let metric = StringMetric::new(CommonMetricData::new(
        "category",
        "string_metric",
        "test_new_glean_with_tempdir",
        None,
        None,
        None,
    ));
    metric.set(&glean, "test_value".into());

    let expected = Some("test_value".to_string());
    let actual = metric.test_get_value(&glean, "test_new_glean_with_tempdir");

    assert_eq!(expected, actual);
}
</Rust>