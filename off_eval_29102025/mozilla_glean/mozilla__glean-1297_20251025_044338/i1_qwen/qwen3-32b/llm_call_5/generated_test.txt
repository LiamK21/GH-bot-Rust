#[test]
fn test_tasks_after_shutdown_do_not_execute() {
    let dispatcher = super::Dispatcher::new(10);
    let result = Arc::new(Mutex::new(Vec::new()));
    let result_clone = Arc::clone(&result);

    // Launch a task before shutdown to ensure the dispatcher is running
    dispatcher.guard().launch(move || {
        result.lock().unwrap().push(0);
    }).unwrap();

    // Shutdown the dispatcher
    dispatcher.guard().shutdown().unwrap();

    // Attempt to launch a task after shutdown
    let _ = dispatcher.guard().launch(move || {
        result_clone.lock().unwrap().push(1);
    });

    // Wait for the dispatcher to finish
    dispatcher.join().unwrap();

    // Result should only contain the 0 from before shutdown
    assert_eq!(*result.lock().unwrap(), vec![0]);
}