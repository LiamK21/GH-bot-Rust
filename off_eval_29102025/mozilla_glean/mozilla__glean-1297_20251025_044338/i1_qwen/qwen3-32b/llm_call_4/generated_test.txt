#[test]
fn test_tasks_after_shutdown_do_not_execute() {
    let dispatcher = super::Dispatcher::new(10);
    let result = Arc::new(Mutex::new(Vec::new()));
    let result_cloned = Arc::clone(&result);

    let handle = thread::spawn(|| {
        let result_cloned = result_cloned.clone();
        dispatcher.guard().shutdown().unwrap();
        let _ = dispatcher.guard().launch(move || {
            result_cloned.lock().unwrap().push(0);
        });
    });

    handle.join().unwrap();

    assert!(result.lock().unwrap().is_empty());
    dispatcher.join().unwrap();
}