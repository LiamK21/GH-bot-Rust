#[test]
fn test_tasks_after_shutdown_do_not_execute() {
    let dispatcher = super::Dispatcher::new();
    let guard = dispatcher.guard();
    let result = std::sync::Arc::new(std::sync::Mutex::new(Vec::new()));
    let result_cloned = std::sync::Arc::clone(&result);

    let handle = thread::spawn(move || {
        guard.shutdown().unwrap();
        let _ignore_err = dispatcher.guard().launch(move || {
            result_cloned.lock().unwrap().push(0);
        });
    });

    handle.join().unwrap();

    assert!(result.lock().unwrap().is_empty());
    dispatcher.join().unwrap();
}