#[test]
fn test_metric_id_consistency() {
    let temp_dir = tempdir::TempDir::new("glean_core_test").unwrap();
    let glean = crate::Glean::new(temp_dir.path().to_path_buf(), "application_id".to_string(), false).unwrap();

    let common = CommonMetricData {
        category: "category".to_string(),
        name: "name".to_string(),
        send_in_pings: vec!["store".to_string()],
        ..Default::default()
    };

    let metric = TestMetric {
        common,
        ty: MetricType::String,
        ..Default::default()
    };

    metric.lock().unwrap().set(String::from("test_value"), false).unwrap();

    let snapshot = StorageManager::snapshot("store", None, true).unwrap();
    assert_eq!(snapshot["category.name"], "test_value");
}