#[test]
fn test_set_log_pings_affects_upload_task() {
    unsafe {
        // Initialize Glean library with minimal setup
        glean_set_debug_view_tag(unsafe { std::ffi::CString::new("rust_debug").unwrap().into_raw() });

        // Set log pings to true via the FFI function
        glean_set_log_pings(1);

        // Get the upload task through the updated API
        let mut task = std::mem::zeroed();
        glean_get_upload_task(&mut task);

        // Ensure the upload task has the debug ping tag set
        assert!(!task.log_ping.is_null(), "Log ping should be set");

        // Free the allocated log_ping string via the correct FFI function
        glean_str_free(task.log_ping);
    }
}