<Filename>glean-core/src/lib_unit_tests.rs</Filename>
<imports>
use super::Glean;
use super::GLOBAL_APPLICATION_ID;
use tempfile::tempdir;
</imports>
<Rust>
#[test]
fn test_database_file_size_recorded() {
    let _ = env_logger::builder().is_test(true).try_init();

    let dir = tempdir().unwrap();
    let tmpname = dir.path().display().to_string();

    // Initialize Glean once to ensure we create the database.
    let glean = Glean::with_options(&tmpname, GLOBAL_APPLICATION_ID, true).unwrap();
    let database_size = &glean.database_metrics.size;
    let data = database_size.test_get_value(&glean, "metrics");
    assert!(data.is_none());
    drop(glean);

    // Initialize Glean again to record file size.
    let glean = Glean::with_options(&tmpname, GLOBAL_APPLICATION_ID, true).unwrap();

    let database_size = &glean.database_metrics.size;
    let data = database_size.test_get_value(&glean, "metrics");
    assert!(data.is_some());
    let data = data.unwrap();

    // We should see the database containing some data.
    assert!(data.sum > 0);
}
</Rust>