#[test]
fn test_glean_enable_logging_does_not_setup_env_logger() {
    struct Logger {
        messages: Mutex<Vec<String>>,
    }

    impl Log for Logger {
        fn enabled(&self, _: &Metadata) -> bool { true }
        fn log(&self, record: &Record) {
            self.messages.lock().unwrap().push(format!("{}", record.args()));
        }
        fn flush(&self) {}
    }

    let logger = Logger {
        messages: Mutex::new(Vec::new()),
    };
    set_logger(Box::new(logger)).unwrap();
    log::set_max_level(LevelFilter::Trace);

    unsafe { glean_enable_logging() };

    let messages = logger.messages.lock().unwrap();
    assert!(
        !messages.iter().any(|msg| msg.contains("stdout logging should be hooked up!")),
        "Log message for env_logger initialization was present unexpectedly"
    );
}