#[test]
fn test_start_scheduler_condvar_wait_timeout() {
  let condvar = Arc::new((Mutex::new(false), Condvar::new()));
  struct DummySubmitter {}
  impl MetricsPingSubmitter for DummySubmitter {
    fn submit_metrics_ping(&self, _glean: &(), _reason: Option<()>, _now: DateTime<FixedOffset>) {}
  }
  let now = DateTime::parse_from_rfc3339("2022-01-01T00:00:00Z").unwrap().with_timezone(&FixedOffset::east(0));
  let when = When::Reschedule;
  let handle = thread::spawn(move || {
    start_scheduler(DummySubmitter {}, now, when);
  });
  thread::sleep(Duration::from_millis(100));
  let (lock, cvar) = &*condvar;
  *lock.lock().unwrap() = true;
  cvar.notify_one();
  handle.join().unwrap();
  assert!(true);
}