<Filename> glean-core/src/scheduler.rs </Filename>
<imports> 
use std::sync::Arc;
use std::sync::Condvar;
use std::sync::Mutex;
use std::thread;
use std::time::Duration;
use super::start_scheduler;
use chrono::DateTime;
use chrono::FixedOffset;
use glean_core::scheduler::When;
use glean_core::scheduler::MetricsPingSubmitter;
</imports>
<Rust>
#[test]
fn test_start_scheduler_condvar_wait_timeout() {
  let condvar = Arc::new((Mutex::new(false), Condvar::new()));
  let submitter = struct DummySubmitter {}
  impl MetricsPingSubmitter for DummySubmitter {
    fn submit_metrics_ping(&self, _glean: &(), _reason: Option<()>, _now: DateTime<FixedOffset>) {}
  }
  let now = DateTime::parse_from_rfc3339("2022-01-01T00:00:00Z").unwrap().with_timezone(&FixedOffset::east(0));
  let when = When::Reschedule;
  let handle = start_scheduler(submitter, now, when);
  thread::sleep(Duration::from_millis(100));
  let (lock, cvar) = &*condvar;
  *lock.lock().unwrap() = true;
  cvar.notify_one();
  handle.join().unwrap();
}</Rust>