<Filename>glean-core/src/upload/mod.rs</Filename>
<imports>
use std::thread;
use std::time::Duration;
use super::PingUploadManager;
use super::PingUploadTask;
</imports>
<Rust>
#[test]
fn test_get_upload_task_returns_wait_when_not_processed() {
    let dir = tempfile::tempdir().unwrap();
    let tmpname = dir.path().display().to_string();
    let upload_manager = PingUploadManager::new(&tmpname);

    let mut upload_task = upload_manager.get_upload_task();
    while upload_task != PingUploadTask::Wait {
        thread::sleep(Duration::from_millis(10));
        upload_task = upload_manager.get_upload_task();
    }

    assert_eq!(upload_task, PingUploadTask::Wait);
}
</Rust>