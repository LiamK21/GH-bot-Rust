<Filename> glean-core/src/lib.rs </Filename>
<imports> 
use log::Level;
use super::Glean;
use std::io::Cursor;
use log::{Log, Metadata, Record};
use std::sync::mpsc;
</imports>
<Rust>
#[test]
fn test_glean_disabled_logging() {
  struct TestLogger {
    received: mpsc::Receiver<(Log, String)>,
  }

  impl log::Log for TestLogger {
    fn enabled(&self, _metadata: &Metadata) -> bool {
      true
    }

  fn log(&self, record: &Record) {
    let (tx, rx) = mpsc::channel();
    self.received = rx;
    tx.send((record.level(), format!("{}", record.args()))).unwrap();
  }

  fn flush(&self) {}
}

let (tx, rx) = mpsc::channel();
let logger = TestLogger { received: rx };
log::set_logger(&logger).unwrap();
log::set_max_level(Level::Info);

let glean = Glean::new();
let ping = PingType {};
let reason = None;
glean.submit_ping(&ping, reason);

let (level, message) = logger.received.recv().unwrap();
assert_eq!(level, Level::Info);
assert_eq!(message, "Glean disabled: not submitting any pings.");
}</Rust>