#[test]
fn test_event_record_with_extra_keys() {
  // Initialize required variables
  struct SomeExtra {
    key1: Option<String>,
    key2: Option<String>,
  }

  impl glean_core::traits::ExtraKeys for SomeExtra {
    const ALLOWED_KEYS: &'static [&'static str] = &["key1", "key2"];

    fn into_ffi_extra(self) -> HashMap<i32, String> {
      let mut map = HashMap::new();
      self.key1.and_then(|key1| map.insert(0, key1));
      self.key2.and_then(|key2| map.insert(1, key2));
      map
    }
  }

  // Define expected variable
  let expected = HashMap::from([(0, "1".to_string()), (1, "2".to_string())]);

  // Generate actual variables
  let actual = SomeExtra {
    key1: Some("1".to_string()),
    key2: Some("2".to_string()),
  };

  // Compare expected with actual
  let metric: EventMetric<SomeExtra> = EventMetric { inner: Arc::new(()) };
  metric.record(Some(actual));
}