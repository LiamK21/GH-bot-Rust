#[test]
fn test_get_value_lock_order_regression() {
    test_with_glean(|glean| {
        // Create a metric with some recorded values
        let metric = TimingDistributionMetric::new("test".into(), "category", true);
        metric.record(100);

        // Access the test_get_value function which exercises the lock order
        let value = metric.test_get_value::<&str>(None);

        // Verify the structure, ensuring the code path executed without lock inversion
        assert!(value.is_some());
        let data = value.unwrap();
        assert_eq!(data.min.unwrap(), 100);
        assert_eq!(data.max.unwrap(), 100);
        assert_eq!(data.sum.unwrap(), 100);
    });
}