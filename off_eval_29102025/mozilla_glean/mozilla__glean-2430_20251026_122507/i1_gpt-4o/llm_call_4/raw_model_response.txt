<Filename>glean-core/src/metrics/memory_distribution.rs</Filename>
<imports>
use super::MemoryDistributionMetric;
use crate::core::Glean;
use crate::metrics::Metric;
use crate::CommonMetricData;
use crate::metrics::MemoryUnit;
use std::path::Path;
use crate::core::Configuration;
use log::warn;
</imports>
<Rust>
#[test]
fn test_memory_distribution_no_database() {
    let glean = Glean::new(
        Configuration {
            data_path: Path::new("/tmp").to_path_buf(),
            application_id: "test_app_id".into(),
            application_version: "test_app_version".into(),
            channel: "test_channel".into(),
            os: "test_os".into(),
            os_version: "test_os_version".into(),
            device: "test_device".into(),
            manufacturer: "test_manufacturer".into(),
            architecture: "test_architecture".into(),
            upload_enabled: false,
            delay_ping_lifetime_io: false,
        }
    ).expect("Failed to create Glean");

    let metric = MemoryDistributionMetric::new(
        CommonMetricData {
            name: "name".into(),
            category: "category".into(),
            send_in_pings: vec!["ping".into()],
            disabled: false,
            lifetime: Default::default(),
            ..Default::default()
        },
        MemoryUnit::Byte,
    );

    glean.storage_opt().unwrap().clear_all();

    metric.accumulate(50);

    let recorded = glean.storage_opt().and_then(|storage| {
        storage.has_metric("category", "name")
    });

    assert!(!recorded.unwrap_or(false));
}
</Rust>