<Filename>glean-core/src/metrics/memory_distribution.rs</Filename>
<imports>
use log::warn;
use super::Glean;
use crate::InternalConfiguration;
use crate::database::Database;
</imports>
<Rust>
#[test]
fn test_memory_distribution_metric_recording() {
  let glean = Glean::new(InternalConfiguration::default()).unwrap();
  let metric = super::MemoryDistributionMetric::new("test_metric");
  let sample = 10;
  let meta = metric.meta();

  // Simulate the storage being gone
  glean.data_store = None;

  // Record the metric
  metric.accumulate(sample);

  // Check if a warning was logged
  // Since we can't directly check the log, we'll verify that the metric wasn't recorded
  assert!(glean.storage().map_or(true, |storage| storage.get(&meta.base_identifier()).is_none()));
}
</Rust>