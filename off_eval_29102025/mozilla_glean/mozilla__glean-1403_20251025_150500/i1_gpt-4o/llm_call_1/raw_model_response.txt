<Filename>glean-core/src/lib_unit_tests.rs</Filename>
<imports>
use super::first_run_date_is_managed_correctly_when_toggling_uploading;
use super::Glean;
use super::new_glean;
</imports>
<Rust>
#[test]
fn test_first_run_hour_is_set_and_persisted() {
    let (mut glean, _) = new_glean(None);

    let original_first_run_hour = glean
        .core_metrics
        .first_run_hour
        .get_value(&glean, "metrics");

    glean.set_upload_enabled(false);
    let first_run_hour_after_disable = glean
        .core_metrics
        .first_run_hour
        .get_value(&glean, "metrics");

    glean.set_upload_enabled(true);
    let first_run_hour_after_enable = glean
        .core_metrics
        .first_run_hour
        .get_value(&glean, "metrics");

    assert_eq!(original_first_run_hour, first_run_hour_after_disable);
    assert_eq!(original_first_run_hour, first_run_hour_after_enable);
}
</Rust>