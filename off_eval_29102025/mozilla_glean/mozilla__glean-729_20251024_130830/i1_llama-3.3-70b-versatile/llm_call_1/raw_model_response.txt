<Filename> glean-core/src/upload/mod.rs </Filename>
<imports> 
use super::PingUploadManager;
use std::sync::Arc;
use std::sync::RwLock;
use std::collections::VecDeque;
use serde_json::Value as JsonValue;
</imports>
<Rust>
#[test]
fn test_clearing_queue_leaves_deletion_request_pings() {
  let upload_manager = PingUploadManager::new("/data/path");
  let ping_request = super::PingRequest::new("uuid", "/submit/app_id/deletion-request/schema_version/doc_id", JsonValue::Null);
  let ping_request2 = super::PingRequest::new("uuid2", "/submit/app_id/ping_name/schema_version/doc_id2", JsonValue::Null);
  upload_manager.enqueue_ping("uuid", "/submit/app_id/deletion-request/schema_version/doc_id", JsonValue::Null);
  upload_manager.enqueue_ping("uuid2", "/submit/app_id/ping_name/schema_version/doc_id2", JsonValue::Null);
  let _ = upload_manager.clear_ping_queue();
  let upload_task = upload_manager.get_upload_task();
  match upload_task {
    super::PingUploadTask::Upload(request) => assert!(request.is_deletion_request()),
    _ => panic!("Expected upload manager to return the next request!"),
  }
  assert_eq!(upload_manager.get_upload_task(), super::PingUploadTask::Done);
}
</Rust>