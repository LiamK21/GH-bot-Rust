#[test]
fn test_set_upload_enabled() {
    let state = global_state().lock().unwrap();
    let initial_upload_enabled = state.upload_enabled;

    set_upload_enabled(!initial_upload_enabled);

    let new_state = global_state().lock().unwrap();
    assert_eq!(new_state.upload_enabled, !initial_upload_enabled);
}