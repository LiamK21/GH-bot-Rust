#[test]
fn test_remove_glean_timestamp_in_test_mode() {
    let glean = Glean::new_temporary();
    let event_metric = EventMetric::new("category", "name", vec![], false, vec!["test"]);

    // Simulate recording an event with glean_timestamp in test mode
    let mut extra = HashMap::new();
    extra.insert("glean_timestamp".to_string(), "123456789".to_string());
    event_metric.record(&glean, None, Some(extra));

    // Define expected result: glean_timestamp should be removed
    let expected: Option<Vec<_>> = Some(vec![Event {
        timestamp: 0,
        category: "category".to_string(),
        name: "name".to_string(),
        extra: None,
    }]);

    // Generate actual result
    let actual = event_metric.test_get_value(&glean);

    // Compare expected with actual
    assert_eq!(expected, actual);
}