<Filename>glean-core/src/metrics/event.rs</Filename>
<imports>
use super::EventMetric;
use crate::Glean;
use crate::metrics::Metric;
use std::collections::HashMap;
use crate::core::Glean as CoreGlean;
use crate::metrics::CommonMetricData;
use crate::metrics::event::Event;
</imports>
<Rust>
#[test]
fn test_remove_glean_timestamp_in_test_mode() {
    let glean = CoreGlean::new(Glean::new_glean(None, true)).unwrap();
    let common_metric_data = CommonMetricData {
        name: "name".into(),
        category: "category".into(),
        send_in_pings: vec!["test".into()],
        ..Default::default()
    };
    let event_metric = EventMetric::new(common_metric_data, vec!["glean_timestamp".into()]);

    let mut extra = HashMap::new();
    extra.insert("glean_timestamp".to_string(), "123456789".to_string());
    event_metric.record(extra);

    let expected: Option<Vec<_>> = Some(vec![Event {
        timestamp: 0,
        category: "category".to_string(),
        name: "name".to_string(),
        extra: None,
    }]);

    let actual = event_metric.test_get_value(&glean);

    assert_eq!(expected, actual);
}</Rust>