#[test]
fn test_event_get_test_value_filters_glean_timestamp() {
    let tmp_dir = new_glean(None, true);
    let glean = Glean::new(tmp_dir.path(), new_configuration().unwrap()).unwrap();
    let metric = EventMetric::new_test("test_category", "test_event", vec!["events"]);
    metric
        .record_event_with_extra(&None, &Some(HashMap::from([("glean_timestamp", "12345")])));

    let events = metric.test_get_value::<()>("events").unwrap();

    for event in events {
        if let Some(extra) = event.extra {
            assert!(!extra.contains_key("glean_timestamp"));
        }
    }
}