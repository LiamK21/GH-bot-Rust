#[test]
fn test_event_get_test_value_filters_glean_timestamp() {
    let _tmp_dir = new_glean(None, true);
    let metric = EventMetric::new(
        CommonMetricData::new(
            "test_category",
            "test_event",
            "events",
            User,
        ),
        vec!["glean_timestamp".to_string()],
    );
    metric.record_event_with_extra(&None, &Some(HashMap::from([("glean_timestamp", "12345")])));

    let events = metric.test_get_value::<()>("events").unwrap();

    for event in events {
        if let Some(extra) = event.extra {
            assert!(!extra.contains_key("glean_timestamp"));
        }
    }
}