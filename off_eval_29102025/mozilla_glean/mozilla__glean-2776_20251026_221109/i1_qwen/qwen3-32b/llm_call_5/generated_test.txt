#[test]
fn test_event_get_test_value_filters_glean_timestamp() {
    let _tmp_dir = new_glean(None, true);
    let metric = EventMetric::new(
        CommonMetricData::new(
            "test_category",
            "test_event",
            "events",
            Lifetime::User,
        ),
        vec!["glean_timestamp".to_string()],
    );
    let mut extra = HashMap::new();
    extra.insert("glean_timestamp".to_string(), "12345".to_string());
    metric.record(&None, Some(&extra));

    let events = metric.test_get_value(Some("events".to_string())).unwrap();

    for event in events {
        if let Some(extra) = event.extra {
            assert!(!extra.contains_key("glean_timestamp"));
        }
    }
}