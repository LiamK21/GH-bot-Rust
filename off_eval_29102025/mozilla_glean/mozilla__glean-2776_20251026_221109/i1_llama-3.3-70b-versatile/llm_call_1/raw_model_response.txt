glean-core/src/metrics/event.rs
<imports>
use glean_core::metrics::event::EventMetric;
use glean_core::metrics::Configuration;
use glean_core::metrics::ConfigurationBuilder;
use glean_core::metrics::GLOBAL_APPLICATION_ID;
use tempfile::TempDir;
use std::collections::HashMap;
</imports>
<Rust>
#[test]
fn test_event_timestamp_removal() {
  let tmp_dir = TempDir::new().unwrap();
  let configuration = ConfigurationBuilder::new(true, tmp_dir.path(), GLOBAL_APPLICATION_ID)
    .with_server_endpoint("invalid-test-host")
    .build();
  let glean = super::new_glean(Some(configuration), true);
  let event = EventMetric::new("test_event", "test_category", "test_name", "test_type", "test_description");
  let _ = event.set(&glean, "test_value");
  let events = event.test_get_value(&glean, "test_ping");
  let mut expected_events = Vec::new();
  let mut event_data = HashMap::new();
  event_data.insert("key", "test_value");
  expected_events.push(glean_core::metrics::Event { timestamp: 0, category: "test_category".to_string(), name: "test_name".to_string(), extra: Some(event_data) });
  assert_eq!(events.unwrap(), expected_events);
}
</Rust>