#[test]
fn test_headers_do_not_contain_legacy_fields() {
    let mut headers = HashMap::new();
    headers.insert("Date".to_string(), "some_date".to_string());
    headers.insert("X-Telemetry-Agent".to_string(), "some_agent".to_string());
    headers.insert("Content-Type".to_string(), "application/json; charset=utf-8".to_string());
    headers.insert("Content-Length".to_string(), "123".to_string());

    let builder = Builder {
        document_id: None,
        body: None,
        headers,
        body_max_size: 0,
        path: None,
    };

    let request = builder.build().unwrap();

    assert!(!request.headers.contains_key("X-Client-Type"));
    assert!(!request.headers.contains_key("X-Client-Version"));
}