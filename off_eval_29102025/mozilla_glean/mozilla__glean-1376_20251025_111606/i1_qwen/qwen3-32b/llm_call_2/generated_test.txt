#[test]
fn test_memory_distribution_accumulates_value() {
    let dir = tempdir().unwrap();
    let path = dir.path().to_path_buf();
    setup_glean(&path, "test").unwrap();

    let metric = MemoryDistributionMetric::new(
        CommonMetricData {
            category: "test".to_string(),
            name: "metric".to_string(),
            send_in_pings: vec!["default".to_string()],
            ..Default::default()
        },
        MemoryUnit::Byte,
    );

    metric.accumulate(42);

    let value = metric.test_get_value(None);
    assert!(value.is_some(), "Value should be recorded");
    let data = value.unwrap();
    assert_eq!(data.min, Some(42), "Min should be 42");
    assert_eq!(data.max, Some(42), "Max should be 42");
    assert_eq!(data.sum, Some(42), "Sum should be 42");
    assert_eq!(data.count, 1, "Count should be 1");
    assert_eq!(data.values, Some(vec![42]), "Values should contain [42]");

    dir.close().unwrap();
}