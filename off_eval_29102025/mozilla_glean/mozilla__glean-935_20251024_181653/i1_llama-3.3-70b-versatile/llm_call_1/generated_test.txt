#[test]
fn test_log_if_error() {
  let error = ExternError::new(1, "Test error message");
  let hook = |record: &log::Record| {
    if record.level() == Level::Error && record.args().to_string().contains("Glean failed") {
      panic!("Test panic");
    }
  };
  let _ = panic::catch_unwind(|| {
    log::set_max_level(Level::Error);
    log::set_logger(&hook).unwrap();
    log_if_error(error);
  });
}