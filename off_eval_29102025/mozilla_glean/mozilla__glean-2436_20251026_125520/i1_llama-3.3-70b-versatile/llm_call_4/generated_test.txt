#[test]
fn test_date_header_set_at_upload_time() {
  let mut manager = PingUploadManager::new(PathBuf::from("/tmp"), "test");
  let glean = Glean::new(InternalConfiguration::default()).unwrap();
  let request = manager.get_upload_task(&glean, true);
  let expected_date = create_date_header_value(Utc::now());
  match request {
    crate::upload::PingUploadTask::Upload { request: req } => {
      let actual_date = req.headers.get("Date").unwrap().to_string();
      assert_ne!(actual_date, create_date_header_value(Utc::now() - chrono::Duration::seconds(1)));
    },
    _ => assert!(false, "Expected PingUploadTask::Upload"),
  }
}