#[test]
fn test_reset_glean_during_init_does_not_panic() {
    let result = panic::catch_unwind(|| {
        let client_info = ClientInfoMetrics {
            ..Default::default()
        };
        let mut config = Configuration::new("test", "1.0").unwrap();
        config.upload_enabled = false;

        // Initialize Glean (async)
        initialize(config.clone(), client_info.clone());

        // Immediately call test_reset_glean before init completes
        test_reset_glean(config, client_info, true);
    });

    // With patch: No panic expected
    // Without patch: Panic occurs due to incomplete init
    assert!(result.is_ok(), "test_reset_glean panicked unexpectedly");
}