#[test]
fn test_keyed_categorical_counter_regression() {
    // Test invalid key and category for static-static metric.
    let invalid_metric = glean_metrics::test_dual_labeled::static_static.get("invalid_key", "invalid_category");
    invalid_metric.add(1);

    // Check if `__other__` accumulates invalid keys/categories.
    let other Metric = glean_metrics::test_dual_labeled::static_static.get("__other__", "__other__");
    assert_eq!(Some(1), other Metric.test_get_value(None));

    // Check error count for InvalidLabel.
    let valid_metric = glean_metrics::test_dual_labeled::static_static.get("valid_key", "valid_category");
    assert_eq!(1, valid_metric.test_get_num_recorded_errors(ErrorType::InvalidLabel));
}