<Filename>samples/rust/src/main.rs</Filename>
<imports>
use glean::ErrorType;
use glean_metrics::test_dual_labeled;
</imports>
<Rust>
#[test]
fn test_keyed_categorical_counter_metric() {
    test_dual_labeled::static_static.get("key1", "category1").add(1);
    test_dual_labeled::static_static.get("key1", "category1").add(1);
    let expected = Some(2);
    let actual = test_dual_labeled::static_static.get("key1", "category1").test_get_value(None);
    assert_eq!(expected, actual);

    test_dual_labeled::static_static.get("unknown_key", "unknown_category").add(1);
    let other_expected = Some(1);
    let other_actual = test_dual_labeled::static_static.get("__other__", "__other__").test_get_value(None);
    assert_eq!(other_expected, other_actual);

    let error_count = test_dual_labeled::static_static.test_get_num_recorded_errors(ErrorType::InvalidLabel);
    assert_eq!(0, error_count);
}
</Rust>