<Filename>glean-core/rlb/src/private/timing_distribution.rs</Filename>
<imports>
use super::TimingDistributionMetric;
use glean_core::traits::TimingDistribution;
use std::sync::{Arc, RwLock};
use std::time::Duration;
use std::thread::sleep;
use glean_core::metrics::TimingDistributionMetric as CoreTimingDistributionMetric;
use glean_core::Glean;
use glean_core::Configuration;
use glean_core::metrics::CommonMetricData;
use glean_core::metrics::TimeUnit;
use glean_core::metrics::test_get_num_recorded_errors;
</imports>
<Rust>
#[test]
fn test_timing_distribution_methods() {
    let config = Configuration {
        app_id: "test_app_id".into(),
        channel: "test_channel".into(),
        ..Default::default()
    };
    let glean = Glean::new(config).unwrap();
    let metric_data = CommonMetricData {
        name: "name".into(),
        category: "category".into(),
        send_in_pings: vec!["test_send_in_pings".into()],
        ..Default::default()
    };
    let metric = TimingDistributionMetric(Arc::new(RwLock::new(CoreTimingDistributionMetric::new(metric_data, TimeUnit::Nanosecond))));

    let timer_id = metric.start();
    sleep(Duration::from_millis(10));
    metric.stop_and_accumulate(timer_id);

    let expected = 1;
    let actual = test_get_num_recorded_errors(&glean, "test_send_in_pings", "category.name").unwrap();

    assert_eq!(expected, actual);
}
</Rust>