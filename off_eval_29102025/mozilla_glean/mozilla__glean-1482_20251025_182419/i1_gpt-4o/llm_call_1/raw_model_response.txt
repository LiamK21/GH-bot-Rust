<Filename>glean-core/src/storage/mod.rs</Filename>
<imports>
use super::StorageManager;
use crate::database::Database;
use crate::Lifetime;
use crate::metrics::Metric;
use crate::coverage::record_coverage;
</imports>
<Rust>
#[test]
fn test_snapshot_metric_for_test_records_coverage() {
    let storage_manager = StorageManager::new();
    let database = Database::new_in_memory();
    let store_name = "test_store";
    let metric_id = "test_metric";
    let metric_lifetime = Lifetime::Ping;

    std::env::set_var("GLEAN_TEST_COVERAGE", "test_coverage_output.txt");
    storage_manager.snapshot_metric_for_test(&database, store_name, metric_id, metric_lifetime);

    let coverage_output = std::fs::read_to_string("test_coverage_output.txt").unwrap();
    assert!(coverage_output.contains(metric_id));
    std::fs::remove_file("test_coverage_output.txt").unwrap();
}
</Rust>