#[test]
fn test_partial_path_extension_filtering() {
    let mut result_map = FxHashMap::default();
    result_map.insert(
        "partial/path/java/file.java".to_string(),
        CovResult {
            lines: BTreeMap::new(),
            branches: BTreeMap::new(),
            functions: FunctionMap::default(),
        },
    );
    result_map.insert(
        "partial/path/nojava/file.txt".to_string(),
        CovResult {
            lines: BTreeMap::new(),
            branches: BTreeMap::new(),
            functions: FunctionMap::default(),
        },
    );

    let path_mapping = Some(serde_json::json!({ "partial": "full" }));
    let source_dir = None;
    let prefix_dir = None;
    let ignore_not_existing = false;
    let to_ignore_dirs: &[&str] = &[];
    let to_keep_dirs: &[&str] = &[];
    let filter_option = None;
    let file_filter = crate::file_filter::FileFilter::default();

    let results = super::rewrite_paths(
        result_map,
        path_mapping,
        source_dir,
        prefix_dir,
        ignore_not_existing,
        to_ignore_dirs,
        to_keep_dirs,
        filter_option,
        file_filter,
    );

    assert_eq!(results[0].0.to_str().unwrap(), "full/path/java/file.java");
    assert_eq!(results[1].0.to_str().unwrap(), "partial/path/nojava/file.txt");
}