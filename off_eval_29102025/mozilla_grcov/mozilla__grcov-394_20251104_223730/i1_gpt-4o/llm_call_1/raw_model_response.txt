<Filename>src/output.rs</Filename>
<imports>
use super::output_lcov;
use std::path::PathBuf;
use std::collections::BTreeMap;
use rustc_hash::FxHashMap;
use tempfile;
</imports>
<Rust>
#[test]
fn test_output_lcov_branch_coverage() {
    let tmp_dir = tempfile::tempdir().expect("Failed to create temporary directory");
    let file_name = "test_output_lcov_branch_coverage.info";
    let file_path = tmp_dir.path().join(&file_name);

    let results = vec![
        (
            PathBuf::from("src/lib.rs"),
            PathBuf::from("src/lib.rs"),
            CovResult {
                lines: [(1, 20), (2, 20), (3, 20), (4, 8), (5, 4), (7, 20)].iter().cloned().collect(),
                branches: {
                    let mut map = BTreeMap::new();
                    map.insert(3, vec![true, true, true]);
                    map
                },
                functions: FxHashMap::default(),
            },
        ),
    ];

    let results = Box::new(results.into_iter());
    output_lcov(results, Some(file_path.to_str().unwrap()));

    let results = std::fs::read_to_string(&file_path).expect("Failed to read file");

    assert!(results.contains("BRF:3\n"));
    assert!(results.contains("BRH:3\n"));
}
</Rust>