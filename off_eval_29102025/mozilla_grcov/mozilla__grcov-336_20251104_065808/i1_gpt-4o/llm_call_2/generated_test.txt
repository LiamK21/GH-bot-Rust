#[test]
fn test_output_coveralls_parallel_flag() {
    let results: Box<dyn Iterator<Item = (PathBuf, PathBuf, CovResult)>> = Box::new(empty());
    let repo_token = "dummy_token";
    let service_name = "dummy_service";
    let service_number = "dummy_number";
    let service_job_number = "dummy_job_number";
    let commit_sha = "dummy_commit_sha";
    let with_function_info = false;
    let output_file = None;
    let vcs_branch = "dummy_branch";
    let parallel = true;

    let expected = json!({
        "repo_token": repo_token,
        "service_name": service_name,
        "service_number": service_number,
        "service_job_number": service_job_number,
        "parallel": parallel,
    });

    let mut source_files = Vec::new();
    let mut coveralls_data = HashMap::new();
    coveralls_data.insert("repo_token", repo_token);
    coveralls_data.insert("service_name", service_name);
    coveralls_data.insert("service_number", service_number);
    coveralls_data.insert("service_job_number", service_job_number);
    coveralls_data.insert("parallel", &parallel.to_string());

    output_coveralls(
        results,
        repo_token,
        service_name,
        service_number,
        service_job_number,
        commit_sha,
        with_function_info,
        output_file,
        vcs_branch,
        parallel,
    );

    let actual = json!(coveralls_data);

    assert_eq!(expected, actual);
}