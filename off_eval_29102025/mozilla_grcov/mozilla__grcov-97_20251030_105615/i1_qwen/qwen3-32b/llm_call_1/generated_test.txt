#[test]
fn test_js_file_covered_with_lines_and_top_level() {
    let mut result_map: CovResultMap = HashMap::new();

    let functions = {
        let mut f = HashMap::new();
        f.insert("top-level".to_string(), Function { start: 1, executed: true });
        f
    };

    let result = CovResult {
        lines: [(1, 5)].iter().cloned().collect(),
        branches: BTreeMap::new(),
        functions: functions,
    };

    result_map.insert("js_file.js".to_string(), result);

    let results = rewrite_paths(result_map, None, "", "", false, false, Vec::new(), Some(true));

    let mut found = false;
    let mut count = 0;
    for (abs_path, _rel_path, _result) in results {
        assert_eq!(abs_path, PathBuf::from("js_file.js"));
        found = true;
        count += 1;
    }

    assert!(found);
    assert_eq!(count, 1);
}