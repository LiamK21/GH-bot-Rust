#[test]
fn test_is_known_binary_detection() {
  let elf_bytes = [0x7F, b'E', b'L', b'F'];
  let pe_bytes = [0x4D, 0x5A];
  let mach_o_bytes = [0xFE, 0xED, 0xFA, 0xCE];
  let coff_bytes = [0x14, 0x01];
  let wasm_bytes = [0x00, 0x61, 0x73, 0x6D];
  let llvm_bc_bytes = [0x42, 0x43, 0xC0, 0xDE];

  let expected = true;
  let actual_elf = is_known_binary(&elf_bytes);
  let actual_pe = is_known_binary(&pe_bytes);
  let actual_mach_o = is_known_binary(&mach_o_bytes);
  let actual_coff = is_known_binary(&[0x14, 0x01, 0x01, 0x00]); 
  let actual_wasm = is_known_binary(&wasm_bytes);
  let actual_llvm_bc = is_known_binary(&llvm_bc_bytes);

  assert_eq!(expected, actual_elf);
  assert_eq!(expected, actual_pe);
  assert_eq!(expected, actual_mach_o);
  assert_eq!(expected, actual_coff);
  assert_eq!(expected, actual_wasm);
  assert_eq!(expected, actual_llvm_bc);
}