#[test]
fn test_cleanup_relative_paths() {
  let mut results = Vec::new();
  let result_map: SyncCovResultMap = Arc::new(Mutex::new(HashMap::new()));
  let source_dir = PathBuf::from("./test/relative_path");
  let file_path = source_dir.join("relative_path.info");
  let file = fs::File::open(file_path).expect("Failed to open file");
  let file = std::io::BufReader::new(file);
  let results = parse_lcov(file, false).unwrap();
  let expected_path = fs::canonicalize(source_dir.join("foo/bar/oof.cpp")).unwrap().to_str().unwrap().to_string();
  let expected_map: SyncCovResultMap = Arc::new(Mutex::new(HashMap::new()));
  add_results(results, &expected_map, &Some(source_dir));
  let expected_map = Arc::try_unwrap(expected_map).unwrap().into_inner().unwrap();
  assert_eq!(expected_map.len(), 1);
  assert!(expected_map.contains_key(&expected_path));
}