<Filename> src/lib.rs </Filename>
<imports> 
use super::*;
use std::collections::HashMap;
use std::sync::{Arc, Mutex};
use std::path::PathBuf;
use std::fs;
</imports>
<Rust>
#[test]
fn test_cleanup_relative_paths() {
  let mut results = Vec::new();
  let result_map: Arc<SyncCovResultMap> = Arc::new(Mutex::new(HashMap::new()));
  let source_dir = PathBuf::from("./test/relative_path");
  let file_path = source_dir.join("relative_path.info");
  let file = fs::File::open(file_path).expect("Failed to open file");
  let file = std::io::BufReader::new(file);
  let results = parse_lcov(file, false).unwrap();
  add_results(results, &result_map, &Some(source_dir));
  let result_map = Arc::try_unwrap(result_map).unwrap().into_inner().unwrap();
  let expected_path = fs::canonicalize(source_dir.join("foo/bar/oof.cpp")).unwrap().to_str().unwrap();
  assert!(result_map.contains_key(expected_path));
}</Rust>