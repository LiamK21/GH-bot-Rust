#[test]
fn test_exclude_directories_with_wildcards() {
    let mut result_map: HashMap<String, CovResult> = HashMap::new();
    result_map.insert("vs2017_15.6.6/header.h".to_string(), json!({}));
    result_map.insert("vs2017_15.7.0/header.h".to_string(), json!({}));
    result_map.insert("src/main.cpp".to_string(), json!({}));

    let to_ignore_dirs = vec!["vs2017_*".to_string()];
    let results: Vec<_> = rewrite_paths(result_map, None, "", "", false, false, to_ignore_dirs).collect();

    let expected: Vec<(&str, &str, &serde_json::Value)> = vec![("src/main.cpp", "src/main.cpp", &json!({}))];
    let actual: Vec<(&str, &str, &serde_json::Value)> = results.iter().map(|(abs_path, rel_path, result)| (abs_path.to_str().unwrap(), rel_path.to_str().unwrap(), result)).collect();

    assert_eq!(expected, actual);
}