#[test]
fn test_parse_jacoco_report_package_kotlin() {
    let mut lines: BTreeMap<u32, u64> = BTreeMap::new();
    for i in &[5, 9, 14, 27, 30, 32, 41, 49, 57, 65, 73, 81, 89, 97, 104, 105, 106, 107, 108, 109, 110, 111, 112, 118, 119, 120] {
        lines.insert(*i, 0);
    }

    let mut functions: FunctionMap = FxHashMap::default();
    for (name, start, executed) in vec![
        ("Breakpoint#getEntries", 112, false),
        ("BreakpointValue#xxsmall", 49, false),
        ("Breakpoint#<clinit>", 104, false),
        ("BreakpointValue#xxlarge", 97, false),
        ("BreakpointValue#none", 41, false),
        ("BreakpointValue#xlarge", 89, false),
        ("BreakpointValue#setValue", 26, false),
        ("BreakpointValue#<init>", 5, false),
        ("BreakpointValue#getBreakpointValueMap", 14, false),
        ("BreakpointDirection#getEntries", 120, false),
        ("BreakpointValue#small", 65, false),
        ("BreakpointDirection#<clinit>", 118, false),
        ("BreakpointValue#xsmall", 57, false),
        ("BreakpointValue#large", 81, false),
        ("BreakpointValue#medium", 73, false),
    ] {
        functions.insert(String::from(name), Function { start, executed });
    }

    let mut branches: BTreeMap<u32, Vec<bool>> = BTreeMap::new();
    branches.insert(26, vec![false, false, false, false]);

    let expected = vec![(
        String::from("BreakpointValue.kt"),
        CovResult {
            lines,
            branches,
            functions,
        },
    )];

    let f = File::open("./test/jacoco/kotlin-jacoco-report.xml").expect("Failed to open xml file");
    let file = BufReader::new(&f);
    let results = parse_jacoco_report_package(&mut quick_xml::Reader::from_reader(file), &mut Vec::new(), "").unwrap();
    assert_eq!(results, expected);
}