<Filename>src/lib.rs</Filename>
<imports>
use std::sync::Arc;
use tempdir::TempDir;
use msqueue::MsQueue;
use super::producer;
use super::consumer;
</imports>
<Rust>
#[test]
fn test_producer_and_consumer_with_jacoco_xml() {
    let queue: Arc<WorkQueue> = Arc::new(MsQueue::new());

    let tmp_dir = TempDir::new("grcov").expect("Failed to create temporary directory");
    let tmp_path = tmp_dir.path().to_owned();
    producer(
        &tmp_path,
        &["test/jacoco1.zip".to_string()],
        &queue,
        false,
        false,
    );

    let result_map = Arc::new(std::sync::Mutex::new(std::collections::HashMap::new()));
    consumer(
        &tmp_path,
        &None,
        &result_map,
        &queue,
        false,
        false,
    );

    let result_map = result_map.lock().unwrap();
    assert!(result_map.contains_key("jacoco/basic-jacoco.xml"));
}
</Rust>