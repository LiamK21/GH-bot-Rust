#[test]
fn test_jacoco_xml_parsing_integration() {
    let working_dir = PathBuf::from("/");
    let source_dir = Some(PathBuf::from(""));
    let result_map = Mutex::new(HashMap::new());
    let queue = std::sync::mpsc::Sender::new();

    let xml_content = b"<?xml version='1.0' encoding='UTF-8'?><coverage><class name='Test' /></coverage>";
    let item = WorkItem {
        format: ItemFormat::JACOCO_XML,
        item: ItemType::Content(xml_content.to_vec()),
        name: "test.xml".to_string(),
    };

    // Simulate queue processing by triggering the consumer with the work item directly
    consumer::consume_work_item(
        &item,
        &working_dir,
        &source_dir,
        &result_map,
        false,
        false,
    );

    let mapped = result_map.lock().unwrap();
    assert!(!mapped.is_empty(), "Result map should not be empty after consuming Jacoco XML");
}