#[test]
fn test_rewrite_paths_with_partial_paths() {
  let mut result_map: CovResultMap = HashMap::new();
  result_map.insert("main.cpp".to_string(), empty_result!());
  let source_dir = Some(PathBuf::from("src"));
  let prefix_dir = None;
  let ignore_not_existing = false;
  let to_ignore_dirs = Vec::new();
  let filter_option = None;
  let path_mapping = None;
  let results = rewrite_paths(
    result_map,
    path_mapping,
    source_dir.clone(),
    prefix_dir,
    ignore_not_existing,
    to_ignore_dirs,
    filter_option,
  );
  let mut count = 0;
  for (abs_path, rel_path, _) in results {
    count += 1;
    assert!(abs_path.is_absolute());
    assert!(abs_path.starts_with("src/"));
  }
  assert_eq!(count, 1);
}