#[test]
fn test_output_covdir() {
  let results = vec![
    (PathBuf::from("foo/bar/a.cpp"), 
     PathBuf::from("foo/bar/a.cpp"), 
     CovResult { 
       lines: [(1, 10), (2, 11)].iter().cloned().collect(), 
       branches: BTreeMap::new(), 
       functions: std::collections::HashMap::new(), 
     }),
    (PathBuf::from("foo/bar/b.cpp"), 
     PathBuf::from("foo/bar/b.cpp"), 
     CovResult { 
       lines: [(1, 0), (2, 10), (4, 0)].iter().cloned().collect(), 
       branches: BTreeMap::new(), 
       functions: std::collections::HashMap::new(), 
     }),
  ];
  let results: CovResultIter = Box::new(results.into_iter());
  let tmp_dir = std::env::temp_dir();
  let file_path = tmp_dir.join("test_covdir.json");
  output_covdir(results, Some(file_path.to_str().unwrap()));
  let actual: String = std::fs::read_to_string(file_path).unwrap();
  let expected = "{\"name\":\"\",\"linesTotal\":0,\"linesCovered\":0,\"linesMissed\":0,\"coveragePercent\":0.0,\"children\":{\"foo\":{\"name\":\"foo\",\"linesTotal\":0,\"linesCovered\":0,\"linesMissed\":0,\"coveragePercent\":0.0,\"children\":{\"bar\":{\"name\":\"bar\",\"linesTotal\":0,\"linesCovered\":0,\"linesMissed\":0,\"coveragePercent\":0.0,\"children\":{\"a.cpp\":{\"name\":\"a.cpp\",\"linesTotal\":2,\"linesCovered\":2,\"linesMissed\":0,\"coveragePercent\":100.0,\"coverage\":[10,11]},\"b.cpp\":{\"name\":\"b.cpp\",\"linesTotal\":3,\"linesCovered\":1,\"linesMissed\":2,\"coveragePercent\":33.33,\"coverage\":[null,10,null]}},\"linesTotal\":5,\"linesCovered\":3,\"linesMissed\":2,\"coveragePercent\":60.0,\"coverage\":null}},\"linesTotal\":5,\"linesCovered\":3,\"linesMissed\":2,\"coveragePercent\":60.0,\"coverage\":null}}}";
  assert_eq!(actual, expected);
}