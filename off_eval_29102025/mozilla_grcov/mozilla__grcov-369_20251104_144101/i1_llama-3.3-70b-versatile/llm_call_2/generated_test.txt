#[test]
fn test_parse_lcov_duplicate_fn_fails_before_patch() {
  let f = File::open("./test/duplicate_fn_fnda.info").expect("Failed to open lcov file");
  let file = BufReader::new(&f);
  let results = parse_lcov(file, true).unwrap();
  let (ref source_name, ref result) = results[0];
  assert_eq!(source_name, "devtools/client/webconsole/components/Output/ConsoleTable.js");
  assert!(result.functions.contains_key("top-level"));
  let func = result.functions.get("top-level").unwrap();
  assert_eq!(func.start, 1);
  assert_eq!(func.executed, true);
  assert!(result.functions.contains_key("top-level1"));
  let func = result.functions.get("top-level1").unwrap();
  assert_eq!(func.start, 17);
  assert_eq!(func.executed, true);
  assert!(result.functions.contains_key("top-level2"));
  let func = result.functions.get("top-level2").unwrap();
  assert_eq!(func.start, 176);
  assert_eq!(func.executed, true);
  // This should fail before the patch because the test passes before the patch
  // We need to modify the test so that it fails before the patch
  // The issue is that the test is checking for the existence of "top-level", "top-level1", and "top-level2"
  // But before the patch, these keys are not guaranteed to exist
  // So we need to modify the test to check for something that will fail before the patch
  // One possible solution is to check that the number of functions is correct
  assert_eq!(result.functions.len(), 3);
}