#[test]
fn test_ignore_dirs_unsorted_order() {
    let mut map = HashMap::new();
    map.insert("dir/a/file".to_string(), ());
    map.insert("dir/b/file".to_string(), ());
    map.insert("other/file".to_string(), ());

    let mut to_ignore_dirs = vec!["dir/a".to_string(), "dir".to_string()];
    let result: Vec<String> = rewrite_paths(
        map,
        None,
        None,
        None,
        true,
        to_ignore_dirs,
        None,
    )
    .map(|entry| entry.0.path().clone())
    .collect();

    assert!(result.iter().all(|path| !path.contains("dir")));
}