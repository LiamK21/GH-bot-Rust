<Filename>src/lib.rs</Filename>
<imports>
use std::path::Path;
use std::path::PathBuf;
use std::sync::mpsc;
use std::thread;
use super::llvm_profiles_to_lcov;
</imports>
<Rust>
#[test]
fn test_num_threads_passed_to_llvm_profiles_to_lcov() {
  let profile_paths = vec![PathBuf::from("/tmp/default.profraw")];
  let binary_path = Path::new("/tmp/src");
  let working_dir = Path::new("/tmp");
  let num_threads = 4;
  let expected_args = vec![
    "merge",
    "-f",
    "-sparse",
    "-o",
    working_dir.join("grcov.profdata").to_str().unwrap(),
    "--num-threads",
    &num_threads.to_string(),
  ];
  let actual_args = llvm_profiles_to_lcov(&profile_paths, binary_path, working_dir, num_threads).unwrap();
  let actual_args_str: Vec<String> = actual_args.iter().map(|x| String::from_utf8_lossy(x).into_owned()).collect();
  assert!(actual_args_str.len() > 0);
  assert_eq!(actual_args_str[5], "--num-threads");
  assert_eq!(actual_args_str[6], num_threads.to_string());
}
</Rust>