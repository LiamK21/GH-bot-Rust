#[test]
fn test_warn_on_execution_count_overflow() {
    struct TestLogger {
        pub messages: Mutex<Vec<String>>,
    }

    impl Log for TestLogger {
        fn enabled(&self, _: &Metadata) -> bool {
            true
        }

        fn log(&self, record: &Record) {
            if record.level() == Level::Warn {
                self.messages.lock().unwrap().push(format!("{}", record.args()));
            }
        }

        fn flush(&self) {}
    }

    let test_logger = TestLogger {
        messages: Mutex::new(Vec::new()),
    };

    log::set_boxed_logger(Box::new(test_logger)).unwrap();
    log::set_max_level(log::LevelFilter::Warn);

    let mut results = vec![];
    let warn_overflow = true;

    add_results(&mut results, warn_overflow);

    let logged_messages = log::logger().downcast_ref::<TestLogger>().unwrap().messages.lock().unwrap();
    assert!(logged_messages.contains(&"Execution count overflow detected.".to_string()));
}