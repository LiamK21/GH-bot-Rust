<Filename>src/output.rs</Filename>
<imports>
use super::output_activedata_etl;
use std::io::Cursor;
use std::io::Write;
use serde_json::json;
use serde_json::Value;
use std::iter::IntoIterator;
use std::path::PathBuf;
use defs::{CovResult, CovResultIter};
use std::collections::BTreeMap;
</imports>
<Rust>
#[test]
fn test_output_activedata_etl_line_removal() {
  let mut results = Vec::new();
  let covered: Vec<u32> = vec![1, 2, 3];
  let uncovered: Vec<u32> = vec![4, 5, 6];
  let rel_path = PathBuf::from("path");
  let cov_result = CovResult {
    lines: BTreeMap::new(),
    branches: BTreeMap::new(),
    functions: BTreeMap::new(),
  };
  results.push(cov_result);
  let mut buffer = Cursor::new(Vec::new());
  {
    let mut writer = std::io::BufWriter::new(&mut buffer);
    output_activedata_etl(results.into_iter());
  }
  let actual = std::str::from_utf8(&buffer.into_inner()).unwrap();
  let expected = "{\"is_file\":true,\"file\":{\"name\":\"path\",\"covered\":[1,2,3],\"uncovered\":[4,5,6],\"total_covered\":3,\"total_uncovered\":3,\"percentage_covered\":0.5,\"method\":{\"covered\":[],\"uncovered\":[],\"total_covered\":0,\"total_uncovered\":0}}}";
  assert_eq!(actual, expected);
}
</Rust>