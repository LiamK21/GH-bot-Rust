<Filename>src/output.rs</Filename>
<imports>
use super::output_activedata_etl;
use serde_json::json;
use std::collections::{BTreeMap, HashMap};
use std::io::BufWriter;
use std::path::PathBuf;
use defs::{CovResult, Function};
</imports>
<Rust>
#[test]
fn test_output_activedata_etl_removes_line_key() {
    let results: Vec<(PathBuf, PathBuf, CovResult)> = vec![(
        PathBuf::from("file1.rs"),
        PathBuf::from("file1.rs"),
        CovResult {
            lines: BTreeMap::from_iter(vec![(1, 1), (2, 1), (3, 1)].into_iter()),
            branches: BTreeMap::new(),
            functions: HashMap::from_iter(vec![("func1".to_string(), Function { start: 1, end: 4 })]),
        },
    )];
    let expected = json!({
        "is_file": true,
        "file": {
            "name": "file1.rs",
            "covered": [1, 2, 3],
            "uncovered": [],
            "total_covered": 3,
            "total_uncovered": 0,
            "percentage_covered": 1.0,
        },
        "method": {
            "covered": [],
            "uncovered": [],
            "total_covered": 0,
            "total_uncovered": 0,
        }
    });

    let mut actual_output = Vec::new();
    {
        let writer = BufWriter::new(&mut actual_output);
        output_activedata_etl(Box::new(results.into_iter()));
    }

    let actual: serde_json::Value = serde_json::from_slice(&actual_output).unwrap();
    assert_eq!(expected, actual);
}
</Rust>