#[test]
fn test_rewrite_paths_with_mapping() {
  let result_map: CovResultMap = [("path1", CovResult::default()), ("path2", CovResult::default())].iter().cloned().collect();
  let path_mapping = Some(json!({
    "path1": "new_path1",
    "path2": "new_path2"
  }));
  let source_dir = Some(PathBuf::from("tests"));
  let prefix_dir = None;
  let ignore_not_existing = false;
  let to_ignore_dirs = vec![];
  let filter_option = None;

  let expected = vec![("new_path1", CovResult::default()), ("new_path2", CovResult::default())];
  let actual: Vec<(PathBuf, PathBuf, CovResult)> = rewrite_paths(
    result_map,
    path_mapping,
    source_dir,
    prefix_dir,
    ignore_not_existing,
    to_ignore_dirs,
    filter_option,
  ).collect();

  assert_eq!(actual.len(), expected.len());
  for (actual_path, _abs_path, _result) in actual {
    assert!(expected.iter().any(|(expected_path, _)| expected_path == actual_path.to_str().unwrap()));
  }
}