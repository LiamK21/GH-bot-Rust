<Filename>src/path_rewriting.rs</Filename>
<imports>
use std::collections::HashMap;
use std::path::PathBuf;
use serde_json::json;
use super::rewrite_paths;
</imports>
<Rust>
#[test]
fn test_rewrite_paths_with_mapping_and_prefix() {
    let mut result_map = HashMap::new();
    result_map.insert("src/main.rs".to_string(), CovResult::default());

    let path_mapping = Some(json!({
        "src/main.rs": "mapped/main.rs"
    }));

    let source_dir = Some(PathBuf::from("src"));
    let prefix_dir = Some(PathBuf::from("mapped"));
    let ignore_not_existing = true;
    let to_ignore_dirs = vec![];
    let filter_option = Some(true);

    let results: Vec<_> = rewrite_paths(
        result_map,
        path_mapping,
        source_dir,
        prefix_dir,
        ignore_not_existing,
        to_ignore_dirs,
        filter_option,
    ).collect();

    assert_eq!(results.len(), 1);
    let (abs_path, rel_path, _) = &results[0];
    assert!(abs_path.is_absolute());
    assert!(abs_path.ends_with("mapped/main.rs"));
    assert!(rel_path.ends_with("main.rs"));
}
</Rust>