<Filename>src/path_rewriting.rs</Filename>
<imports>
use std::path::PathBuf;
use std::fs;
use walkdir::WalkDir;
use std::collections::HashMap;
use super::rewrite_paths;
use super::CovResultMap;
use super::CovResultIter;
use super::Value;
use std::os::unix::fs::symlink;
</imports>
<Rust>
#[test]
fn test_rewrite_paths_skips_symlinks() {
  let source_dir = PathBuf::from("/tmp/test_source_dir");
  fs::create_dir_all(&source_dir).unwrap();
  let file_path = source_dir.join("test_file.txt");
  fs::File::create(&file_path).unwrap();
  let symlink_path = source_dir.join("symlink");
  symlink("test_file.txt", &symlink_path).unwrap();
  let mut result_map: CovResultMap = HashMap::new();
  let path_mapping: Option<Value> = None;
  let prefix_dir: Option<PathBuf> = None;
  let ignore_not_existing = false;
  let to_ignore_dirs: Vec<String> = vec![];
  let filter_option: Option<bool> = None;
  let expected_count = 1;
  let actual_count = rewrite_paths(result_map.clone(), path_mapping, Some(source_dir.clone()), prefix_dir, ignore_not_existing, to_ignore_dirs, filter_option).count();
  assert_eq!(expected_count, actual_count);
  fs::remove_dir_all(&source_dir).unwrap();
}
</Rust>