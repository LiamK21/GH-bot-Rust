<Filename>src/main.rs</Filename>
<imports>
use std::path::Path;
use std::panic;
use super::main;
</imports>
<Rust>
#[test]
fn test_output_path_validation() {
  let output_path = Path::new("/tmp");
  let result_before_patch = panic::catch_unwind(|| {
    let opt = struct OutputOptions { output_path: Some(output_path.to_path_buf()) };
    let _ = match opt.output_path.as_deref() {
        Some(output_path) => {
            if output_path.is_dir() {
                Some(output_path)
            } else {
                panic!("output_path must be a directory when using multiple outputs");
            }
        }
        None => None,
    };
  });
  assert!(result_before_patch.is_err());

  let result_after_patch = panic::catch_unwind(|| {
    let opt = struct OutputOptions { output_path: Some(output_path.to_path_buf()) };
    let _ = match opt.output_path.as_deref() {
        Some(output_path) => {
            if output_path.is_dir() {
                Some(output_path)
            } else {
                panic!("output_path must be a directory when using multiple outputs");
            }
        }
        None => None,
    };
  });
  assert!(result_after_patch.is_err());
}
</Rust>