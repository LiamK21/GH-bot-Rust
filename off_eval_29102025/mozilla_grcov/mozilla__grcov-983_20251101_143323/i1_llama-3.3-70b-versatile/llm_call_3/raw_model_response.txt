<Filename>src/main.rs</Filename>
<imports>
use std::path::Path;
use std::panic;
</imports>
<Rust>
#[test]
fn test_output_path_validation() {
  let output_path = Path::new("/tmp");
  let result_before_patch = panic::catch_unwind(|| {
    let _ = match output_path {
        _ => match output_path.as_ref() {
            Some(output_path) => {
                if output_path.is_dir() {
                    Some(output_path)
                } else {
                    panic!("output_path must be a directory when using multiple outputs");
                }
            }
            None => None,
        },
    };
  });
  assert!(result_before_patch.is_err());

  let result_after_patch = panic::catch_unwind(|| {
    let _ = match output_path {
        _ => match output_path.as_ref() {
            Some(output_path) => {
                if output_path.is_dir() {
                    Some(output_path)
                } else {
                    panic!("output_path must be a directory when using multiple outputs");
                }
            }
            None => None,
        },
    };
  });
  assert!(result_after_patch.is_err());
}
</Rust>