#[test]
#[should_panic(expected = "output_path must be a directory when using multiple outputs")]
fn test_output_path_not_directory_with_multiple_outputs() {
    let output_path = PathBuf::from("/invalid_dir_that_does_not_exist");
    let mut opt = Options {
        output_path: Some(output_path),
        ..Default::default()
    };
    let output_types = vec!["cov", "html"];

    // Patch main to force output_types to have length 2
    match output_types.len() {
        0 => return,
        1 => opt.output_path.as_deref(),
        _ => match opt.output_path.as_deref() {
            Some(output_path) => {
                if output_path.is_dir() {
                    Some(output_path)
                } else {
                    panic!("output_path must be a directory when using multiple outputs");
                }
            },
            _ => None,
        },
    };
}