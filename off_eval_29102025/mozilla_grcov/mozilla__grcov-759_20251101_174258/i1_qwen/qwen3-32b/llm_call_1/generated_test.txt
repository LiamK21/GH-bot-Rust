#[test]
fn test_class_coverage_includes_all_lines() {
    let sources = Vec::new();
    let demangle_options = DemangleOptions::default();

    // Mock coverage result with 5 lines (1-5)
    let lines = HashMap::from([
        (1, LineData { hits: 1, ..Default::default() }),
        (2, LineData { hits: 1, ..Default::default() }),
        (3, LineData { hits: 1, ..Default::default() }),
        (4, LineData { hits: 0, ..Default::default() }),
        (5, LineData { hits: 0, ..Default::default() }),
    ]);

    // Mock function covering lines 1-3
    let functions = HashMap::from([(
        "function1".to_string(),
        FunctionData {
            start: 1,
            end: 3,
            ..Default::default()
        },
    )]);

    // Create coverage result
    let result = CovResult { lines, functions, ..Default::default() };
    let results = vec![(
        PathBuf::from("path/to/file.rs"),
        "file.rs".to_string(),
        result,
    )];

    let coverage = get_coverage(
        results.into_iter(),
        sources,
        false,
        demangle_options,
    );

    // Verify class lines contain all 1-5 (passing after patch)
    assert_eq!(coverage.classes[0].lines.len(), 5);
    assert_eq!(
        coverage.classes[0].lines.iter().map(|l| l.number).collect::<Vec<_>>(),
        vec![1, 2, 3, 4, 5]
    );
}