#[test]
fn test_no_path_collision_for_rust_files() {
    let mut result_map: HashMap<String, HashMap<String, serde_json::Value>> = HashMap::new();
    result_map.insert("src/lib.rs".to_string(), empty_result!());
    result_map.insert("src_other/lib.rs".to_string(), empty_result!());

    let results = rewrite_paths(
        result_map,
        None,
        None,
        None,
        true,
        Vec::new(),
        None,
    );

    let collected: Vec<(PathBuf, PathBuf, HashMap<String, serde_json::Value>)> = results.collect();
    assert_eq!(collected.len(), 2);

    let paths: Vec<String> = collected.iter()
        .map(|(abs, _, _)| abs.to_string_lossy().to_string())
        .collect();

    assert_ne!(paths[0], paths[1]);
}