<Filename>src/output.rs</Filename>
<imports>
use super::output_lcov;
use std::fs::File;
use std::io::{BufRead, BufReader};
use tempfile::tempdir;
use defs::{CovResultIter, CovResult};
use std::path::PathBuf;
use std::boxed::Box;
</imports>
<Rust>
#[test]
fn test_output_lcov_to_file() {
    let temp_dir = tempdir().unwrap();
    let file_path = temp_dir.path().join("output.lcov");
    let output_file = Some(file_path.to_str().unwrap().to_string());

    let results: CovResultIter = Box::new(vec![
        (PathBuf::from("source1.rs"), PathBuf::from("source1.rs"), CovResult::default()),
        (PathBuf::from("source2.rs"), PathBuf::from("source2.rs"), CovResult::default()),
    ].into_iter());

    output_lcov(results, output_file.as_ref());

    let file = File::open(file_path).unwrap();
    let reader = BufReader::new(file);
    let mut lines = reader.lines();

    assert_eq!(lines.next().unwrap().unwrap(), "TN:");
    assert!(lines.next().is_none());
}
</Rust>