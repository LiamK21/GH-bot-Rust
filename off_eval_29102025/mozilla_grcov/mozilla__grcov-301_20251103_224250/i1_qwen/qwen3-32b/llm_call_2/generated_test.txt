#[test]
fn test_output_coveralls_branch() {
    let temp_dir = tempfile::tempdir().unwrap();
    let output_path = temp_dir.path().join("coveralls.json");

    // Create dummy coverage results with empty iterator
    let empty_array: [(PathBuf, PathBuf, CovResult); 0] = [];

    let cov_results: Box<dyn Iterator<Item = (PathBuf, PathBuf, CovResult)>> = 
        Box::new(empty_array.iter().cloned());

    output_coveralls(
        cov_results,
        "test_token",
        "",
        "",
        "",
        "test_sha",
        false,
        Some(output_path.to_str().unwrap()),
        "dev_branch",
    );

    let content = fs::read_to_string(&output_path).unwrap();
    let json_value: Value = serde_json::from_str(&content).unwrap();

    assert_eq!(json_value["head"]["branch"], "dev_branch");
}