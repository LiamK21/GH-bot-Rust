#[test]
fn test_producer_multiple_profraws_collected() {
    let tmp_dir = tempdir().unwrap();
    let profraw_sender = mpsc::channel().0;

    let mut profraws = FxHashMap::default();
    profraws.insert("profraw1".to_string(), vec![]);
    profraws.insert("profraw2".to_string(), vec![]);

    profraw_producer(&tmp_dir.path(), &profraws, &profraw_sender);

    let (format, item) = profraw_sender.recv().unwrap().unwrap();
    assert_eq!(format, ItemFormat::PROFRAW);

    if let ItemType::Paths(paths) = item {
        assert_eq!(paths.len(), 2);
        assert!(paths[0].ends_with("profraw1"));
        assert!(paths[1].ends_with("profraw2"));
    } else {
        panic!("Expected ItemType::Paths variant");
    }
}