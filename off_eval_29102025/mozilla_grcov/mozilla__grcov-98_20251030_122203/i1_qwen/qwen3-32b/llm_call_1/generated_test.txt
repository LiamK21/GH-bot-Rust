#[test]
fn test_zip_producer_ignore_orphan_gcno() {
    let tmp_dir = TempDir::new("grcov").unwrap();
    let tmp_path = tmp_dir.path().to_path_buf();
    let queue: Arc<WorkQueue> = Arc::new(MsQueue::new());
    let zip_files = vec!["test/no_gcda/main.gcno.zip".to_string()];

    let ret = zip_producer(&tmp_path, &zip_files, &queue, true);

    assert!(ret.is_none(), "Should not add orphan GCNO files when ignoring");

    let mut found = false;
    for (format, _, path, _) in &queue.0.lock().unwrap().0 {
        if *format == ItemFormat::GCNO && path == "main_1.gcno" {
            found = true;
            break;
        }
    }
    assert!(!found, "GCNO file for orphan should not be present in queue");
}