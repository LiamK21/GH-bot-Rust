#[test]
fn test_cobertura_single_line_coverage() {
    let results: Vec<(PathBuf, PathBuf, CovResult)> = vec![(PathBuf::from("test.rs"), PathBuf::from("test.rs"), CovResult {
        lines: [(1, 1), (2, 0)].iter().cloned().collect(),
        branches: BTreeMap::new(),
        functions: FxHashMap::default(),
    })];

    let results = Box::new(results.into_iter());
    let tmp_dir = tempdir().unwrap();
    let output_file = tmp_dir.path().join("coverage.xml");

    output_cobertura(results, Some(output_file.to_str().unwrap()), false);

    let mut file = File::open(output_file).unwrap();
    let mut content = String::new();
    file.read_to_string(&mut content).unwrap();

    assert!(content.contains(r#"lines-covered="1""#));
    assert!(content.contains(r#"lines-valid="2""#));
    assert!(content.contains(r#"line-rate="0.5""#));
}