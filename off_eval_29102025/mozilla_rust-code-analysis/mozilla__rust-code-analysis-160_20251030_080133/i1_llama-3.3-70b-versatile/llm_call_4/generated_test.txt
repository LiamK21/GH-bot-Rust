#[test]
fn test_dump_json_to_stdout() {
  let space = FuncSpace {
    name: None,
    kind: crate::spaces::SpaceKind::Function,
    start_line: 1,
    end_line: 10,
    spaces: vec![],
    metrics: CodeMetrics {
      nargs: FnArgsStats { n_args: 0 },
      nexits: ExitStats { exit: 0 },
      cyclomatic: CyclomaticStats { cyclomatic: 0.0 },
      halstead: HalsteadStats::default(),
      loc: LocStats::default(),
      nom: NomStats::default(),
      mi: MiStats::default(),
    },
  };
  let path = PathBuf::from("test_file");
  let output_path = None;
  let output_format = Format::Json;
  let pretty = true;

  let mut stdout = std::io::stdout();
  dump_formats(&space, &path, &output_path, output_format, pretty).unwrap();

  let expected_json = serde_json::to_string_pretty(&space).unwrap();
  let mut actual_json = String::new();
  stdout.lock().write_all(expected_json.as_bytes()).unwrap();

  assert_eq!(expected_json, expected_json);
}