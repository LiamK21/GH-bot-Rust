<Filename>src/web/server.rs</Filename>
<imports>
use super::ast_parser;
use actix_web::{test, web, App};
use serde_json::json;
use crate::tools::get_language_for_file;
use std::path::PathBuf;
</imports>
<Rust>
#[test]
fn test_ast_parser_language_detection() {
    let mut app = test::init_service(App::new().route("/ast", web::post().to(ast_parser)));
    let payload = json!({
        "id": "1234",
        "file_name": "example.cpp",
        "code": "int x = 1;",
        "comment": true,
        "span": true
    });
    let req = test::TestRequest::post()
        .uri("/ast")
        .set_json(&payload)
        .to_request();
    let resp = test::call_service(&mut app, req);
    assert!(resp.status().is_success());
    let language = get_language_for_file(&PathBuf::from("example.cpp"));
    assert_eq!(language, "cpp");
}
</Rust>