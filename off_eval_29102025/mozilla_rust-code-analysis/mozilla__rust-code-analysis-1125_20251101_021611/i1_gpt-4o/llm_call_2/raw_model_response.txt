<Filename>src/metrics/halstead.rs</Filename>
<imports>use super::calculate_halstead_metrics;
use insta::assert_json_snapshot;</imports>
<Rust>
#[test]
fn test_halstead_metrics_with_comma() {
    let code = r#"
        fn main() {
            let a = 5;
            let b = 3;
            let c = a + b;
            let avg = c / 2;
            println!("{}, {}", avg, c);
        }
    "#;
    let metric = calculate_halstead_metrics(code, "foo.rs");
    assert_json_snapshot!(
        metric.halstead,
        @r###"
        {
          "n1": 10.0,
          "N1": 23.0,
          "n2": 9.0,
          "N2": 15.0,
          "length": 38.0,
          "estimated_program_length": 61.74860596185444,
          "purity_ratio": 1.624963314785643,
          "vocabulary": 19.0,
          "volume": 161.42124551085624,
          "difficulty": 8.333333333333334,
          "level": 0.12,
          "effort": 1345.177045923802,
          "time": 74.7320581068779,
          "bugs": 0.040619232256751396
        }"###
    );
}
</Rust>