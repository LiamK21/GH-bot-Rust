#[test]
fn test_documentation_and_metrics() {
    let path = PathBuf::from("test_file.rs");
    let mut files = HashMap::new();
    let all_files = HashMap::new();
    let results = Arc::new(Mutex::new(PreprocResults::default()));

    let expected_macros: HashSet<String> = HashSet::new();
    let expected_includes: HashSet<String> = HashSet::new();

    let parser = PreprocParser::new(vec![], &path, None);
    preprocess(&parser, &path, Arc::clone(&results));
    fix_includes(&mut files, &all_files);

    let actual_macros = get_macros(&path, &files);
    let actual_includes = files.get(&path).map(|pf| pf.direct_includes.clone()).unwrap_or_default();

    assert_eq!(expected_macros, actual_macros);
    assert_eq!(expected_includes, actual_includes);
}